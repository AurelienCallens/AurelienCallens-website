<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>Aurelien Callens</title>
<link>https://aureliencallens.github.io/index.html</link>
<atom:link href="https://aureliencallens.github.io/index.xml" rel="self" type="application/rss+xml"/>
<description></description>
<generator>quarto-1.3.450</generator>
<lastBuildDate>Tue, 20 Sep 2022 22:00:00 GMT</lastBuildDate>
<item>
  <title>Optimizing my search for Data scientist jobs by scraping Indeed with R</title>
  <dc:creator>Aurelien Callens</dc:creator>
  <link>https://aureliencallens.github.io/posts/2022-09-21-webscraping-indeed-data-scientist-jobs/index.html</link>
  <description><![CDATA[ 




<p>A few weeks ago, I started looking for a data scientist position in industry. My first moves were:</p>
<ul>
<li>To look at the job posts on websites such as Indeed</li>
<li>To update my resume</li>
</ul>
<p>After reading numerous job posts and work several hours on my resume, I wondered if I could optimize these steps with R and Data Science. I therefore decided to scrape Indeed and analyze the data about data science jobs to:</p>
<ul>
<li>Get a visual overview of essential information such as location, type of contract, salary range for the large number of job posts</li>
<li>Optimize my resume for ATS scan with accurate key words</li>
</ul>
<section id="loading-libraries" class="level2">
<h2 class="anchored" data-anchor-id="loading-libraries">Loading libraries</h2>
<p>The first step is to import several packages:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># General</span></span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb1-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Webscraping </span></span>
<span id="cb1-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(rvest)</span>
<span id="cb1-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(RSelenium)</span>
<span id="cb1-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Geo data</span></span>
<span id="cb1-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidygeocoder)</span>
<span id="cb1-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(leaflet)</span>
<span id="cb1-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(rnaturalearth)</span>
<span id="cb1-10"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(sf)</span>
<span id="cb1-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># NLP</span></span>
<span id="cb1-12"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(udpipe)</span>
<span id="cb1-13"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(textrank)</span>
<span id="cb1-14"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(wordcloud)</span>
<span id="cb1-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Cleaning</span></span>
<span id="cb1-16"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(stringr)</span>
<span id="cb1-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Additional functions presented at the end of the post </span></span>
<span id="cb1-18"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">source</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'scraping_functions.R'</span>) </span></code></pre></div>
</div>
</section>
<section id="collect-the-data-with-web-scraping" class="level2">
<h2 class="anchored" data-anchor-id="collect-the-data-with-web-scraping">Collect the data with web scraping</h2>
<p>In the beginning of this project, I was using <code>read_html()</code> from <strong>rvest</strong> to access and download the webpage from Indeed. However, Indeed pages are protected by an anti-scrapping software that blocked any of my requests even though scraping is not forbidden on the pages I am interested in (I checked the <em>robots.txt</em> page).</p>
<p>This is why I decided to access the pages with <strong>Rselenium</strong> which allows to run an headless browser. We first navigate to the page corresponding to the search results of data scientist jobs in France:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1">url <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://fr.indeed.com/jobs?q=data%20scientist&amp;l=France&amp;from=searchOnHP"</span></span>
<span id="cb2-2"></span>
<span id="cb2-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Headless Firefox browser</span></span>
<span id="cb2-4">exCap <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"moz:firefoxOptions"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">args =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'--headless'</span>)))</span>
<span id="cb2-5">rD <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rsDriver</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">browser =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"firefox"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">extraCapabilities =</span> exCap, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">port=</span>1111L,</span>
<span id="cb2-6">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">verbose =</span> F)</span>
<span id="cb2-7">remDr <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> rD<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>client</span>
<span id="cb2-8"></span>
<span id="cb2-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Navigate to the url</span></span>
<span id="cb2-10">remDr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">navigate</span>(url)</span>
<span id="cb2-11"></span>
<span id="cb2-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Store page source </span></span>
<span id="cb2-13">web_page <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> remDr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">getPageSource</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">header =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)[[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_html</span>()</span></code></pre></div>
</div>
<p>To scrape a specific information on a webpage you need to follow these steps:</p>
<ol type="1">
<li>Find on the web page the element/text/data you want to scrape</li>
<li>Find the associated xpath or css selector with the developer tool of chrome or firefox ( <a href="https://www.scrapingbee.com/blog/practical-xpath-for-web-scraping/">tutorial here !</a> )</li>
<li>Extract the element with <code>hmtl_element()</code> by indicating the xpath or css selector</li>
<li>Transform the data to text with <code>html_text2()</code></li>
<li>Clean the data if necessary</li>
</ol>
<p>Here is the example with the number of listed data science jobs in France:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">web_page <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">html_element</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">css =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"div.jobsearch-JobCountAndSortPane-jobCount"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># selecting with css </span></span>
<span id="cb3-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">html_text2</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Transform to text</span></span>
<span id="cb3-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_remove_all</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"[^0-9.-]"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Clean the data to only get numbers</span></span>
<span id="cb3-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">substr</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">start =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stop =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb3-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>()</span></code></pre></div>
</div>
<p>For now, we can only scrape the data from the first page. However, I am interested in all the job posts and I need to access the other pages ! After navigating through the first 3 pages of listed jobs, I remarked a pattern in the URL address (valid at the time of writing), this means that with a line of code, I can produce a list containing the URLs for the first 40 pages.</p>
<p>Once I have the list, the only thing left is to loop over all the URLs with some delay (good practice for web-scraping), collect the data and clean it with custom functions (at the end of the post):</p>
<div class="cell" data-hash="index_cache/html/unnamed-chunk-4_c11300820e572eb30fa6cc5a8c43c2ff">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Creating URL link corresponding to the first 40 pages</span></span>
<span id="cb4-2">base_url <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://fr.indeed.com/jobs?q=data%20scientist&amp;l=France&amp;start="</span></span>
<span id="cb4-3">url_list <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(url, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(base_url, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.character</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">from=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">to=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">400</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>))))</span>
<span id="cb4-4"></span>
<span id="cb4-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Looping through the URL list</span></span>
<span id="cb4-6">res <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>()</span>
<span id="cb4-7"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span>(i <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(url_list)){</span>
<span id="cb4-8">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Navigate to the URL</span></span>
<span id="cb4-9">  remDr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">navigate</span>(url_list[i])</span>
<span id="cb4-10">  </span>
<span id="cb4-11">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Store page source </span></span>
<span id="cb4-12">  web_page <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> remDr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">getPageSource</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">header =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)[[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_html</span>()</span>
<span id="cb4-13"></span>
<span id="cb4-14">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Job title </span></span>
<span id="cb4-15">  job_title <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> web_page <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-16">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">html_elements</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">css =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".mosaic-provider-jobcards .result"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-17">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">html_elements</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">css =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".resultContent"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-18">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">html_element</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"h2"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-19">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">html_text2</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-20">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_replace</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".css.*;</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">}"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>)</span>
<span id="cb4-21"></span>
<span id="cb4-22">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># URL for job post </span></span>
<span id="cb4-23">  job_url <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> web_page <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-24">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">html_elements</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">css =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".mosaic-provider-jobcards .result"</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-25">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">html_elements</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">css =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".resultContent"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-26">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">html_element</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"h2"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-27">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">html_element</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"a"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-28">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">html_attr</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'href'</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-29">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lapply</span>(<span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(x){<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://fr.indeed.com"</span>, x)}) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-30">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unlist</span>()</span>
<span id="cb4-31">  </span>
<span id="cb4-32">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Data about company</span></span>
<span id="cb4-33">  company_info <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> web_page <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-34">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">html_elements</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">css =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".mosaic-provider-jobcards .result"</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-35">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">html_elements</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">css =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".resultContent"</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-36">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">html_element</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">css =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".company_location"</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-37">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">html_text2</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-38">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lapply</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">FUN =</span> tidy_comploc) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Function to clean the textual data</span></span>
<span id="cb4-39">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">do.call</span>(rbind, .)</span>
<span id="cb4-40"></span>
<span id="cb4-41">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Data about job description</span></span>
<span id="cb4-42">  job_desc <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> web_page <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-43">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">html_elements</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">css =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".mosaic-provider-jobcards .result"</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-44">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">html_element</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">css =</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".slider_container .jobCardShelfContainer"</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-45">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">html_text2</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-46">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tidy_job_desc</span>() <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Function to clean the textual data related to job desc.</span></span>
<span id="cb4-47"></span>
<span id="cb4-48">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Data about salary (when indicated)</span></span>
<span id="cb4-49">  salary_hour <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> web_page <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-50">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">html_elements</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">css =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".mosaic-provider-jobcards .result .resultContent"</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-51">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">html_element</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">css =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".salaryOnly"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-52">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">html_text2</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-53">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lapply</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">FUN =</span> tidy_salary) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Function to clean the data related to salary</span></span>
<span id="cb4-54">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">do.call</span>(rbind, .)</span>
<span id="cb4-55">  </span>
<span id="cb4-56">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Job posts in the same format</span></span>
<span id="cb4-57">  final_df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cbind</span>(job_title, company_info, salary_hour, job_desc, job_url)</span>
<span id="cb4-58">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(final_df) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Job_title"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Company"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Location"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Rating"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Low_salary"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"High_salary"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Contract_info"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Job_desc"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"url"</span>)</span>
<span id="cb4-59">  res[[i]] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> final_df</span>
<span id="cb4-60">  </span>
<span id="cb4-61">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Sleep 5 seconds, good practice for web scraping</span></span>
<span id="cb4-62">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Sys.sleep</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)</span>
<span id="cb4-63">}</span>
<span id="cb4-64"></span>
<span id="cb4-65"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Gather all the job post in a tibble</span></span>
<span id="cb4-66">final_df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_tibble</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">do.call</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"rbind"</span>, res))</span>
<span id="cb4-67"></span>
<span id="cb4-68"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Final data cleaning</span></span>
<span id="cb4-69">final_df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> final_df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-70">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate_at</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Rating"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Low_salary"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"High_salary"</span>), as.numeric)</span>
<span id="cb4-71"></span>
<span id="cb4-72"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Clean job title</span></span>
<span id="cb4-73">final_df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Job_title_c <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">clean_job_title</span>(final_df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Job_title)  </span>
<span id="cb4-74">final_df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Job_title_c <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.factor</span>(final_df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Job_title_c)</span></code></pre></div>
</div>
<p>We have now a tidy data set! Here is a truncated example of the 5 first rows:</p>
<div class="cell">
<div class="cell-output-display">
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:500px; overflow-x: scroll; width:100%; ">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">Job_title</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">Company</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">Location</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">Rating</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">Low_salary</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">High_salary</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">Contract_info</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">Job_desc</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">Job_type</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">Job_title_c</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Data Scientist junior (H/F)</td>
<td style="text-align: left;">Kea &amp; Partners</td>
<td style="text-align: left;">92240 Malakoff</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">3750</td>
<td style="text-align: right;">4583</td>
<td style="text-align: left;">CDI +2 | Travail en journée +1</td>
<td style="text-align: left;">Plusieurs postes à pourvoirMaitrise de Python et des packages de data science. 1er cabinet européen de conseil en stratégie à devenir Société à Mission, certifiés B-Corp depuis 2021*,…</td>
<td style="text-align: left;">Présentiel</td>
<td style="text-align: left;">data scientist junior</td>
</tr>
<tr class="even">
<td style="text-align: left;">Data Scientist (F ou H)</td>
<td style="text-align: left;">SNCF</td>
<td style="text-align: left;">Saint-Denis (93)</td>
<td style="text-align: right;">3.9</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">CDI</td>
<td style="text-align: left;">Le développement informatique (C, C++, Python, Azure, …). Valider et recetter les phases des projets. Travailler avec des méthodes agiles avec les équipes et…</td>
<td style="text-align: left;">Présentiel</td>
<td style="text-align: left;">data scientist</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Data Scientist (H/F) (IT)</td>
<td style="text-align: left;">Yzee Services</td>
<td style="text-align: left;">Paris (75)</td>
<td style="text-align: right;">3.3</td>
<td style="text-align: right;">2916</td>
<td style="text-align: right;">3750</td>
<td style="text-align: left;">Temps plein</td>
<td style="text-align: left;">Recueillir, structurer et analyser les données pertinentes pour l'entreprise (activité liée à la relation client, conseil en externe).</td>
<td style="text-align: left;">Présentiel</td>
<td style="text-align: left;">data scientist</td>
</tr>
<tr class="even">
<td style="text-align: left;">Data Scientist H/F</td>
<td style="text-align: left;">Natan (SSII)</td>
<td style="text-align: left;">Paris (75)</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">4583</td>
<td style="text-align: right;">5833</td>
<td style="text-align: left;">CDI +1 | Travail en journée</td>
<td style="text-align: left;">Plusieurs postes à pourvoirVous retrouverez une *ESN ambitieuse portée par le goût de l’excellence.*. Au sein du département en charge d'automatisation transverse des besoins de la…</td>
<td style="text-align: left;">Présentiel</td>
<td style="text-align: left;">data scientist</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Data Scientist Junior H/F / Freelance</td>
<td style="text-align: left;">karma partners</td>
<td style="text-align: left;">Roissy-en-Brie (77)</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">400</td>
<td style="text-align: right;">550</td>
<td style="text-align: left;">Temps plein +1</td>
<td style="text-align: left;">Le profil recherché est un profil junior (0-2 ans d'expérience) en data science, avec une appétence technique et des notions d'architecture logicielle et de…</td>
<td style="text-align: left;">Présentiel</td>
<td style="text-align: left;">data scientist junior</td>
</tr>
</tbody>
</table>
</div>

</div>
</div>
<section id="visualization-of-the-proposed-salaries" class="level3">
<h3 class="anchored" data-anchor-id="visualization-of-the-proposed-salaries">Visualization of the proposed salaries</h3>
<p>Let’s see if we can get some insights about data science jobs by making some graphical representations. The first thing I wanted to know is how much the companies are willing to pay in order to recruit a data science candidate. I therefore decided to make some figures about the salary range depending on the company and the job title.</p>
<p><strong>Beware!</strong></p>
<p>The following graphs must be taken with a grain of salt as they display a small sample of the data. Indeed, the salary was listed for only 14% of the job post. The insights or trends in these graphs may not be representative of companies that have not listed their proposed salary.</p>
<section id="salary-by-company" class="level4">
<h4 class="anchored" data-anchor-id="salary-by-company">Salary by company</h4>
<p>The following graphic shows the monthly income listed by some companies (not all the companies list their proposed salary):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Function to make euro X scale </span></span>
<span id="cb5-2">euro <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> scales<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">label_dollar</span>(</span>
<span id="cb5-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">prefix =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>,</span>
<span id="cb5-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">suffix =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"\u20ac"</span>,</span>
<span id="cb5-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">big.mark =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"."</span>,</span>
<span id="cb5-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">decimal.mark =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">","</span></span>
<span id="cb5-7">)</span>
<span id="cb5-8"></span>
<span id="cb5-9">final_df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb5-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(Low_salary <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1600</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># To remove internships and freelance works</span></span>
<span id="cb5-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(Company, Low_salary, High_salary) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb5-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(Company) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb5-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarize_if</span>(is.numeric, mean) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb5-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Mean_salary =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rowMeans</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cbind</span>(Low_salary, High_salary), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> T),</span>
<span id="cb5-15">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Company =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fct_reorder</span>(Company, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">desc</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>Mean_salary))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb5-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> Company)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> Mean_salary), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#267266"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_linerange</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymin =</span> Low_salary, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymax =</span> High_salary)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_hline</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yintercept =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">median</span>(Mean_salary)), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lty=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'red'</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> euro) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-21">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ylab</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Monthly income"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xlab</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-23">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_flip</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-24">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_bw</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>)</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://aureliencallens.github.io/posts/2022-09-21-webscraping-indeed-data-scientist-jobs/index_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" style="width:100.0%"></p>
</div>
</div>
<p>The median monthly salary is around 3700 euros. As you can see the salaries can vary a lot depending on the company. This is partly due because I didn’t make distinction between the different data science jobs (data scientist, data analyst, data engineer, senior or lead).</p>
</section>
<section id="salary-by-job-title" class="level4">
<h4 class="anchored" data-anchor-id="salary-by-job-title">Salary by job title</h4>
<p>We can plot the same graph but instead of grouping by company we can group by job title:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1">final_df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb6-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(Low_salary <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1600</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># To remove internships and freelance works</span></span>
<span id="cb6-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(Job_title_c, Low_salary, High_salary, Job_type) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb6-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(Job_title_c) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb6-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarize_if</span>(is.numeric, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(.x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb6-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Mean_salary =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rowMeans</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cbind</span>(Low_salary, High_salary), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> T),</span>
<span id="cb6-7">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Job_title_c =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fct_reorder</span>(Job_title_c, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">desc</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>Mean_salary))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb6-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> Job_title_c, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> Mean_salary)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> Mean_salary), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#267266"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_linerange</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymin =</span> Low_salary, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymax =</span> High_salary)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-11">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#geom_label(aes(label = n, Job_title_c, y = 1500), data = count_df) + </span></span>
<span id="cb6-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> euro) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_bw</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xlab</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ylab</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Monthly Income"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_flip</span>()</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://aureliencallens.github.io/posts/2022-09-21-webscraping-indeed-data-scientist-jobs/index_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" style="width:100.0%"></p>
</div>
</div>
<p>We clearly see the differences in proposed salaries depending on the job title: data scientists seem to earn slightly more in average than data analysts. The companies also seem to propose higher salaries for jobs with more responsibilities or requiring more experiences (senior, lead).</p>
</section>
<section id="salary-depending-on-location-full-remote-hybrid-on-site" class="level4">
<h4 class="anchored" data-anchor-id="salary-depending-on-location-full-remote-hybrid-on-site">Salary depending on location: full remote, hybrid, on site ?</h4>
<p>Finally we can plot the salaries depending on the location (full remote, hybrid, on site) to see if it has an impact:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Tidy the types and locations of listed jobs</span></span>
<span id="cb7-2">final_df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tidy_location</span>(final_df)</span>
<span id="cb7-3">count_df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">count</span>(final_df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(Low_salary <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1600</span>), Job_type)</span>
<span id="cb7-4">final_df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(Low_salary <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1600</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb7-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">drop_na</span>(Location) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Mean_salary =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rowMeans</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cbind</span>(Low_salary, High_salary), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> T),</span>
<span id="cb7-8">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Job_type =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.factor</span>(Job_type)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-9">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> Job_type, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> Mean_salary)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_boxplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_label</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> n, Job_type, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5500</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> count_df) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb7-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> euro) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb7-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_bw</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xlab</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Job Type"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ylab</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Income"</span>)</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://aureliencallens.github.io/posts/2022-09-21-webscraping-indeed-data-scientist-jobs/index_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" style="width:100.0%"></p>
</div>
</div>
<p>It is worth noting that most of the jobs proposed in France are on site jobs. The median salary for this type of jobs is slightly lower than hybrid jobs. The salary distribution of full remote and hybrid jobs must be taken with care as it is only represented by 12 job posts.</p>
</section>
</section>
<section id="mapping-job-locations" class="level3">
<h3 class="anchored" data-anchor-id="mapping-job-locations">Mapping job locations</h3>
<p>During my job search, I was frustrated not to see a geographical map regrouping the locations of all the proposed jobs. Such map could help me greatly in my search. Let’s do it !</p>
<p>First, we must tidy and homogenize the locations for all the job posts. To this end, I made a custom function (<code>tidy_location()</code>) which includes some <strong>stringr</strong> functions, you can find more details about this function at the end of this post. It outputs the location in this format <code>[Town]([Zip code])</code>. Even though all the locations have been homogenized, it can not be plotted on a map (we need the longitude and latitude). To get the latitude and longitude with the town name and zip code I used the <code>geocode()</code> function from <strong>tidygeocoder</strong> package.</p>
<div class="cell" data-hash="index_cache/html/unnamed-chunk-9_1bdc1a8ddd7da5b162c0ccfac5e58ead">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extract coordinates from town name</span></span>
<span id="cb8-2">final_df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> final_df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb8-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Loc_tidy_fr =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(Loc_tidy, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'France'</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb8-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geocode</span>(Loc_tidy_fr, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'arcgis'</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lat =</span> latitude , <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">long =</span> longitude) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb8-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> Loc_tidy_fr)</span></code></pre></div>
</div>
<section id="distribution-of-data-science-jobs-in-france" class="level4">
<h4 class="anchored" data-anchor-id="distribution-of-data-science-jobs-in-france">Distribution of Data Science jobs in France</h4>
<p>We can now represent the number of Data Science jobs by departments:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Map of France from rnaturalearth package</span></span>
<span id="cb9-2">france <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ne_states</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">country =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"France"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">returnclass =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sf"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb9-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span>name <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Guyane française"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Martinique"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Guadeloupe"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"La Réunion"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Mayotte"</span>))</span>
<span id="cb9-4"></span>
<span id="cb9-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Transform location to st point </span></span>
<span id="cb9-6">test <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_sf</span>(final_df, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geom=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lapply</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(final_df), <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(x){<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_point</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(final_df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>longitude[x],final_df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>latitude[x]))}))</span>
<span id="cb9-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_crs</span>(test) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4326</span></span>
<span id="cb9-8"></span>
<span id="cb9-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># St_join by departments </span></span>
<span id="cb9-10">joined <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> france <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb9-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_join</span>(test, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">left =</span> T)</span>
<span id="cb9-12"></span>
<span id="cb9-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Custom breaks for visual representation</span></span>
<span id="cb9-14">my_breaks <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">260</span>)</span>
<span id="cb9-15"></span>
<span id="cb9-16">joined <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb9-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">region=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.factor</span>(name)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb9-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(region) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb9-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarize</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Job_number=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">n</span>()) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb9-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Job_number =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cut</span>(Job_number, my_breaks)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb9-21">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill=</span>Job_number), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'grey'</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lwd=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb9-23">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_brewer</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Job number"</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">palette =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"GnBu"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb9-24">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_bw</span>()</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://aureliencallens.github.io/posts/2022-09-21-webscraping-indeed-data-scientist-jobs/index_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" style="width:100.0%"></p>
</div>
</div>
<p>It is really interesting to see that the distribution of jobs is quite heterogeneous in France. The majority of the jobs are concentrated in a few departments that include a large city. It is expected as most of the jobs are proposed by large company that are often installed in the proximity of important cities.</p>
</section>
<section id="interactive-map" class="level4">
<h4 class="anchored" data-anchor-id="interactive-map">Interactive map</h4>
<p>We can go further and plot an interactive map with leaflet which allows us to search dynamically for a job post:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot leaflet map</span></span>
<span id="cb10-2">final_df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb10-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pop_up_text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sprintf</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;b&gt;%s&lt;/b&gt; &lt;br/&gt; %s"</span>,</span>
<span id="cb10-4">                                     Job_title, Company)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Make popup text</span></span>
<span id="cb10-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">leaflet</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb10-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">setView</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lng =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.36</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lat =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">46.31</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">zoom =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5.2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Center of France</span></span>
<span id="cb10-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">addProviderTiles</span>(providers<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>CartoDB.Positron) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb10-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">addMarkers</span>(</span>
<span id="cb10-9">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">popup =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.character</span>(pop_up_text),</span>
<span id="cb10-10">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">clusterOptions =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">markerClusterOptions</span>()</span>
<span id="cb10-11">  )</span></code></pre></div>
<div class="cell-output-display">

<div class="leaflet html-widget html-fill-item" id="htmlwidget-b59e61a3576b5cb7874c" style="width:100%;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-b59e61a3576b5cb7874c">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"setView":[[46.31,2.36],5.2,[]],"calls":[{"method":"addProviderTiles","args":["CartoDB.Positron",null,null,{"errorTileUrl":"","noWrap":false,"detectRetina":false}]},{"method":"addMarkers","args":[[48.8196774463495,48.9399300000001,48.8276940066496,48.8276940066496,48.7999060070039,48.7999060070039,44.8367000000001,48.88264,50.674,48.8276940066496,48.8121100000001,47.37208,43.6211015185853,48.8260444622458,48.8276940066496,48.8276940066496,48.8276940066496,48.8266600000001,48.8481900230275,43.63458,43.6597741755991,43.7042970134431,44.2021300000001,48.8276940066496,43.62235,43.6211015185853,48.8931433281449,43.3003027583506,48.8276940066496,46.559417044,43.6211015185853,48.8305285361195,48.89617,48.88822,48.8931433281449,45.194121000913,44.8367000000001,43.5703500000001,48.77108,48.8571700000001,43.5168546243986,48.8276940066496,43.6597741755991,48.8276940066496,43.5168546243986,48.89617,43.5168546243986,48.5395800000001,48.8276940066496,48.7687300000001,48.8276940066496,48.8571700000001,48.8935500000001,48.8276940066496,48.8931433281449,48.7327323895336,48.8276940066496,48.88822,48.89617,48.8262011247733,48.88822,48.89617,48.8262011247733,48.6999700000001,48.8151800000001,48.8305285361195,46.559417044,48.88822,48.83525,46.32124,48.8276940066496,43.6392095751544,48.8263481193168,48.8571700000001,47.5049560132719,48.8276940066496,48.9399300000001,48.82163,44.8367000000001,48.8121100000001,48.79983,48.84365,46.559417044,48.7929100000001,48.8276940066496,48.8276940066496,48.8574097079022,45.9982900000001,43.6211015185853,47.32698,48.8276940066496,48.8258208870661,48.8276940066496,45.7365411623063,48.8276940066496,48.8276940066496,48.9399300000001,50.6371823834797,48.8276940066496,48.8276940066496,50.6371823834797,46.15943,48.83525,48.8276940066496,50.6371823834797,48.8276940066496,48.8276940066496,44.8367000000001,49.1272448557142,48.79988,43.3003027583506,48.8931433281449,43.31856,45.75917,48.8259799593331,48.88822,48.8677300000001,50.6371823834797,48.8276940066496,48.8276940066496,48.775958474443,47.3661200000001,48.8931433281449,48.8276940066496,48.8305285361195,48.8262011247733,48.8276940066496,44.8367000000001,48.83525,48.7999060070039,48.8276940066496,48.83525,48.8276940066496,48.8481900230275,48.8276940066496,50.6120100433994,49.1147,48.8276940066496,45.790968583422,48.8276940066496,50.6371823834797,48.8276940066496,48.8276940066496,48.8276940066496,48.88264,48.9399300000001,43.31856,50.6371823834797,48.83525,45.75917,46.559417044,43.3299611373217,48.7929100000001,48.83525,48.5977500000001,48.8574097079022,45.8400600000001,48.8276940066496,47.3884600000001,48.7322534636745,48.8276940066496,45.8059200000001,50.674,45.7358762720328,48.8305285361195,48.88822,47.8117669528344,48.8276940066496,45.194121000913,48.8276940066496,48.76532,48.82163,49.00397,48.7322534636745,45.7766800000001,48.8116800000001,48.8276940066496,45.8159200000001,43.31856,45.7754997089554,45.7754997089554,46.69746,48.8276940066496,43.31856,48.830678830864,48.8258947847109,43.6211015185853,48.8276940066496,48.8258208870661,48.8276940066496,48.5218300000001,48.88822,48.08018,48.8276940066496,48.8276940066496,45.194121000913,48.8258208870661,48.76532,50.60585,50.6120100433994,47.3884600000001,50.6120100433994,45.7358762720328,43.6211015185853,48.8276940066496,48.8116800000001,48.8276940066496,48.86452,45.8059200000001,45.75917,48.8276940066496,48.89617,48.8276940066496,48.8276940066496,48.8276940066496,49.4962600000001,48.8305285361195,48.88822,48.8276940066496,48.7946600000001,48.9001400000001,43.6597741755991,48.8276940066496,47.2067075956284,48.8935500000001,48.8935500000001,48.8276940066496,50.6194914652083,48.8276940066496,50.674,45.8159200000001,48.8276940066496,48.8376400000001,48.58504,50.60585,48.8276940066496,48.8574097079022,48.7820785390683,48.8276940066496,48.9250200000001,48.8276940066496,48.8276940066496,50.6371823834797,50.60585,48.8276940066496,48.8261226082913,50.6120100433994,50.6120100433994,48.89617,47.2086104781915,48.8276940066496,48.8935500000001,48.8276940066496,48.9001400000001,48.8276940066496,48.8276940066496,48.6159000000001,45.75917,45.194121000913,48.8276940066496,48.8276940066496,48.8276940066496,44.24965,48.71299,48.8276940066496,50.6371823834797,48.8262746628261,48.8276940066496,48.8935500000001,48.8276940066496,48.8276940066496,48.9399300000001,43.7042970134431,44.8224958398699,48.25316,47.2086104781915,48.8258947847109,48.39043,48.8276940066496,46.3310324878392,48.8276940066496,48.830678830864,45.194121000913,45.75917,50.6371823834797,45.75917,50.6371823834797,48.88822,48.8258208870661,45.75917,46.559417044,50.6371823834797,43.62235,43.5168546243986,43.6597741755991,47.2086104781915,48.8258947847109,44.8367000000001,48.8276940066496,48.8262746628261,48.89617,45.790968583422,49.2091530679694,48.8276940066496,48.9250200000001,48.8276940066496,48.88264,48.8276940066496,47.2086104781915,48.8276940066496,48.8212300000001,48.8276940066496,48.9071000000001,48.8276940066496,50.6914300000001,47.2086104781915,50.6582419810157,45.1564112169298,48.7929100000001,43.6211015185853,48.843226371132,43.62235,48.0981927928816,48.8116800000001,43.6211015185853,48.88437,48.8276940066496,48.8212300000001,48.89617,50.6371823834797,43.6392095751544,50.6371823834797,48.8371784449714,48.69883,48.83525,48.8276940066496,48.8276940066496,50.60585,48.8574097079022,43.5168546243986,48.9071000000001,48.88822,50.6371823834797,49.00397,48.8212300000001,48.8212300000001,48.8212300000001,48.830678830864,48.0981927928816,48.9001400000001,43.6211015185853,48.8276940066496,48.8276940066496,48.8481900230275,48.89617,48.8276940066496,48.8276940066496,48.76989,48.89617,48.8276940066496,48.76989,48.89617,48.8276940066496,46.3000000000001,48.88437,50.6914300000001,44.8367000000001,43.5168546243986,50.6371823834797,48.88822,43.6211015185853,48.8574097079022,45.194121000913,45.75917,48.88437,48.88437,50.6371823834797,48.8276940066496,48.8276940066496,48.88822,44.7881781565531,48.89617,48.8276940066496,48.37269,43.69381,48.43602,48.88264,50.60585,48.8305285361195,48.8371283233509,48.8935500000001,48.8258947847109,46.559417044,48.8276940066496,48.8276940066496,47.3019094848752,50.6582419810157,48.8276940066496,48.8276940066496,48.8276940066496,43.31856,48.80668,48.8276940066496,50.6798000000001,47.8029700000001,47.4741687345227,47.2086104781915,48.8262746628261,48.8276940066496,48.8212300000001,48.8276940066496,48.8276940066496,45.8991,48.8931433281449,43.6597741755991,48.8276940066496,48.8276940066496,48.80668,48.8276940066496,50.39689,50.6371823834797,48.83525,48.775958474443,48.88822,48.8276940066496,48.871045,44.8418100000001,48.8276940066496,48.8276940066496,46.32124,48.9280000000001,48.8371283233509,48.8276940066496,48.83525,48.8276940066496,48.8935500000001,43.31856,50.6371823834797,48.8276940066496,48.8263481193168,48.8276940066496,48.8276940066496,48.871045,43.6211015185853,45.8991,44.9113400000001,50.6371823834797,46.32124,45.1637400000001,50.6371823834797,50.6371823834797,47.47457,48.80082,50.6582419810157,48.88822,45.6188700000001,48.88264,48.8276940066496,48.83525,48.82163,46.559417044,50.687580340085,48.8276940066496,47.2086104781915,46.559417044,48.8276940066496,43.31856,48.8276940066496,48.8276940066496,47.2975000000001,48.8276940066496,45.6467700000001,48.8276940066496,48.8276940066496,48.79983,48.9280000000001,48.8276940066496,48.8276940066496,48.9136,48.88264,43.5168546243986,48.8276940066496,48.8276940066496,44.8367000000001,48.65058,50.6371823834797,50.6371823834797,48.8276940066496,45.194121000913,48.8305285361195,48.8276940066496,45.75917,48.80668,43.5934298639117,48.88437,43.6211015185853,48.8276940066496,50.6371823834797,48.8276940066496,48.8574097079022,45.1564112169298,45.75917,48.88437,48.8276940066496,47.2086104781915,43.62235,48.8276940066496,43.5296500000001,48.83525,46.3265000000001,46.32124,47.6583400000001,43.5168546243986,44.8367000000001,50.7228769167483,48.8276940066496,48.8276940066496,44.8367000000001,48.8677300000001,43.31856,48.8276940066496,48.8276940066496,45.7740463965525,48.8276940066496,44.8367000000001,44.8367000000001,48.8276940066496,48.8375632433342,45.75917,48.8276940066496,48.8574097079022,46.559417044,47.7517,48.8931433281449,45.75917,48.88437,48.7130300000001,48.88822,43.62235,48.8931433281449,48.8677300000001,48.8276940066496,43.6211015185853,49.00397,48.8276940066496,48.89617,48.95599,48.8370782017304,48.6126300000001,50.6371823834797,48.8305285361195,45.764734043248,49.0755100000001,48.81215,43.3003027583506,43.62235,48.89617,41.3877400000001,48.8276940066496,48.8276940066496,50.6371823834797,48.8375632433342,48.8276940066496,48.88437,48.8276940066496,48.7999060070039,50.6371823834797,48.89617,48.8677300000001,48.8276940066496,48.8574097079022,48.83525,48.8276940066496,50.6371823834797,45.764734043248,43.69381,48.8931433281449,48.77108,50.6582419810157,48.8276940066496,50.5764300000001,50.6371823834797,48.58504,50.6371823834797,48.5802100000001,48.8571700000001,48.8276940066496,45.75917,50.6371823834797,49.0752600000001,48.8574097079022,48.8276940066496,50.6371823834797,48.8276940066496,43.41808,48.64261,45.75917,48.81215,43.6392095751544,50.6120100433994,48.8258208870661,48.84707,48.8276940066496,48.89617,48.8305285361195,45.194121000913,48.8276940066496,48.8276940066496,45.75917,48.8276940066496,48.8481900230275,48.8375632433342,43.63458,48.8574097079022,48.8370782017304],[2.30434645326201,2.35547000000003,2.37910003512124,2.37910003512124,2.63375547244205,2.63375547244205,-0.581069999999954,2.24024000000003,3.09420000000006,2.37910003512124,2.23791000000006,-1.17890999999997,1.41814319795288,2.38156341157237,2.37910003512124,2.37910003512124,2.37910003512124,2.12583000000006,2.24489767198392,1.39684000000005,1.42183453177351,7.25148501212311,0.620550000000037,2.37910003512124,7.04721000000006,1.41814319795288,2.22674174092761,-0.347240731774215,2.37910003512124,2.55053995300005,1.41814319795288,2.37650024406499,2.25648000000007,2.19428000000005,2.22674174092761,5.72091403683689,-0.581069999999954,3.90526000000006,2.06970000000007,2.34140000000002,5.44543867691176,2.37910003512124,1.42183453177351,2.37910003512124,5.44543867691176,2.25648000000007,5.44543867691176,2.66413000000006,2.37910003512124,1.94898000000006,2.37910003512124,2.34140000000002,2.28959000000003,2.37910003512124,2.22674174092761,2.28826745484995,2.37910003512124,2.19428000000005,2.25648000000007,2.38130747959828,2.19428000000005,2.25648000000007,2.38130747959828,2.22724000000005,2.34860000000003,2.37650024406499,2.55053995300005,2.19428000000005,2.24073000000004,-0.463379999999972,2.37910003512124,3.87336959872347,2.38104254662466,2.34140000000002,-0.604462092824452,2.37910003512124,2.35547000000003,2.41350000000006,-0.581069999999954,2.23791000000006,2.28980000000007,2.41788000000003,2.55053995300005,2.36933000000005,2.37910003512124,2.37910003512124,2.34159982722465,4.90230000000003,1.41814319795288,5.04299000000003,2.37910003512124,2.38151779666531,2.37910003512124,4.92261171724876,2.37910003512124,2.37910003512124,2.35547000000003,3.01920473644255,2.37910003512124,2.37910003512124,3.01920473644255,-1.15163999999993,2.24073000000004,2.37910003512124,3.01920473644255,2.37910003512124,2.37910003512124,-0.581069999999954,6.16731649296845,2.26310000000007,-0.347240731774215,2.22674174092761,5.40836000000007,4.82965000000007,2.38168989223694,2.19428000000005,2.22612000000004,3.01920473644255,2.37910003512124,2.37910003512124,2.45522013504922,-1.20213999999993,2.22674174092761,2.37910003512124,2.37650024406499,2.38130747959828,2.37910003512124,-0.581069999999954,2.24073000000004,2.63375547244205,2.37910003512124,2.24073000000004,2.37910003512124,2.24489767198392,2.37910003512124,3.055030118234,6.17145000000005,2.37910003512124,4.81297429597299,2.37910003512124,3.01920473644255,2.37910003512124,2.37910003512124,2.37910003512124,2.24024000000003,2.35547000000003,5.40836000000007,3.01920473644255,2.24073000000004,4.82965000000007,2.55053995300005,5.39068374837129,2.36933000000005,2.24073000000004,2.42461000000003,2.34159982722465,5.00204000000002,2.37910003512124,0.68957000000006,2.26610016700937,2.37910003512124,4.75352000000004,3.09420000000006,4.8196192395397,2.37650024406499,2.19428000000005,1.0811230001304,2.37910003512124,5.72091403683689,2.37910003512124,2.13844000000006,2.41350000000006,2.51638000000003,2.26610016700937,3.07722000000007,2.38489000000004,2.37910003512124,4.81732000000005,5.40836000000007,4.8635710317682,4.8635710317682,-1.76098999999994,2.37910003512124,5.40836000000007,2.37679893592174,2.38185942419139,1.41814319795288,2.37910003512124,2.38151779666531,2.37910003512124,2.26638000000003,2.19428000000005,7.36469000000005,2.37910003512124,2.37910003512124,5.72091403683689,2.38151779666531,2.13844000000006,3.07743000000005,3.055030118234,0.68957000000006,3.055030118234,4.8196192395397,1.41814319795288,2.37910003512124,2.38489000000004,2.37910003512124,2.44265000000007,4.75352000000004,4.82965000000007,2.37910003512124,2.25648000000007,2.37910003512124,2.37910003512124,2.37910003512124,0.359270000000038,2.37650024406499,2.19428000000005,2.37910003512124,2.33495000000005,2.30646000000007,1.42183453177351,2.37910003512124,-1.57767546611809,2.28959000000003,2.28959000000003,2.37910003512124,3.13113286260462,2.37910003512124,3.09420000000006,4.81732000000005,2.37910003512124,2.63240000000008,7.73642000000007,3.07743000000005,2.37910003512124,2.34159982722465,2.20206992499755,2.37910003512124,2.29449000000005,2.37910003512124,2.37910003512124,3.01920473644255,3.07743000000005,2.37910003512124,2.38143838663328,3.055030118234,3.055030118234,2.25648000000007,-1.61106447839568,2.37910003512124,2.28959000000003,2.37910003512124,2.30646000000007,2.37910003512124,2.37910003512124,2.37778000000003,4.82965000000007,5.72091403683689,2.37910003512124,2.37910003512124,2.37910003512124,2.14805000000007,2.36571000000004,2.37910003512124,3.01920473644255,2.38117616321901,2.37910003512124,2.28959000000003,2.37910003512124,2.37910003512124,2.35547000000003,7.25148501212311,-0.636072428533597,-0.777579999999944,-1.61106447839568,2.38185942419139,-4.48657999999995,2.37910003512124,-0.488464577230201,2.37910003512124,2.37679893592174,5.72091403683689,4.82965000000007,3.01920473644255,4.82965000000007,3.01920473644255,2.19428000000005,2.38151779666531,4.82965000000007,2.55053995300005,3.01920473644255,7.04721000000006,5.44543867691176,1.42183453177351,-1.61106447839568,2.38185942419139,-0.581069999999954,2.37910003512124,2.38117616321901,2.25648000000007,4.81297429597299,-0.326178402238162,2.37910003512124,2.29449000000005,2.37910003512124,2.24024000000003,2.37910003512124,-1.61106447839568,2.37910003512124,2.25161000000003,2.37910003512124,2.03846000000004,2.37910003512124,3.17318000000006,-1.61106447839568,3.09283602195458,5.73250854172348,2.36933000000005,1.41814319795288,2.60427375623012,7.04721000000006,-1.70524202042241,2.38489000000004,1.41814319795288,2.26935000000003,2.37910003512124,2.25161000000003,2.25648000000007,3.01920473644255,3.87336959872347,3.01920473644255,2.37055521314355,2.18778000000003,2.24073000000004,2.37910003512124,2.37910003512124,3.07743000000005,2.34159982722465,5.44543867691176,2.03846000000004,2.19428000000005,3.01920473644255,2.51638000000003,2.25161000000003,2.25161000000003,2.25161000000003,2.37679893592174,-1.70524202042241,2.30646000000007,1.41814319795288,2.37910003512124,2.37910003512124,2.24489767198392,2.25648000000007,2.37910003512124,2.37910003512124,7.41319000000004,2.25648000000007,2.37910003512124,7.41319000000004,2.25648000000007,2.37910003512124,4.83333000000005,2.26935000000003,3.17318000000006,-0.581069999999954,5.44543867691176,3.01920473644255,2.19428000000005,1.41814319795288,2.34159982722465,5.72091403683689,4.82965000000007,2.26935000000003,2.26935000000003,3.01920473644255,2.37910003512124,2.37910003512124,2.19428000000005,-0.713274833749649,2.25648000000007,2.37910003512124,7.59395000000006,5.50134000000003,-4.40055999999993,2.24024000000003,3.07743000000005,2.37650024406499,2.3705783511708,2.28959000000003,2.38185942419139,2.55053995300005,2.37910003512124,2.37910003512124,-1.49208678984398,3.09283602195458,2.37910003512124,2.37910003512124,2.37910003512124,5.40836000000007,2.33684000000005,2.37910003512124,3.15685000000002,6.38246000000004,-0.545803247183234,-1.61106447839568,2.38117616321901,2.37910003512124,2.25161000000003,2.37910003512124,2.37910003512124,6.12870000000004,2.22674174092761,1.42183453177351,2.37910003512124,2.37910003512124,2.33684000000005,2.37910003512124,3.06215000000003,3.01920473644255,2.24073000000004,2.45522013504922,2.19428000000005,2.37910003512124,2.22145149000005,-0.64758999999998,2.37910003512124,2.37910003512124,-0.463379999999972,2.04257000000007,2.3705783511708,2.37910003512124,2.24073000000004,2.37910003512124,2.28959000000003,5.40836000000007,3.01920473644255,2.37910003512124,2.38104254662466,2.37910003512124,2.37910003512124,2.22145149000005,1.41814319795288,6.12870000000004,-0.24398999999994,3.01920473644255,-0.463379999999972,6.08892000000003,3.01920473644255,3.01920473644255,-0.630699999999933,2.03087000000005,3.09283602195458,2.19428000000005,5.22923000000003,2.24024000000003,2.37910003512124,2.24073000000004,2.41350000000006,2.55053995300005,3.1160102433327,2.37910003512124,-1.61106447839568,2.55053995300005,2.37910003512124,5.40836000000007,2.37910003512124,2.37910003512124,-1.49180999999993,2.37910003512124,5.02340000000004,2.37910003512124,2.37910003512124,2.28980000000007,2.04257000000007,2.37910003512124,2.37910003512124,2.38237000000004,2.24024000000003,5.44543867691176,2.37910003512124,2.37910003512124,-0.581069999999954,-2.02314999999993,3.01920473644255,3.01920473644255,2.37910003512124,5.72091403683689,2.37650024406499,2.37910003512124,4.82965000000007,2.33684000000005,2.23266090223159,2.26935000000003,1.41814319795288,2.37910003512124,3.01920473644255,2.37910003512124,2.34159982722465,5.73250854172348,4.82965000000007,2.26935000000003,2.37910003512124,-1.61106447839568,7.04721000000006,2.37910003512124,1.52709000000004,2.24073000000004,-0.46037578499994,-0.463379999999972,-2.75984999999997,5.44543867691176,-0.581069999999954,3.16421650211755,2.37910003512124,2.37910003512124,-0.581069999999954,2.22612000000004,5.40836000000007,2.37910003512124,2.37910003512124,3.11905656280128,2.37910003512124,-0.581069999999954,-0.581069999999954,2.37910003512124,2.37058478131182,4.82965000000007,2.37910003512124,2.34159982722465,2.55053995300005,7.34367000000003,2.22674174092761,4.82965000000007,2.26935000000003,2.24628000000007,2.19428000000005,7.04721000000006,2.22674174092761,2.22612000000004,2.37910003512124,1.41814319795288,2.51638000000003,2.37910003512124,2.25648000000007,2.54041000000007,2.37060148919805,2.48231000000004,3.01920473644255,2.37650024406499,4.88650254912447,2.67528000000004,2.35699000000005,-0.347240731774215,7.04721000000006,2.25648000000007,9.160870000000051,2.37910003512124,2.37910003512124,3.01920473644255,2.37058478131182,2.37910003512124,2.26935000000003,2.37910003512124,2.63375547244205,3.01920473644255,2.25648000000007,2.22612000000004,2.37910003512124,2.34159982722465,2.24073000000004,2.37910003512124,3.01920473644255,4.88650254912447,5.50134000000003,2.22674174092761,2.06970000000007,3.09283602195458,2.37910003512124,3.05293000000006,3.01920473644255,7.73642000000007,3.01920473644255,7.68693000000007,2.34140000000002,2.37910003512124,4.82965000000007,3.01920473644255,2.10472000000004,2.34159982722465,2.37910003512124,3.01920473644255,2.37910003512124,5.21420000000006,2.29250000000008,4.82965000000007,2.35699000000005,3.87336959872347,3.055030118234,2.38151779666531,2.37578000000002,2.37910003512124,2.25648000000007,2.37650024406499,5.72091403683689,2.37910003512124,2.37910003512124,4.82965000000007,2.37910003512124,2.24489767198392,2.37058478131182,1.39684000000005,2.34159982722465,2.37060148919805],null,null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},["<b>Data Scientist junior (H/F)<\/b> <br/> Kea & Partners","<b>Data Scientist (F ou H)<\/b> <br/> SNCF","<b>Data Scientist (H/F) (IT)<\/b> <br/> Yzee Services","<b>Data Scientist H/F<\/b> <br/> Natan (SSII)","<b>Data Scientist Junior H/F / Freelance<\/b> <br/> karma partners","<b>Data Scientist junior / Freelance<\/b> <br/> STA","<b>Data scientist H/F<\/b> <br/> Unicancer","<b>Data Scientist H/F<\/b> <br/> datakeen","<b>Data Scientist F/H<\/b> <br/> KISS THE BRIDE","<b>Data Scientist H/F<\/b> <br/> Groupe Demeter","<b>Data Scientist - H/F<\/b> <br/> Bouygues Telecom","<b>Data scientist<\/b> <br/> Manitou Group","<b>Bioprocess modeler/Data scientist H/F<\/b> <br/> ALTRAN","<b>Data Scientist H/F<\/b> <br/> K-ciopé","<b>Data Scientist - Projet Énergie Verte<\/b> <br/> MP Data","<b>Data Scientist - Projet Énergie Verte<\/b> <br/> MP Data","<b>Data Scientist (m/f/d) - Paris<\/b> <br/> Simon-Kucher & Partners","<b>Data Scientist H/F<\/b> <br/> GCS SAS","<b>Data Scientist NLP<\/b> <br/> MP DATA","<b>DATA ENGINEER/SCIENTIST SKYWISE (H/F)<\/b> <br/> Airbus","<b>Data Scientist H/F<\/b> <br/> Solutec","<b>Data Scientist (Data team)<\/b> <br/> Veepee","<b>Data Scientist F/H<\/b> <br/> Réseau Primever France","<b>Data Scientist H/F<\/b> <br/> NEO2","<b>Data Scientist - H/F<\/b> <br/> Micromania Zing","<b>Data Scientist bio-informatique H/F<\/b> <br/> ALTRAN","<b>Consultant débutant en data sciences F/H - Paris<\/b> <br/> EY","<b>Data Scientist H/F<\/b> <br/> MP DATA","<b>Consultant.e Data Scientist (H/F)<\/b> <br/> June Partners","<b>Computer Vision ML, Data scientist<\/b> <br/> Sightengine","<b>Data Scientist - Computer Vision - Full remote / Freelance<\/b> <br/> Trait d'Union Consulting","<b>Data Scientist (H/F)<\/b> <br/> Nestle","<b>Data Scientist - Énergies Renouvelables<\/b> <br/> MP DATA","<b>Junior Data Scientist<\/b> <br/> Systemathics","<b>Consultant débutant data analytics F/H - Paris<\/b> <br/> EY","<b>Data Scientist H/F<\/b> <br/> Inetum","<b>Data Scientist F/M<\/b> <br/> Betclic Group","<b>Data analyst junior H/F<\/b> <br/> Septeo","<b>Data Scientist (H/F)<\/b> <br/> Renault Group","<b>Data scientist H/F<\/b> <br/> Pôle Emploi","<b>Data scientist confirmé AIX EN PROVENCE H/F<\/b> <br/> Capgemini","<b>Data Scientist H/F<\/b> <br/> Groupe Pierre & Vacances - Center Parcs","<b>DATA SCIENTIST / DATA ENGINEER, Secteur aéronautique<\/b> <br/> ALTEN","<b>DATA SCIENTIST F/H<\/b> <br/> HARNHAM","<b>Data Scientist F/H<\/b> <br/> Voyage Privé","<b>DATA SCIENTIST<\/b> <br/> Aquila Consulting","<b>ALT - DATA Scientist (F/H)<\/b> <br/> GRDF","<b>Data scientist / Ingénieur en Intelligence Artificielle F/H...<\/b> <br/> Pôle Emploi","<b>DATA SCIENTIST F/H<\/b> <br/> InVivo","<b>Data Scientist - F/H<\/b> <br/> Thales","<b>Data Scientist<\/b> <br/> AZAP","<b>Data scientist user behaviour H/F<\/b> <br/> Se Loger","<b>Data Scientist<\/b> <br/> Ysance","<b>Ingénieur Data Scientist Junior H/F<\/b> <br/> AKKA TECHNOLOGIES","<b>Consultant Débutant - DATA Analyst - 2022 - Paris - H/F - oc...<\/b> <br/> EY","<b>Ingénieur Data Scientist Junior - Intelligence Artificielle...<\/b> <br/> Ivalua","<b>DATA SCIENTIST COMPUTER VISION<\/b> <br/> Aquila Consulting","<b>Data Scientist Paiements -(H/F)<\/b> <br/> Société Générale","<b>Data Scientist - H/F<\/b> <br/> Dalkia","<b>Data Scientist<\/b> <br/> Collective Thinking","<b>Data Scientist Paiements -(H/F)<\/b> <br/> Société Générale","<b>Data Scientist - H/F<\/b> <br/> Dalkia","<b>Data Scientist<\/b> <br/> Collective Thinking","<b>Data Scientist F/H<\/b> <br/> haxio","<b>Data Scientist<\/b> <br/> Silex","<b>Data scientist H/F<\/b> <br/> Crédit Agricole Assurances","<b>Audio & Speech Recognition Data scientist<\/b> <br/> Sightengine","<b>Data Scientist - Analytics Clients - H/F<\/b> <br/> BNP Paribas","<b>Data Analyst H/F<\/b> <br/> Bouygues Telecom","<b>Data Scientist Scoring - CDD 12 mois - NIORT F/H<\/b> <br/> MAIF","<b>Data Analyst Junior (F/H) - CDI<\/b> <br/> Nexity","<b>Data analyste<\/b> <br/> PwC","<b>Consultant Data Scientist (H/F)<\/b> <br/> METRICS","<b>Data Scientist (full time, all seniority levels) - QuantumBl...<\/b> <br/> McKinsey & Company","<b>Data scientist<\/b> <br/> Meggitt","<b>Consultant Junior & Data Scientist (H/F/N)<\/b> <br/> Ekimetrics","<b>Data Analyst H/F<\/b> <br/> Generali France","<b>Data Scientist (H/F)<\/b> <br/> Natixis","<b>Data Scientist F/M<\/b> <br/> Automotive Cells Company - ACC","<b>Data Scientist Performance Mobile H/F<\/b> <br/> Bouygues Telecom","<b>Data Scientist (H/F)<\/b> <br/> LES MOUSQUETAIRES","<b>Data Scientist<\/b> <br/> datafab.io","<b>NLP Data scientist<\/b> <br/> Sightengine","<b>Data Scientist IG H/F<\/b> <br/> LCL","<b>Data Scientist | Python | Editeur de logiciel en...<\/b> <br/> Octopus IT","<b>Data Scientist (H/F)<\/b> <br/> Positive Thinking Company","<b>Data Scientist<\/b> <br/> Numberly","<b>Data analyst F/H<\/b> <br/> Eiffage","<b>Data Scientist F/H<\/b> <br/> PredExIA","<b>Engineer Data Scientist H/F<\/b> <br/> BioSerenity","<b>Data Scientist Energétique<\/b> <br/> WeSmart","<b>Data Scientist<\/b> <br/> DAMAE Medical","<b>Consultant(e) Data scientist – métiers bancaire<\/b> <br/> Groupe Consortia","<b>INGENIEUR·E D’ETUDE DATA SCIENTIST<\/b> <br/> Université Gustave Eiffel","<b>Data Scientist - Data Science<\/b> <br/> Datadog","<b>Data Scientist H/F<\/b> <br/> TotalEnergies","<b>Data Scientist (modélisation études risque) H/F en CDI<\/b> <br/> La Banque Postale Consumer Finance","<b>Data Analyst Junior (H/F)<\/b> <br/> Insitoo","<b>DATA SCIENTIST - F/H<\/b> <br/> Banque de France","<b>Data Analyst F/H<\/b> <br/> Kent FR","<b>Data Analyst / Freelance<\/b> <br/> GROUPE HN","<b>Data Scientist (H/F)<\/b> <br/> pasteque.io","<b>Data Scientist F/H<\/b> <br/> agap2 IT","<b>Consultant Explorateur Data Scientist – Santé H/F<\/b> <br/> Alcimed","<b>Data Scientist – Consultant – Financial Services (H/F)<\/b> <br/> Deloitte","<b>Data Scientist / Senior Data Scientist<\/b> <br/> FactSet Research Systems","<b>Data Scientist H/F<\/b> <br/> Michael Page","<b>Senior Data Scientist<\/b> <br/> Dataworks","<b>Data Scientist Python - Azure H/F<\/b> <br/> DSI Group","<b>Data Scientist - FMCG / données consommateurs H/F/X<\/b> <br/> Mondelez","<b>Data Analyst/Data Quality H/F<\/b> <br/> CGI Inc","<b>Consultant Data Analyst Débutant F/H - Septembre 2022<\/b> <br/> EY","<b>Data Scientist H/F<\/b> <br/> Volta Medical","<b>Data Scientist (H/F)<\/b> <br/> Activus Group","<b>Data analyst Datalake (F/H)<\/b> <br/> Digital Partners","<b>DATA SCIENTIST SPÉCIALISÉ R<\/b> <br/> Aquila Consulting","<b>Data Scientist (F/H) CDI<\/b> <br/> Médiaperformances","<b>Data Scientist (H/F)<\/b> <br/> Insitoo","<b>Chargé d'Etudes Statistiques/Data Scientist H/F<\/b> <br/> PRINTEMPS","<b>DATA SCIENTIST<\/b> <br/> Harnham","<b>Computer Vision Data Scientist<\/b> <br/> Essilor","<b>Data scientist F/H<\/b> <br/> Manitou","<b>Senior Data Scientist (H/F)<\/b> <br/> Allianz France","<b>Consultant.e Data Scientist<\/b> <br/> Softeam","<b>Data scientist<\/b> <br/> FABDEV","<b>Data Analyst (H/F)<\/b> <br/> Groupe IGS","<b>Data Scientist (F/H)<\/b> <br/> Harwell Management","<b>DATA SCIENTIST - DÉVELOPPEUR CHATBOT CONFIRMÉ(E) - H/F<\/b> <br/> Talan","<b>Data Scientist-Analyst GERS (H/F) - Boulogne-Billancourt (Fr...<\/b> <br/> Cegedim","<b>Data Scientist / Machine Learning Engineer<\/b> <br/> Air France-KLM","<b>Data Scientist h/f<\/b> <br/> HeadMind Partners","<b>Data Analyst H/F<\/b> <br/> L ETUDIANT","<b>Data Scientist<\/b> <br/> Artefact","<b>Consultant data Scientist et Python F/H<\/b> <br/> MANAGEMENT INFORMATIQUE & NOUVELLES TECHNOLOGIES...","<b>Consultant(e) Junior Data Analytics H/F<\/b> <br/> mc2i","<b>Data Scientist H/F - Lille<\/b> <br/> AVISIA","<b>Data Scientist Junior<\/b> <br/> Xtramile","<b>Data Scientist - COPERNEEC<\/b> <br/> Coperneec","<b>DATA SCIENTIST F/H<\/b> <br/> AVISIA ALPES","<b>Data Analyst Junior<\/b> <br/> RSM France","<b>Data Analyst H/F<\/b> <br/> AUSY FRANCE","<b>Data Scientist NLP - Paris - H/F<\/b> <br/> CleverConnect","<b>Data Scientist<\/b> <br/> Nova Consulting","<b>Data Analyst Junior F/H<\/b> <br/> PICNIC","<b>Data Analyst [risque]<\/b> <br/> Kaino","<b>ALT-DATA ANALYST DASHBOARD PROJETS H/F<\/b> <br/> Generali France","<b>Data scientist<\/b> <br/> WitMonki","<b>DATA ANALYST<\/b> <br/> Harnham","<b>Data Analyst IT (H/F)<\/b> <br/> Renault Group","<b>Data Analyst (H/F)<\/b> <br/> GRANDLYON HABITAT","<b>Data & Analytics Consultant<\/b> <br/> Dataworks","<b>Offre d'emploi en CDI : Data Scientist<\/b> <br/> Jalis","<b>DATA Analyst H/F<\/b> <br/> LCL","<b>Data Analyst H/F<\/b> <br/> Lobster communication","<b>Data Analyst H/F<\/b> <br/> BFR Systems","<b>Data Analyst<\/b> <br/> Deezer","<b>Analyste Data h/f<\/b> <br/> ISERBA","<b>Data Scientist (F/M)<\/b> <br/> Younited Credit","<b>Data Analyst<\/b> <br/> Daher","<b>Data/Analyst Data Translator (H/F)<\/b> <br/> Carrefour","<b>Consultant Data Analytics<\/b> <br/> Dataworks","<b>DATA ANALYST H/F<\/b> <br/> HC RESOURCES","<b>Data Scientist H/F<\/b> <br/> Lesaffre","<b>Data Scientist F/H<\/b> <br/> KLANIK","<b>Data analyst<\/b> <br/> Pôle Emploi","<b>Data Scientist H/F<\/b> <br/> Groupama Assurances Mutuelles","<b>Responsable Data Scientist (F/H)<\/b> <br/> Don't Call Me Jennyfer","<b>Data Scientist – F/H<\/b> <br/> Adevinta Group","<b>DATA SCIENTIST - CDI - F/H<\/b> <br/> spartoo.com","<b>DATA SCIENTIST SANTÉ F/H<\/b> <br/> GIP SESAN","<b>Data Scientist - F/H<\/b> <br/> Air Liquide","<b>Data Scientist (F/H)<\/b> <br/> Groupe BPCE","<b>Data Analyst- Economie des Lignes H/F<\/b> <br/> Air France-KLM","<b>Data Analyst (H/F)<\/b> <br/> Carrefour","<b>Data Scientist Expérimenté - F/H<\/b> <br/> Accenture","<b>Data Scientist F/H<\/b> <br/> Fnac Darty","<b>Data Scientist<\/b> <br/> Margo Conseil","<b>Data Scientist H/F<\/b> <br/> REEL","<b>Data Scientist pour l'imagerie en Neuroscience F/H<\/b> <br/> Aix-Marseille Université","<b>Data Analyst - H/F<\/b> <br/> Avisto","<b>Data Analyst - H/F<\/b> <br/> Avisto","<b>Data scientist H/F<\/b> <br/> Segula Technologies","<b>Data Scientist Senior<\/b> <br/> Cleyrop","<b>Data scientist<\/b> <br/> IA BTP","<b>Data Scientist<\/b> <br/> AVIV Group","<b>Data Analyst (H/F)<\/b> <br/> Mydral","<b>DATA SCIENTIST – 3DTRUST H/F<\/b> <br/> Basseti Group","<b>Data Scientist h-f<\/b> <br/> Danem People France","<b>Data Analyst H/F<\/b> <br/> Kaino","<b>Accelerator - Junior Data Scientist (M/F)<\/b> <br/> Sanofi","<b>Ingénieur Data Scientist Prestation GMP H/F<\/b> <br/> Renault Group","<b>CHARGE(E) D’ETUDES STATISTIQUES / DATA ANALYST-(H/F)<\/b> <br/> Société Générale","<b>Research Engineer – Data Scientist<\/b> <br/> PPRS Research","<b>Data Scientist F/H<\/b> <br/> YZEE SERVICES","<b>Data Scientist H/F - CDI<\/b> <br/> Richemont","<b>DATA SCIENTIST - CDI - F/H<\/b> <br/> spartoo.com","<b>Data Analyst H/F<\/b> <br/> Kaino","<b>Data Scientist - F/H<\/b> <br/> Air Liquide","<b>Data Scientist - DP4P (H/F)<\/b> <br/> ADEO Services","<b>Data Analyst (F/H)<\/b> <br/> Meilleurtaux","<b>Data Analyste H/F<\/b> <br/> Q1C1","<b>Data Analyst<\/b> <br/> Extia","<b>Data Scientist F/H<\/b> <br/> KLANIK","<b>DATA SCIENTIST – 3DTRUST H/F<\/b> <br/> Basseti Group","<b>Data Scientist – F/H<\/b> <br/> Adevinta Group","<b>Data Scientist F/H<\/b> <br/> Fnac Darty","<b>Senior Data Scientist<\/b> <br/> Cegid","<b>Data Scientist / Data analyst F/H<\/b> <br/> AUTOVISION","<b>DATA ANALYST H/F<\/b> <br/> HC RESOURCES","<b>Data analyst junior<\/b> <br/> Easylife","<b>Data Science Manager (F/H)<\/b> <br/> Accenture","<b>Data Scientist F/H<\/b> <br/> autobiz","<b>Data Analyst (H/F)<\/b> <br/> Guerlain","<b>DATA SCIENCE CONSULTANT PARIS<\/b> <br/> managementsolutions","<b>DATA SCIENTIST NLP<\/b> <br/> Aquila Consulting","<b>Data Analyst KUSMI TEA H/F<\/b> <br/> KUSMI TEA","<b>Data scientist<\/b> <br/> FABDEV","<b>CHARGE(E) D’ETUDES STATISTIQUES / DATA ANALYST-(H/F)<\/b> <br/> Société Générale","<b>Consultant.e Data Scientist<\/b> <br/> Softeam","<b>Data Analyst - (F/H)<\/b> <br/> Avisto","<b>Data Analyst (H/F)<\/b> <br/> TAXIS G7","<b>Data Analyst H/F<\/b> <br/> GESER BEST","<b>CDD DATA ANALYST H/F<\/b> <br/> Caisse des Dépôts","<b>Data Scientist Climat<\/b> <br/> Generali France","<b>Junior data analyst H/F<\/b> <br/> Lagardere","<b>Junior data analyst H/F<\/b> <br/> Lagardere","<b>Data Scientist - COPERNEEC<\/b> <br/> Coperneec","<b>Data Analyst (F/H)<\/b> <br/> Auchan Retail France","<b>Ingénieur Data Scientist H/F<\/b> <br/> AKKA TECHNOLOGIES","<b>Data Scientist H/F<\/b> <br/> Lesaffre","<b>Data Scientist H/F<\/b> <br/> REEL","<b>Data Analyst (H/F/NB)<\/b> <br/> Synchrone","<b>Analyste de données (Data analyst)<\/b> <br/> ONISEP","<b>Data Analyst (H/F)<\/b> <br/> Hess Automobile","<b>DATA ANALYST - SCDP (F/H)<\/b> <br/> ADEO Services","<b>Data Scientist Confirmé<\/b> <br/> IPANEMA CONSULTING","<b>Product Analytic - Data Scientist<\/b> <br/> Criteo","<b>DATA SCIENTIST H/F<\/b> <br/> CAPGEMINI ENGINEERING","<b>Data Scientist F/H<\/b> <br/> YZEE SERVICES","<b>CDD - Data Analyst Junior H/F 92230, Gennevilliers, Hauts-de...<\/b> <br/> Audika","<b>Accelerator - Junior Data Scientist (M/F)<\/b> <br/> Sanofi","<b>Responsable Data Analyst F/H<\/b> <br/> Kent FR","<b>data analyst<\/b> <br/> Ausy","<b>Data Analyst Positive Impact - H/F<\/b> <br/> ADEO Services","<b>Lead Data Scientist<\/b> <br/> NATAN","<b>Data Analyst H/F<\/b> <br/> Les Nouveaux Héritiers","<b>Data Scientist H/F - Lille<\/b> <br/> AVISIA","<b>Data Scientist (H/F)<\/b> <br/> TALENTS RH","<b>Innovation / R&D / Data Sciences_Modèle d'offre d'emploi<\/b> <br/> SUEZ","<b>Data Scientist F/H<\/b> <br/> TELITEM CONSULTING","<b>Data analyst H/F<\/b> <br/> Econocom","<b>Junior data analyst H/F<\/b> <br/> Lagardère Travel Retail","<b>Apprenticeship Data Scientist F/M/<\/b> <br/> Subsea 7","<b>Data Analyst H/F<\/b> <br/> Monoprix.fr","<b>Data Analyst Senior F/H<\/b> <br/> 24S.com","<b>Data Analyst Senior F/H<\/b> <br/> 24S.com","<b>Data Analyst (H/F)<\/b> <br/> ÉQUIPEMENT DE LA MAISON","<b>ST I Data Scientist H/F<\/b> <br/> Vision Systems","<b>Data Scientist H/F<\/b> <br/> Schneider Electric","<b>DATA SCIENTIST / BIOSTATISTICIAN / BIOSTATISTICS<\/b> <br/> Ariana Pharma","<b>Data Analyst H/F<\/b> <br/> Sport Faction","<b>Data Analyst<\/b> <br/> TCO","<b>Ingénieur Pépinière DOP - Data Analyst Hubgrade (F/H)<\/b> <br/> Veolia","<b>Data Scientist Confirmé H/F<\/b> <br/> Air France-KLM","<b>Data Scientist H/F - CDI<\/b> <br/> Richemont","<b>Data Analyst H/F<\/b> <br/> Cenisis","<b>Data Analyst F/H<\/b> <br/> NATIXIS","<b>Data Scientist Senior<\/b> <br/> Dataworks","<b>Data Scientist H/F<\/b> <br/> Ekino France","<b>Data Scientist h-f<\/b> <br/> Danem People France","<b>Data Scientist h-f<\/b> <br/> Danem People France","<b>ALT - DATA SCIENTIST CLIMAT<\/b> <br/> Generali France","<b>Data Analyst H/F<\/b> <br/> Eau d'Azur","<b>Data Analyst H/F<\/b> <br/> BNP Paribas","<b>Data Scientist<\/b> <br/> บริษัท โตโยต้า ลีสซิ่ง (ประเทศไทย) จำกัด","<b>DATA SCIENTIST/DATA ANALYST<\/b> <br/> Go Concept","<b>DATA SCIENTIST (H/F)<\/b> <br/> mycommunIT","<b>Data Scientist / Data Analyst<\/b> <br/> Siderlog","<b>Data Analyst H/F<\/b> <br/> Epoka for Apside","<b>DATA ANALYST F/H<\/b> <br/> GESER BEST","<b>Ph.D Data Scientist - Machine Learning et Prévisions de séri...<\/b> <br/> QUANTMETRY","<b>Data Scientist<\/b> <br/> AVIV Group","<b>Data Scientist - Machine Learning (F/H)<\/b> <br/> Kelkoo LTD","<b>Data Scientist F/H<\/b> <br/> TOPORDER","<b>Data Analyst F/H<\/b> <br/> ADHERENCE CONSULTING","<b>Data Scientist F/H<\/b> <br/> TOPORDER","<b>Data Analyst F/H<\/b> <br/> ADHERENCE CONSULTING","<b>Data Analyste - Opérations/Ventes<\/b> <br/> EATON","<b>Data Analyst (H/F)<\/b> <br/> Interforum","<b>Data Analyst H/F<\/b> <br/> MDA Electroménager","<b>Ingénieur(e) Data Science, Machine Learning , Deep Learning<\/b> <br/> Data2innov","<b>Data Scientist NLP - Lille H/F<\/b> <br/> CleverConnect","<b>Data Scientist Senior<\/b> <br/> MyDataModels","<b>Data Analyst - Environnement<\/b> <br/> Simpliciti","<b>Thèse CIFRE (PhD Thesis) - Data Science / Artificial Intelli...<\/b> <br/> AIRBUS","<b>CHARGE(E) DE STATISTIQUES / DATA ANALYST (H/F)<\/b> <br/> CAF DE LOIRE-ATLANTIQUE","<b>Data Scientist (H/F)<\/b> <br/> Mydral","<b>Senior Data Scientist_<\/b> <br/> Sense4data","<b>Business Analyst Data<\/b> <br/> Softeam","<b>Data Analyst<\/b> <br/> 8SEC","<b>Data Analyst Junior - Paris - 2022 H/F<\/b> <br/> MAZARS","<b>Data Analyst F/H<\/b> <br/> IKIGAÏ","<b>Ingénieur Data Scientist / Dataviz h/f<\/b> <br/> Legallais","<b>Data Scientist<\/b> <br/> Pernod Ricard","<b>CDD - Data Analyst Junior H/F<\/b> <br/> Audika Groupe","<b>Data Analyst / Data Scientist F/H<\/b> <br/> Actirise","<b>ESG Data Analyst-(H/F)<\/b> <br/> Société Générale","<b>DATA ANALYST F/H<\/b> <br/> AQUANTIS","<b>DATA ANALYST H/F<\/b> <br/> Segula Technologies","<b>Data Analyst (H/F)<\/b> <br/> NJ PARTNERS","<b>CDD - Data Analyst F/H<\/b> <br/> La Banque Postale","<b>Data Engineer / Data Scientist<\/b> <br/> Quotatis Groupe","<b>DATA ANALYST – CDI (H/F)<\/b> <br/> IRI","<b>Data Analyst Fraude<\/b> <br/> Adevinta Group","<b>DATA SCIENTIST H/F<\/b> <br/> ÏDKIDS GROUP","<b>CHARGE(E) DE STATISTIQUES / DATA ANALYST (H/F)<\/b> <br/> CAF DE LOIRE-ATLANTIQUE","<b>Data Analyst<\/b> <br/> Market Espace","<b>Senior Data Scientist<\/b> <br/> HP","<b>Datascientist / Data Analyst H/F<\/b> <br/> LCL","<b>Data Analyste - Intelligence Economique (H/F)<\/b> <br/> Eowin","<b>DATA ANALYST BATIMENT<\/b> <br/> CSTB","<b>Data Scientist Senior<\/b> <br/> MyDataModels","<b>Data analyst F/H<\/b> <br/> YUMENS","<b>Data Analyst F/H<\/b> <br/> Fnac Darty","<b>DATA MINER F/H<\/b> <br/> PRO DIRECT SERVICES","<b>Lead Data Scientist<\/b> <br/> ILLUIN TECHNOLOGY","<b>Ph.D Data Scientist - Machine Learning et Prévisions de séri...<\/b> <br/> QUANTMETRY","<b>VIE - CANAL+ SUISSE - Data Analyst - F/H<\/b> <br/> Canal Plus","<b>Data Scientist III<\/b> <br/> American Express Global Business Travel","<b>Data Analyst (H/F)<\/b> <br/> Sii","<b>Data analyste| PwC Montpellier | CDI/CDD | H/F<\/b> <br/> PwC","<b>Data Analyst – Nord – Lille F/H<\/b> <br/> OTTEO","<b>Data Analyst F/H<\/b> <br/> Groupe IGS","<b>Data Scientist Position<\/b> <br/> PARIS-SACLAY CENTER FOR DATA SCIENCE","<b>Data Analyst Marketing Stratégique - Boursorama-(H/F)<\/b> <br/> Boursorama","<b>Data Analyst / Data Scientist F/H<\/b> <br/> Actirise","<b>Senior Data Scientist<\/b> <br/> Pernod Ricard","<b>Data Analyst - DP4P (H/F)<\/b> <br/> ADEO Services","<b>Data Analyst Programmatic<\/b> <br/> Numberly","<b>Data Analyst - Environnement<\/b> <br/> Groupe Berto","<b>DATA ANALYST – CDI (H/F)<\/b> <br/> IRI","<b>Data Scientist Senior<\/b> <br/> Plastic Omnium","<b>Data Analyst H/F<\/b> <br/> WEB TRANSITION","<b>Finance Data Analyst Flying Blue H/F<\/b> <br/> Air France-KLM","<b>CDD - Data Analyst F/H<\/b> <br/> La Banque Postale","<b>CDD - Data Analyst F/H<\/b> <br/> La Banque Postale","<b>Data Analyst Transport H/F<\/b> <br/> Transdev","<b>Data Scientist<\/b> <br/> AVIV Group","<b>Data Analyst Marketing F/H<\/b> <br/> Avanci","<b>Data Analyst (H/F)<\/b> <br/> G7","<b>Data Analyst H/F<\/b> <br/> umlaut","<b>CDD - 6 MOIS - DATA ANALYSTE<\/b> <br/> Caisse des Dépôts","<b>Consultant(e) BI / Data Analyst H/F<\/b> <br/> Decivision","<b>data analyst - reglementations bancaires+data F/H<\/b> <br/> GROUPE AYDON","<b>Data Scientist<\/b> <br/> KANTAR","<b>BUSINESS ANALYST DATA H/F<\/b> <br/> Caisse des Dépôts","<b>Vertica Data Scientist EMEA<\/b> <br/> Micro Focus","<b>Industrial Engineering Data Analyst<\/b> <br/> MARS","<b>CDD 12 MOIS - BUSINESS ET DATA ANALYST H/F H/F<\/b> <br/> CARGLASS","<b>Data scientist H/F - Innovation numérique<\/b> <br/> Polyconseil","<b>Industrial Engineering Data Analyst<\/b> <br/> MARS","<b>CDD 12 MOIS - BUSINESS ET DATA ANALYST H/F H/F<\/b> <br/> CARGLASS","<b>Data scientist H/F - Innovation numérique<\/b> <br/> Polyconseil","<b>Data Analyst H/F<\/b> <br/> MASSILLY HOLDING","<b>Data Analyst | H/F<\/b> <br/> PwC","<b>DATA SCIENTIST H/F<\/b> <br/> ÏDKIDS GROUP","<b>Data Scientist - Développeur Chatbot Confirmé(e) - H/F<\/b> <br/> Talan Opérations","<b>DATA ANALYST F/H<\/b> <br/> ALLOPNEUS.COM","<b>Data Analyst H/F<\/b> <br/> Inetum","<b>Analyste Business Data-(H/F)<\/b> <br/> Société Générale","<b>Data Analyst Océanographe – Observation spatiale (F/H)<\/b> <br/> ALTEN","<b>Data Scientist<\/b> <br/> Fideliz","<b>Data Analyst Senior H/F<\/b> <br/> CGI Inc","<b>Data scientist (H/F)<\/b> <br/> Opéra Conseil","<b>Manager Data Analytics| CDI | H/F<\/b> <br/> PwC","<b>Manager Data Analytics| CDI | H/F<\/b> <br/> PwC","<b>Senior Data Scientist<\/b> <br/> AG SOLUTION","<b>Data Engineer / Data Scientist<\/b> <br/> Quotatis Groupe","<b>Data Analyst | Luxe (H/F) Paris<\/b> <br/> CENOVA","<b>Data Analyst Achats H/F<\/b> <br/> Spie Batignolles","<b>Analyste (data) SIRH H/F<\/b> <br/> Mercer","<b>Innovation / R&D / Data Sciences_Modèle d'offre d'emploi<\/b> <br/> SUEZ","<b>Data Analyst H/NB/F<\/b> <br/> Ubisoft","<b>Data Business Analyst* H/F<\/b> <br/> Socomec","<b>Data Scientist (F/H)<\/b> <br/> PELLENC ST","<b>Data Analyst H/F<\/b> <br/> Crédit Mutuel Arkea","<b>Data Analyst - Power BI/Tableau F/H<\/b> <br/> MINSART-KREMER","<b>LEAD DATA SCIENTIST - F/H<\/b> <br/> ADEO Services","<b>Data Fraud Analyst<\/b> <br/> OVHcloud","<b>Data Analyst F/H<\/b> <br/> Crédit Agricole Assurances","<b>Data Analyst Marketing<\/b> <br/> Axys Consultants","<b>Manager Data Analytics (H/F)<\/b> <br/> Mydral","<b>Ingénieur(e) Data Science, Machine Learning , Deep Learning<\/b> <br/> Data2innov","<b>Responsable Data Science H/F<\/b> <br/> Crédit Agricole d'Ile-de-France","<b>Consultant Data Analytics H/F<\/b> <br/> Group onePoint","<b>Analyste DATA H/F<\/b> <br/> Leasecom","<b>Data Scientist H/F<\/b> <br/> LESAFFRE GROUP","<b>JUNIOR DATA SCIENTIST FINANCE/ QUANTITATIVE ANALYST (Paris)...<\/b> <br/> Swiss Life Asset managers","<b>Data Analyst (H/F)<\/b> <br/> Legrand Support","<b>Data Scientist Senior (H/F)<\/b> <br/> Equancy","<b>Head of Data science<\/b> <br/> Data Recrutement","<b>Marketing Performance Data Analyst H/F<\/b> <br/> Amplifon","<b>Consultant(e) Data Analyst<\/b> <br/> SOCIO DATA MANAGEMENT","<b>Data Analyst Risk F/H<\/b> <br/> Groupe BPCE","<b>P&S EAME Data Scientist – Modelling and Analytics (M/W)<\/b> <br/> Syngenta","<b>Data Analyste (F/H) - CDD Angers<\/b> <br/> AXA","<b>DATA ANALYST H/F<\/b> <br/> Segula Technologies","<b>Chargé d'études statistiques / Data analyst / Data scientist...<\/b> <br/> Unédic","<b>Senior Data Scientist NLP<\/b> <br/> Data Recrutement","<b>Responsable Data Analytics F/H<\/b> <br/> La Banque Postale","<b>Responsable Data & Analytics<\/b> <br/> Harnham","<b>Data Analyst (H/F)<\/b> <br/> NJ PARTNERS","<b>Traffic Data Analyst (H/F)<\/b> <br/> Groupe ATOLL","<b>Consultant(e)s Débutant(e)s en Data & Analytics et Innovatio...<\/b> <br/> EY","<b>Data Analyst Propulsion System<\/b> <br/> Airbus","<b>Consultant Data & Digital – Analyste<\/b> <br/> Eight Advisory","<b>Data Scientist/Data Engineer<\/b> <br/> Capital Management Fund","<b>Data Analyst CA en contrat d'apprentissage<\/b> <br/> Orange France","<b>Data Analyst – H/F<\/b> <br/> MALHERBE Paris","<b>Data Analyst H/F<\/b> <br/> Imprimerie Nationale","<b>Data Analyst (H/F)<\/b> <br/> alteca","<b>CDI - Data Analyst Outremer (F/H)<\/b> <br/> Canal Plus","<b>Data Scientist Sénior h-f<\/b> <br/> Danem People France","<b>Data Analyst -FRANFINANCE-(H/F)<\/b> <br/> Franfinance","<b>Performance Data Analyst - H/F<\/b> <br/> BNP Paribas","<b>Data/Business Analyst - Paris (H/F)<\/b> <br/> Scient","<b>Data Business Analyst<\/b> <br/> Oncrawl","<b>Data analyst H/F<\/b> <br/> L'atelier des Chefs","<b>WM - Data Analyste Epargne Financière, F/H<\/b> <br/> BNP Paribas","<b>Data Analyst H/F<\/b> <br/> Acii","<b>Data Engineer/ Data Scientist H/F<\/b> <br/> PSAPeugeotCitroen","<b>Data Scientist F/H<\/b> <br/> 1G LINK","<b>Data & Analytics – Consultant Confirmé<\/b> <br/> Adone Conseil","<b>CDI - Data Analyst Afrique (F/H)<\/b> <br/> Canal Plus","<b>Junior marketing data analyst<\/b> <br/> Richemont","<b>Chef de Projets Data & Analytics (F/H)<\/b> <br/> Micropole","<b>Head of Data Scientist H/F<\/b> <br/> Volta Medical","<b>Data Scientist F/H<\/b> <br/> Web Transition","<b>DATA DIGITAL ANALYST (H/F)<\/b> <br/> OUI.sncf","<b>Data Analyst - CDI F/H<\/b> <br/> FAB GROUP","<b>Data Analyst - Reply France (h/f)<\/b> <br/> Reply","<b>Senior Data Scientist H/F<\/b> <br/> Capgemini Invent","<b>Data/Business Analyst - Paris (H/F)<\/b> <br/> Scient","<b>DATA ANALYST H/F<\/b> <br/> Klanik","<b>Traffic Data Analyst (H/F)<\/b> <br/> Groupe ATOLL","<b>Data Analyst / Marketing<\/b> <br/> Ets Chambon et Fils","<b>Data Analyst F/H<\/b> <br/> NHOOD","<b>Data Analyst H/F<\/b> <br/> Acii","<b>Data Analyst<\/b> <br/> Club Med","<b>Data Analyst PowerBI ( H/F )<\/b> <br/> Insitoo","<b>Data analyst SQL datastudio (H/F)<\/b> <br/> Insitoo","<b>Data Analyst (H/F) - CDI<\/b> <br/> MSD","<b>DATA ANALYST FORCE DE VENTE (H/F)<\/b> <br/> Atmosphères","<b>Data Scientist ML/DL & DataViz H/F<\/b> <br/> Smily RH","<b>Data Analyst -FRANFINANCE-(H/F)<\/b> <br/> Franfinance","<b>Data Analyst (H/F)<\/b> <br/> Vicat","<b>Data Analyst - Power BI/Tableau F/H<\/b> <br/> MINSART-KREMER","<b>WM - Data Analyste Epargne Financière, F/H<\/b> <br/> BNP Paribas","<b>CDI - Data Analyst Afrique (F/H)<\/b> <br/> Canal Plus","<b>Data Scientist Senior F/H<\/b> <br/> NICKEL","<b>Ingénieur(e) Data Science, Machine Learning , Deep Learning<\/b> <br/> Data2innov","<b>Data Analyst – F/H<\/b> <br/> Atecna","<b>Data & Analytics – Consultant Confirmé<\/b> <br/> Adone Conseil","<b>Analyste Développeur orienté DATA-(H/F)<\/b> <br/> Société Générale Securities Services","<b>Data Scientist Engineering Manager<\/b> <br/> Kpler","<b>Data Analyst H/F<\/b> <br/> Crédit Agricole Assurances","<b>Data Scientist (F/H)<\/b> <br/> Ekkiden","<b>JUNIOR DATA SCIENTIST FINANCE/ QUANTITATIVE ANALYST (Paris)...<\/b> <br/> Swiss Life Asset managers","<b>Data Analyst Senior<\/b> <br/> Adevinta Group","<b>Data analyst Talend H/F<\/b> <br/> YA HUNTING","<b>Data Analyst<\/b> <br/> Inetum Capital Market","<b>Data Analyst H/F<\/b> <br/> POTAIN Manitowoc","<b>Performance Data Analyst - H/F<\/b> <br/> BNP Paribas","<b>Data Scientist (F/H)<\/b> <br/> alteca","<b>Data Analyst (H/F)<\/b> <br/> LES MOUSQUETAIRES","<b>Data Engineer/ Data Scientist H/F<\/b> <br/> PSAPeugeotCitroen","<b>Data Analyst (H/F)<\/b> <br/> NJ PARTNERS","<b>DATAMINER SENIOR (H/F)<\/b> <br/> OUI.sncf","<b>Data Analyst<\/b> <br/> Quick","<b>Data analyste<\/b> <br/> KANTAR","<b>Senior data scientist AIX EN PROVENCE H/F<\/b> <br/> Capgemini","<b>Data Scientist // Full remote // Fluent English // Ecologie<\/b> <br/> Sept Lieues","<b>Data Analyst / Chargé d'études H/F - Siège<\/b> <br/> TINGARI","<b>Data Analyst H/F<\/b> <br/> Betclic Group","<b>BI/DATA ANALYST (H/F)<\/b> <br/> Groupe Beaumanoir","<b>Data Analyst H/F<\/b> <br/> NEO2","<b>Data Analyst F/H<\/b> <br/> HN SERVICES - HN FORMATION - HN RECRUTEMENT -...","<b>Business Analyst Data H/F<\/b> <br/> Group onePoint","<b>Data Scientist F/M<\/b> <br/> Schneider Electric","<b>Game Data Analyst (F/H/NB)<\/b> <br/> Focus Entertainment","<b>Consultant.e Data Analyst (H/F)<\/b> <br/> June Partners","<b>Data Analyst H/F - CDI<\/b> <br/> Viatris","<b>Web et Data Analyst<\/b> <br/> Groupe Atlantic","<b>Data analyst<\/b> <br/> PIERRE FABRE S.A.","<b>Consultant Data Analytics| CDI| H/F<\/b> <br/> PwC","<b>Data Scientist_PhD Level (M/F)<\/b> <br/> Evotec","<b>Consultant Data expérimenté : Data Scientist / Data Engineer...<\/b> <br/> IBM interactive","<b>Data Analyst (H/F)<\/b> <br/> Insitoo","<b>Data Analyst Senior (H/F)<\/b> <br/> RSM France","<b>Data Scientist - PhD Graduates<\/b> <br/> SmartAdServer","<b>Data scientist H/F<\/b> <br/> HAYS","<b>Data Analyst (H/F)<\/b> <br/> Opéra Conseil","<b>Consultant Business Intelligence (BI) / Data Analytics - Neu...<\/b> <br/> Grant Thornton France","<b>Lead Data Scientist / Freelance<\/b> <br/> CELAD","<b>Analyste DATA H/F<\/b> <br/> CGI Inc","<b>Docteur/PhD spécialisé en Data Science F/H<\/b> <br/> Scalian","<b>Data Analyst H/F<\/b> <br/> NOVELIS","<b>Product Data Analyst<\/b> <br/> Pictarine","<b>DATA ANALYST POWER BI ASAP<\/b> <br/> Groupe Trèfle","<b>Data Analyst - Niort H(/F)<\/b> <br/> Scient","<b>Data Scientist/Chatbot-Niort F/H<\/b> <br/> SIDERLOG CONSEIL","<b>Analyste Data - Référent H/F<\/b> <br/> Saur","<b>Data Analyst - CLIENT FINAL F/H<\/b> <br/> My Talent Expert","<b>Data Scientist F/H/X<\/b> <br/> EXTERNATIC","<b>Data Analyst Senior H/F<\/b> <br/> DataKhi","<b>Margo Analytics - Data Engineer – H/F<\/b> <br/> Margo Conseil","<b>Data Scientist<\/b> <br/> Content Square","<b>Manager Data Analytics F/M<\/b> <br/> Betclic Group","<b>Data Scientist - Logiciels B-to-B / B-to-C en temps réel - 9...<\/b> <br/> Sept Lieues","<b>Actuaire IARD DATA ANALYTICS (F/H)<\/b> <br/> AXA","<b>Data Analyst (H/F)<\/b> <br/> FAB Group","<b>Data Analyst & Steward (f/m/d)<\/b> <br/> Allianz Global Investors","<b>Consultant / Analyste Business Data (H/F)<\/b> <br/> CGI Inc","<b>Consultant(e) Data Analyst – Confirmé(e)<\/b> <br/> SOCIO DATA MANAGEMENT","<b>Data Analyst H/F<\/b> <br/> HOREA CONSEIL","<b>Data Analyst H/F<\/b> <br/> HOREA CONSEIL","<b>Data Scientist<\/b> <br/> Presans","<b>Data Analyst F/H<\/b> <br/> AVISIA","<b>Data Analyst Consultant (H/F)<\/b> <br/> ENDRIX","<b>Business Data Analyst CDI / Permanent Job Paris / France<\/b> <br/> Teemo","<b>Data Analyst - Industry Team<\/b> <br/> Deezer","<b>Data Science Manager - Instagram Creator Relevance<\/b> <br/> Instagram","<b>ANALYTICS DATA ARCHITECT<\/b> <br/> EasyNeo","<b>Data Scientist expert en IA Conversationnelle F/H<\/b> <br/> Orange Business Services","<b>Data Scientist – Machine Deep learning (H/F)<\/b> <br/> DAVIDSON","<b>CDI - Product Owner Data Analytics (F/H)<\/b> <br/> Sephora","<b>Data Science & Artificial Intelligence Research Scientist M/...<\/b> <br/> TotalEnergies","<b>Consultant Data Scientist confirmé - (H/F)<\/b> <br/> Groupe HLI","<b>Ingénieur Data Scientist Expérimenté (H/F)<\/b> <br/> Thales","<b>Data Scientist Expérimenté H/F<\/b> <br/> EY","<b>Actuaire/Data Scientist - H/F<\/b> <br/> AXA","<b>Data Scientist (Python and SQL) - Freelance<\/b> <br/> Veepee","<b>Data Analyst Industrie 4.0 H/F<\/b> <br/> Inetum","<b>Web Data Scientist Confirmé H/F<\/b> <br/> Raja France","<b>Analyste Data et Business H/F<\/b> <br/> TotalEnergies","<b>Analyste métier confirmé - Data Steward H/F<\/b> <br/> Enedis","<b>Contrôleur de gestion / Data analyst H/F - Villepinte<\/b> <br/> Petit Forestier","<b>Analyste Data BCBS 239 F/H<\/b> <br/> NATIXIS","<b>Test & Data Analytics Engineer - Silicon Photonics (ID 2207)<\/b> <br/> Ligentec SA","<b>Data Scientist Sénior H/F<\/b> <br/> Insitoo","<b>DATA ANALYST<\/b> <br/> Groupe Europa","<b>ANALYSTE DATA BI (H/F)<\/b> <br/> MISTER AUTO","<b>Consultant data analytics H/F<\/b> <br/> Leihia","<b>DATA ANALYST Domaine Assurances, Mutuelles H/F<\/b> <br/> MGEN","<b>Data Scientist confirmé(e) H/F<\/b> <br/> TotalEnergies","<b>Ingénieur Data Scientist Expérimenté (H/F)<\/b> <br/> Thales","<b>Analyste métier confirmé - Data Steward H/F<\/b> <br/> Enedis","<b>Lead - Data Analytics<\/b> <br/> Everise","<b>Data Scientist<\/b> <br/> Data Recrutement","<b>Data Analyst H/F<\/b> <br/> NOVELIS","<b>Data Analyst / Quality Manager (H/F)<\/b> <br/> Insitoo","<b>Data Analyst F/H<\/b> <br/> AVISIA","<b>Data Miner<\/b> <br/> Data Recrutement","<b>CDI - Product Owner Data Analytics (F/H)<\/b> <br/> Sephora","<b>Senior Data Scientist<\/b> <br/> Attraqt","<b>Ingénieur Recherche Opérationnelle - Data Scientist H/F<\/b> <br/> Air France-KLM","<b>Business Analyst Data H/F<\/b> <br/> Insitoo","<b>DATA ANALYST - H/F<\/b> <br/> Dalkia","<b>Actuaire/Data Scientist - H/F<\/b> <br/> AXA","<b>Data Analyst (H/F)<\/b> <br/> FAB Group","<b>Consultant data analytics expérimenté(e)<\/b> <br/> The Information Lab","<b>DATA ANALYST POWER BI ASAP<\/b> <br/> Groupe Trèfle","<b>Analyste Data et Business H/F<\/b> <br/> TotalEnergies","<b>Process Data Scientist<\/b> <br/> AG SOLUTION","<b>ANALYSTE DATA BI (H/F)<\/b> <br/> MISTER AUTO","<b>DATA ANALYST (H/F/D)<\/b> <br/> Pellenc","<b>CONSULTANT DÉBUTANT DATA ANALYST EN FINANCEMENT F/H<\/b> <br/> KPMG","<b>Data Scientist – Contrôle Statistique des Systèmes de produc...<\/b> <br/> Renault Group","<b>Data Scientist ML/DL & DataViz H/F<\/b> <br/> Smily RH","<b>Data Analyst marketing client - EMEA zone<\/b> <br/> Louis Vuitton","<b>Sourcing Data Analyst H/F<\/b> <br/> Kingfisher","<b>Business Analyst Data H/F<\/b> <br/> Insitoo","<b>Data scientist F/H<\/b> <br/> Synergie","<b>Data Analyst / Quality Manager (H/F)<\/b> <br/> Insitoo","<b>BI/Data Analyst (H/F)<\/b> <br/> PROMINENT FRANCE","<b>Data Analyst (Flex/Remote)<\/b> <br/> Scaleway","<b>Confirmed Consultant & Data Scientist (H/F/N)<\/b> <br/> Ekimetrics","<b>Data Analyst Consultant H/F à Lyon 7 CDI<\/b> <br/> ENDRIX","<b>Data Analyst F/H<\/b> <br/> AVISIA NORD","<b>Data Analyst H/F<\/b> <br/> Expectra","<b>Data Analyst - Industry Team<\/b> <br/> Deezer","<b>Paris Office - Data & Analytics Specialist (m/f/d)<\/b> <br/> L.E.K. Consulting","<b>Data Analyst (H/F)<\/b> <br/> @talentEgal","<b>Data Miner<\/b> <br/> Data Recrutement","<b>Support Engineering: Product Data Analyst (M/F)<\/b> <br/> Airbus","<b>Data analyst merchandising H/F - CDD<\/b> <br/> Brico depôt","<b>Junior Data & Content Analyst<\/b> <br/> Metrixx","<b>DATA ANALYST Domaine Assurances, Mutuelles H/F<\/b> <br/> MGEN","<b>Ingénieur Développement Python & Data Analyst (H/F)<\/b> <br/> Viveris","<b>Data Analyst - Supply Chain H/F<\/b> <br/> Viveris","<b>Customer Success Data Analyst<\/b> <br/> Sociabble","<b>Data Scientist R&D (PhD) | Optimisation stochastique |...<\/b> <br/> Octopus IT","<b>Data Scientist - France/Germany/UK/Spain<\/b> <br/> Shift Technology","<b>Data Transformation & Analytics engineer (F/H)<\/b> <br/> Saint-Gobain","<b>Senior Clinical Data Analyst<\/b> <br/> DentalMonitoring","<b>PhD en Data Science F/H<\/b> <br/> Jean-Yves Arrouet","<b>Data Scientist confirmé(e)<\/b> <br/> Data Recrutement","<b>Lead Data Scientist Senior F/H<\/b> <br/> GroupAgora","<b>Data Analyst Exploitation Eolien (H/F)<\/b> <br/> Boralex","<b>Product Data Analyst<\/b> <br/> Ledger","<b>Data Scientist Confirmé F/H<\/b> <br/> LINCOLN","<b>Data Scientist (F/H)<\/b> <br/> Descartes Underwriting","<b>Data Science Experts for Finance Transformation (m/f)<\/b> <br/> Airbus","<b>Data Analyst, Retail Media<\/b> <br/> Criteo","<b>Senior Data Analyst<\/b> <br/> Harnham"],null,{"showCoverageOnHover":true,"zoomToBoundsOnClick":true,"spiderfyOnMaxZoom":true,"removeOutsideVisibleBounds":true,"spiderLegPolylineOptions":{"weight":1.5,"color":"#222","opacity":0.5},"freezeAtZoom":false},null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]}],"limits":{"lat":[41.3877400000001,50.7228769167483],"lng":[-4.48657999999995,9.160870000000051]}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
</section>
</section>
<section id="analyzing-job-descriptions" class="level2">
<h2 class="anchored" data-anchor-id="analyzing-job-descriptions">Analyzing job descriptions</h2>
<p>Nowadays most of the resumes are scanned and interpreted by an applicant tracking system (ATS). To make things simple, this system looks for key words in your resume and assess the match with the job you are applying for. It is therefore important to describe your experiences with specific key words to improve the chances of getting to the next step of the hiring process.</p>
<p>But what key words should I include in my resume ? Let’s answer this question by analyzing the job descriptions of data scientist jobs.</p>
<section id="downloading-and-cleaning-each-job-description" class="level3">
<h3 class="anchored" data-anchor-id="downloading-and-cleaning-each-job-description">Downloading and cleaning each job description</h3>
<p>First we download the full description of each job by navigating through all the URL listed in our table. We then clean and homogenize the description with a custom function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Loop through all the URLs</span></span>
<span id="cb11-2">job_descriptions <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>()</span>
<span id="cb11-3">pb <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">txtProgressBar</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">min =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(final_df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>url), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">style =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span>
<span id="cb11-4"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span>(i <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(final_df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>url)){</span>
<span id="cb11-5">  remDr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">navigate</span>(final_df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>url[i])</span>
<span id="cb11-6">  web_page <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> remDr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">getPageSource</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">header =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)[[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_html</span>()</span>
<span id="cb11-7">  job_descriptions[[i]] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> web_page <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb11-8">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">html_elements</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">css =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".jobsearch-JobComponent-description"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb11-9">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">html_text2</span>()</span>
<span id="cb11-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Sys.sleep</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb11-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">setTxtProgressBar</span>(pb, i)</span>
<span id="cb11-12">}</span>
<span id="cb11-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Gathering in dataframe</span></span>
<span id="cb11-14">job_descriptions <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.data.frame</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">do.call</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"rbind"</span>, job_descriptions))</span>
<span id="cb11-15"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(job_descriptions) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Description"</span>)</span>
<span id="cb11-16"></span>
<span id="cb11-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Binding to same table:</span></span>
<span id="cb11-18">final_df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cbind</span>(final_df, job_descriptions)</span>
<span id="cb11-19"></span>
<span id="cb11-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Homogenize with custom function</span></span>
<span id="cb11-21">final_df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Description_c <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lapply</span>(final_df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Description, <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(x){<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">clean_job_desc</span>(x)[[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]]})</span>
<span id="cb11-22">final_df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Language <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> textcat<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">textcat</span>(final_df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Description)</span></code></pre></div>
</div>
</section>
<section id="annotation-procedure-with-udpipe-package" class="level3">
<h3 class="anchored" data-anchor-id="annotation-procedure-with-udpipe-package">Annotation procedure with udpipe Package</h3>
<p>This part is inspired from this <a href="https://www.r-bloggers.com/2018/04/an-overview-of-keyword-extraction-techniques/">post</a>.</p>
<p>Now that the descriptions of all the listed jobs are imported and pre-cleaned, we can annotate the textual data with <strong>udpipe</strong> package. This package contains functions and models which can perform tokenisation, lemmatisation and key word extraction.</p>
<p>We first restrict this analysis to data scientist job post written in french, then we annotate all the descriptions:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Restricting the analysis to Data scientist post written in french</span></span>
<span id="cb12-2">desc_data_scientist <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> final_df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb12-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>((Job_title_c <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data scientist"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> (Language <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"french"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb12-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(Description_c)</span>
<span id="cb12-5"></span>
<span id="cb12-6">ud_model <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">udpipe_download_model</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">language =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"french"</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Download the model if necessary</span></span>
<span id="cb12-7">ud_model <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">udpipe_load_model</span>(ud_model<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>file_model) </span>
<span id="cb12-8"></span>
<span id="cb12-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Annotate the descriptions </span></span>
<span id="cb12-10">x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">udpipe_annotate</span>(ud_model, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(desc_data_scientist, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">collapse =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" "</span>))</span>
<span id="cb12-11">x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.data.frame</span>(x)</span></code></pre></div>
</div>
</section>
<section id="most-common-nouns" class="level3">
<h3 class="anchored" data-anchor-id="most-common-nouns">Most common nouns</h3>
<p>We can visualize the most employed word throughout the data scientist job posts written in french:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1">stats <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">subset</span>(x, upos <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"NOUN"</span>)</span>
<span id="cb13-2">stats <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">txt_freq</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> stats<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>lemma)</span>
<span id="cb13-3"></span>
<span id="cb13-4">stats <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb13-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">top_n</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>, freq) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb13-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">key =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.factor</span>(key),</span>
<span id="cb13-7">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">key =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fct_reorder</span>(key, freq)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb13-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> key, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> freq)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb13-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_bar</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stat =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'identity'</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb13-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_flip</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb13-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ylab</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Most common nouns"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb13-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_bw</span>()</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://aureliencallens.github.io/posts/2022-09-21-webscraping-indeed-data-scientist-jobs/index_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Even though, it gives us an idea of words to include it is not very informative as key words are often composed by two or more words.</p>
</section>
<section id="extracting-key-words-for-resume-writing" class="level3">
<h3 class="anchored" data-anchor-id="extracting-key-words-for-resume-writing">Extracting key words for resume writing</h3>
<p>There are several methods implemented in <strong>udpipe</strong> to extract key words from a text. After testing several methods, I selected the Rapid Automatic Keyword Extraction (RAKE) which gives me the best results:</p>
<div class="cell" data-hash="index_cache/html/unnamed-chunk-15_49233ab1545e73ffecff70330a0e2c1a">
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1">stats <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">keywords_rake</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x,</span>
<span id="cb14-2">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">term =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"token"</span>,<span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Search on token</span></span>
<span id="cb14-3">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"doc_id"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sentence_id"</span>), <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># On every post </span></span>
<span id="cb14-4">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">relevant =</span> x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>upos <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"NOUN"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ADJ"</span>),  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Only among noun and adj.</span></span>
<span id="cb14-5">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ngram_max =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n_min =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sep =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" "</span>)</span>
<span id="cb14-6"></span>
<span id="cb14-7">stats <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">subset</span>(stats, stats<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>freq <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> stats<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>rake <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span>
<span id="cb14-8"></span>
<span id="cb14-9">stats <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb14-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">desc</span>(rake)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb14-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                    keyword ngram freq     rake
1 intelligence artificielle     2    9 9.368889
2             tableaux bord     2    5 8.504274
3      formation supérieure     2    5 8.374725
4        modèles prédictifs     2   15 7.581294
5         force proposition     2    6 7.190238
6        production échelle     2    5 7.034038</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wordcloud</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">words =</span> stats<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>keyword, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">freq =</span> stats<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>freq, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">min.freq =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,</span>
<span id="cb16-2">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max.words=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">random.order=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rot.per=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.35</span>,</span>
<span id="cb16-3">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colors=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">brewer.pal</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Dark2"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scale =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>))</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://aureliencallens.github.io/posts/2022-09-21-webscraping-indeed-data-scientist-jobs/index_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We can see that this method has selected important french key words related to the data scientist job ! In the first positions, we find the key words: “artificial intelligence”, “dashboards”, “higher education”, “predictive model”. I’d better check if these words appear on my resume !</p>
</section>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p>I hope I convinced you that it is possible to optimize your job search with Data Science!</p>
<p>If this post has caught your interest and you are looking for a new Data Scientist, do not hesitate to contact me on my <a href="mailto:aurelien.callens@gmail.com">mail</a> as I am currently looking for a job in France (Hybrid, Remote) or in Europe (Remote).</p>
</section>
<section id="custom-functions-to-clean-data-extracted-from-the-webpage" class="level2">
<h2 class="anchored" data-anchor-id="custom-functions-to-clean-data-extracted-from-the-webpage">Custom functions to clean data extracted from the webpage</h2>
<p>These functions use several methods such as regular expressions, stop words and conditional statements to clean the textual data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(rvest)</span>
<span id="cb17-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(stringr)</span>
<span id="cb17-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(httr)</span>
<span id="cb17-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidystopwords)</span>
<span id="cb17-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(textcat)</span>
<span id="cb17-6"></span>
<span id="cb17-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Function to tidy the data related to the company</span></span>
<span id="cb17-8">tidy_comploc <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(text){</span>
<span id="cb17-9">  lst <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_split</span>(text, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pattern =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">simplify =</span>T)</span>
<span id="cb17-10">  ext_str <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">substr</span>(lst[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nchar</span>(lst[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nchar</span>(lst[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]))</span>
<span id="cb17-11">  res <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">suppressWarnings</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gsub</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">','</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'.'</span>, ext_str)))</span>
<span id="cb17-12">  lst[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(res), lst[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">substr</span>(lst[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nchar</span>(lst[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>))</span>
<span id="cb17-13">  lst[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> res</span>
<span id="cb17-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">t</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.matrix</span>(lst))</span>
<span id="cb17-15">}</span>
<span id="cb17-16"></span>
<span id="cb17-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Function to tidy the short job description provided with the job post</span></span>
<span id="cb17-18">tidy_job_desc <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(text){</span>
<span id="cb17-19">  stopwords <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Candidature facile"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Employeur réactif"</span>)</span>
<span id="cb17-20">  text <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_remove_all</span>(text, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(stopwords, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">collapse =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"|"</span>))</span>
<span id="cb17-21">  stopwords_2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"(Posted|Employer).*"</span></span>
<span id="cb17-22">  text <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_remove_all</span>(text, stopwords_2)</span>
<span id="cb17-23">  text</span>
<span id="cb17-24">}</span>
<span id="cb17-25"></span>
<span id="cb17-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Function to tidy the salary data if provided</span></span>
<span id="cb17-27">tidy_salary <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(text){</span>
<span id="cb17-28">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(text)){</span>
<span id="cb17-29">    others <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span></span>
<span id="cb17-30">    sal_low <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span></span>
<span id="cb17-31">    sal_high <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span></span>
<span id="cb17-32">  }<span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span>{</span>
<span id="cb17-33">    text <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_split</span>(text, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">simplify =</span> T)</span>
<span id="cb17-34">    others <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(text[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_detect</span>(text, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"€"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">negate =</span> T)], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">collapse =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" | "</span>)</span>
<span id="cb17-35">    sal <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> text[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_detect</span>(text, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"€"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">negate =</span> F)]</span>
<span id="cb17-36">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span>(rlang<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is_empty</span>(sal)){</span>
<span id="cb17-37">      sal_low <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span></span>
<span id="cb17-38">      sal_high <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span></span>
<span id="cb17-39">    }<span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span>{</span>
<span id="cb17-40">      range_sal <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_split</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_remove_all</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_replace</span>(sal, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"à"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-"</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"[^0-9.-]"</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">simplify =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>))</span>
<span id="cb17-41">      sal_low <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sort</span>(range_sal)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb17-42">      sal_high <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sort</span>(range_sal)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]</span>
<span id="cb17-43"></span>
<span id="cb17-44">      <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_detect</span>(sal, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"an"</span>)){</span>
<span id="cb17-45">        sal_low <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">floor</span>(sal_low<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>)</span>
<span id="cb17-46">        sal_high <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">floor</span>(sal_high<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>)</span>
<span id="cb17-47">      }</span>
<span id="cb17-48">    }</span>
<span id="cb17-49">  }</span>
<span id="cb17-50">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(sal_low), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(sal_high), others))</span>
<span id="cb17-51">}</span>
<span id="cb17-52"></span>
<span id="cb17-53"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Function to tidy the location of the job (Remote/Hybrid/Onsite) + homogenize </span></span>
<span id="cb17-54"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># location and zip code</span></span>
<span id="cb17-55">tidy_location <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(final_df){</span>
<span id="cb17-56">  final_df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Job_type <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(final_df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Location <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Télétravail"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Full Remote"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_detect</span>(final_df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Location, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Télétravail"</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Hybrid"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"On site"</span>))</span>
<span id="cb17-57">  final_df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Loc_possibility <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_detect</span>(final_df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Location, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lieu"</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Plusieurs lieux"</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>)</span>
<span id="cb17-58">  stopwords <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Télétravail à"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Télétravail"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"à"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"hybride"</span>)</span>
<span id="cb17-59">  final_df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Loc_tidy <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_remove_all</span>(final_df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Location, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(stopwords, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">collapse =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"|"</span>))</span>
<span id="cb17-60">  final_df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Loc_tidy <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_remove_all</span>(final_df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Loc_tidy, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"[+].*"</span>)</span>
<span id="cb17-61">  final_df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Loc_tidy <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_trim</span>(final_df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Loc_tidy)</span>
<span id="cb17-62">  final_df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Loc_tidy <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sapply</span>(final_df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Loc_tidy,</span>
<span id="cb17-63">                               <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(x){</span>
<span id="cb17-64">                                 <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">suppressWarnings</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">substr</span>(x, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>))))){</span>
<span id="cb17-65">                                   <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">substr</span>(x, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'('</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">substr</span>(final_df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Loc_tidy[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>], <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">')'</span>)))</span>
<span id="cb17-66">                                 }<span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span>{</span>
<span id="cb17-67">                                   <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(x)</span>
<span id="cb17-68">                                 }})</span>
<span id="cb17-69">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(final_df)</span>
<span id="cb17-70">}</span>
<span id="cb17-71"></span>
<span id="cb17-72"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Function to keep only certain words in text</span></span>
<span id="cb17-73">keep_words <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(text, keep) {</span>
<span id="cb17-74">  words <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">strsplit</span>(text, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" "</span>)[[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]]</span>
<span id="cb17-75">  txt <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(words[words <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> keep], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">collapse =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" "</span>)</span>
<span id="cb17-76">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(txt)</span>
<span id="cb17-77">}</span>
<span id="cb17-78"></span>
<span id="cb17-79"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Homogenize the job title and class them in a few categories</span></span>
<span id="cb17-80">clean_job_title <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(job_titles){</span>
<span id="cb17-81">  job_titles <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tolower</span>(job_titles)</span>
<span id="cb17-82">  job_titles <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gsub</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"[[:punct:]]"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" "</span>, job_titles, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">perl=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb17-83"></span>
<span id="cb17-84">  words_to_keep <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"scientist"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"junior"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"senior"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"engineer"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nlp"</span>,</span>
<span id="cb17-85">                     <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"analyst"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"analytics"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"analytic"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"science"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sciences"</span>,</span>
<span id="cb17-86">                     <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"computer"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"vision"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ingenieur"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"données"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"analyste"</span>,</span>
<span id="cb17-87">                     <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"analyses"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lead"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"leader"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dataminer"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mining"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"chief"</span>,</span>
<span id="cb17-88">                     <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"miner"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"analyse"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'head'</span>)</span>
<span id="cb17-89">  job_titles_c <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unlist</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sapply</span>(job_titles, <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(x){<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">keep_words</span>(x, words_to_keep)}, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">USE.NAMES =</span> F))</span>
<span id="cb17-90">  job_titles_c <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unlist</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sapply</span>(job_titles_c, <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(x){<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unique</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unlist</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_split</span>(x, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" "</span>))), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">collapse =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" "</span>)}, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">USE.NAMES =</span> F))</span>
<span id="cb17-91">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">table</span>(job_titles_c)</span>
<span id="cb17-92"></span>
<span id="cb17-93">  data_analytics_ind <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span>  job_titles_c <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"analyses data"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"analyst data"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"analyste data"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"analyste data scientist"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data analyse"</span>,</span>
<span id="cb17-94">                                             <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"analyste données"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"analytic data scientist"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"analytics data"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"analytics data engineer"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data analyst engineer"</span>,</span>
<span id="cb17-95">                                             <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data analyst données"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data analyst scientist"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data analyst scientist données"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data analyste"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data analyst analytics"</span>,</span>
<span id="cb17-96">                                             <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data analytics"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data analytics engineer"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data engineer analyst"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data scientist analyst"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data scientist analytics"</span>)</span>
<span id="cb17-97">  job_titles_c[data_analytics_ind] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data analyst"</span></span>
<span id="cb17-98"></span>
<span id="cb17-99">  data_analytics_j_ind <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span>  job_titles_c <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"junior data analyst"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"junior data analytics"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"junior data scientist analyst"</span>)</span>
<span id="cb17-100">  job_titles_c[data_analytics_j_ind] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data analyst junior"</span></span>
<span id="cb17-101"></span>
<span id="cb17-102">  data_scientist_ind <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> job_titles_c <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data computer science"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data science"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data science scientist"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data sciences"</span>,</span>
<span id="cb17-103">                                            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data sciences scientist"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data scientist données"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data scientist sciences"</span>,</span>
<span id="cb17-104">                                            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"données data scientist"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"scientist data"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"science données"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"scientist data"</span>,</span>
<span id="cb17-105">                                            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"scientist data science"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"computer data science"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data science données"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data scientist science"</span>)</span>
<span id="cb17-106">  job_titles_c[data_scientist_ind] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data scientist"</span></span>
<span id="cb17-107"></span>
<span id="cb17-108">  data_scientist_j_ind <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> job_titles_c <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"junior data scientist"</span>)</span>
<span id="cb17-109">  job_titles_c[data_scientist_j_ind] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data scientist junior"</span></span>
<span id="cb17-110"></span>
<span id="cb17-111">  data_engineer_ind <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> job_titles_c <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data engineer scientist"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data science engineer"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data miner"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data scientist engineer"</span>,</span>
<span id="cb17-112">                                           <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dataminer"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"engineer data scientist"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"senior data scientist engineer"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ingenieur data scientist"</span>)</span>
<span id="cb17-113">  job_titles_c[data_engineer_ind] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data engineer"</span></span>
<span id="cb17-114"></span>
<span id="cb17-115">  nlp_data_scientist_ind <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> job_titles_c <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data scientist nlp"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nlp data science"</span>,</span>
<span id="cb17-116">                                                <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nlp data scientist"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"senior data scientist nlp"</span>)</span>
<span id="cb17-117">  job_titles_c[nlp_data_scientist_ind] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data scientist NLP"</span></span>
<span id="cb17-118"></span>
<span id="cb17-119">  cv_data_scientist_ind <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> job_titles_c <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"computer vision data scientist"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data science computer vision"</span>,</span>
<span id="cb17-120">                                               <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data scientist computer vision"</span>)</span>
<span id="cb17-121">  job_titles_c[cv_data_scientist_ind] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data scientist CV"</span></span>
<span id="cb17-122"></span>
<span id="cb17-123">  lead_data_scientist_ind <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> job_titles_c <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"chief data"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"chief data scientist"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data scientist leader"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lead data scientist"</span>,</span>
<span id="cb17-124">                                                 <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data chief scientist"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lead data scientist senior"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"head data science"</span>)</span>
<span id="cb17-125">  job_titles_c[lead_data_scientist_ind] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data scientist lead or higher"</span></span>
<span id="cb17-126">  senior_data_scientist_ind <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> job_titles_c <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"senior data scientist"</span>)</span>
<span id="cb17-127">  job_titles_c[senior_data_scientist_ind] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data scientist senior"</span></span>
<span id="cb17-128"></span>
<span id="cb17-129">  senior_data_analytics_ind <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> job_titles_c <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"senior analytics data scientist"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"senior data analyst"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"senior data scientist analytics"</span>)</span>
<span id="cb17-130">  job_titles_c[senior_data_analytics_ind] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data analyst senior"</span></span>
<span id="cb17-131"></span>
<span id="cb17-132"></span>
<span id="cb17-133">  lead_data_analyst_ind <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> job_titles_c <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lead data analyst senior"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lead data analyst"</span>)</span>
<span id="cb17-134">  job_titles_c[lead_data_analyst_ind] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data analyst lead"</span></span>
<span id="cb17-135">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(job_titles_c)</span>
<span id="cb17-136">}</span>
<span id="cb17-137"></span>
<span id="cb17-138"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Function to clean the full job description before word annotation</span></span>
<span id="cb17-139">clean_job_desc <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(text){</span>
<span id="cb17-140">  text <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tolower</span>(text)</span>
<span id="cb17-141">  text <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_replace_all</span>(text, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" "</span>)</span>
<span id="cb17-142">  text <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_remove</span>(text, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pattern =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dé.*du poste "</span>)</span>
<span id="cb17-143">  text <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_remove</span>(text, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pattern =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"analyse de recr.*"</span>)</span>
<span id="cb17-144">  text <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gsub</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"(?!&amp;)[[:punct:]+’+…+»+«]"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" "</span>, text, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">perl=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb17-145"></span>
<span id="cb17-146">  language <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">textcat</span>(text)</span>
<span id="cb17-147"></span>
<span id="cb17-148">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span>(language <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"french"</span>){</span>
<span id="cb17-149">    text <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_replace_all</span>(text, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"œ"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"oe"</span>)</span>
<span id="cb17-150">    stopwords <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"détails"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"poste"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"description"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"informations"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"complémentaires"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"c"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">generate_stoplist</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">language =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"French"</span>))</span>
<span id="cb17-151">  }<span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span>{</span>
<span id="cb17-152">    stopwords <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"description"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">generate_stoplist</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">language =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"English"</span>))</span>
<span id="cb17-153">  }</span>
<span id="cb17-154"></span>
<span id="cb17-155">  text <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_replace_all</span>(text, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(stopwords, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">collapse =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" | "</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" "</span>)</span>
<span id="cb17-156">  text <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_replace_all</span>(text, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(stopwords, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">collapse =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" | "</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" "</span>)</span>
<span id="cb17-157">  text <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_replace_all</span>(text, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(stopwords, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">collapse =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" | "</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" "</span>)</span>
<span id="cb17-158"></span>
<span id="cb17-159">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(language, text))</span>
<span id="cb17-160">}</span></code></pre></div>
</div>


<!-- -->

</section>

<a onclick="window.scrollTo(0, 0); return false;" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a> ]]></description>
  <category>R</category>
  <category>Web scraping</category>
  <category>EDA</category>
  <category>NLP</category>
  <guid>https://aureliencallens.github.io/posts/2022-09-21-webscraping-indeed-data-scientist-jobs/index.html</guid>
  <pubDate>Tue, 20 Sep 2022 22:00:00 GMT</pubDate>
</item>
<item>
  <title>Analysis of the top R packages</title>
  <dc:creator>Aurelien Callens</dc:creator>
  <link>https://aureliencallens.github.io/posts/2022-07-19-top-r-packages/index.html</link>
  <description><![CDATA[ 




<p>After a little while coding in Python every day for my work, I needed to make a break and perform some R analysis! Since the beginning of my postdoc, I haven’t followed the last trends concerning R packages. In this post, I am going to analyze some data about R packages to see what are the most downloaded packages during the past weeks. I will also visualize all the relationships between the R packages by looking at their required dependencies.</p>
<p>Let’s import the packages required for this analysis:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(magrittr)</span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(cranlogs)</span>
<span id="cb1-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(igraph)</span>
<span id="cb1-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(visNetwork)</span></code></pre></div>
</div>
<section id="how-to-find-the-most-popular-r-packages" class="level1">
<h1>How to find the most popular R packages ?</h1>
<p>The first thing is to gather the data about the number of downloads for each package. Luckily for us, there is a package called <em>cranlogs</em> that does just what we need ! With a simple line of command we can collect data about the 50 packages with the most downloads in the last month, we can then plot the result:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1">popular_pckg <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cran_top_downloads</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"last-month"</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>)</span>
<span id="cb2-2"></span>
<span id="cb2-3">popular_pckg <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">package =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fct_reorder</span>(package, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">desc</span>(count))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb2-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> package, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> count)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_bar</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stat=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"identity"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb2-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_discrete</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expansion</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mult =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.02</span>))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_bw</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xlab</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ylab</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Downloads"</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">angle =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb2-12">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>),</span>
<span id="cb2-13">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>),</span>
<span id="cb2-14">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>),</span>
<span id="cb2-15">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>)</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://aureliencallens.github.io/posts/2022-07-19-top-r-packages/index_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>I thought this graph will be harder to make because of the availability of the data but with the right package everything can be done !</p>
</section>
<section id="visualisation-of-the-dependencies-between-packages" class="level1">
<h1>Visualisation of the dependencies between packages</h1>
<p>Once I saw the above graph, I was wondering about all the dependencies between these packages and I wanted to know which one was the most “connected”. To answer this question, I need more data, especially about the required dependencies of each package. After some research, I found out that data about package (including description and dependencies) can be extracted with a function in the <em>tools</em> package:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">df_pkg <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> tools<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">CRAN_package_db</span>()[, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Package'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Imports'</span>)]</span>
<span id="cb3-2">df_pkg <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df_pkg <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">if_any</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Package"</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>.x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> popular_pckg[[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"package"</span>]]))</span></code></pre></div>
</div>
<p>However, this function extract the data for all the packages and I want to perform the analysis only on the top 50 popular packages. So I decided to couple the function of the <em>cranlog</em> package with the database I collected with the <code>CRAN_package_db()</code> function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Can be quite long hence the parallel map</span></span>
<span id="cb4-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#plan(multisession, workers = 12)</span></span>
<span id="cb4-3">monthly_dl <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">map</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(df_pkg<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Package), <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(x){<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cran_downloads</span>(x, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'last-month'</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>count)})</span>
<span id="cb4-4">df_pkg<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>monthly_dl <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unlist</span>(monthly_dl)</span>
<span id="cb4-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># write_csv(df_pkg, 'R_pkg_dl.csv')</span></span></code></pre></div>
</div>
<p>We can then filter by number of downloads:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">df_pkg <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df_pkg <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb5-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">distinct</span>(Package, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.keep_all=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb5-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"monthly_dl"</span>) </span></code></pre></div>
</div>
<p>Now, it is time to prepare the data for a graph visualization. To make a graph, we need two tables. The first one must contain all the relationships between nodes (in our case nodes are packages), it has two columns : ‘from’ and ‘to’. The second table contains only one column with the names of the nodes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1">import_cleaning <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(text){</span>
<span id="cb6-2">  text <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gsub</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">s*</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">([^</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">)]+</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">)'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">''</span>, text)</span>
<span id="cb6-3">  text <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gsub</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">n'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">' '</span>, text)</span>
<span id="cb6-4">  text <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gsub</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">' '</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">''</span>, text, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fixed =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb6-5">  text <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_split</span>(text, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">','</span>)</span>
<span id="cb6-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(text)</span>
<span id="cb6-7">}</span>
<span id="cb6-8"></span>
<span id="cb6-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">import_cleaning</span>(df_pkg<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Imports[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>])</span>
<span id="cb6-10"></span>
<span id="cb6-11">test <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df_pkg <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb6-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cleaned_imports =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">import_cleaning</span>(Imports))</span>
<span id="cb6-13"></span>
<span id="cb6-14">df_target <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(x,y){</span>
<span id="cb6-15">  df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expand.grid</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">from=</span>x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">to=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unlist</span>(y))</span>
<span id="cb6-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(df)}</span>
<span id="cb6-17"></span>
<span id="cb6-18"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span>(i <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(test)){</span>
<span id="cb6-19">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span>(i <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>){</span>
<span id="cb6-20">    df_res <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">df_target</span>(test<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Package[i], test<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>cleaned_imports[i])</span>
<span id="cb6-21">  }<span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span>{</span>
<span id="cb6-22">      df_res <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rbind</span>(df_res, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">df_target</span>(test<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Package[i], test<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>cleaned_imports[i]))</span>
<span id="cb6-23">  }</span>
<span id="cb6-24">}</span>
<span id="cb6-25"></span>
<span id="cb6-26">links <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df_res <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb6-27">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(to) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> (to <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>))</span>
<span id="cb6-28"></span>
<span id="cb6-29">nodes <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.character</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unique</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unlist</span>(df_res))))</span></code></pre></div>
</div>
<p>Once the two matrices are made, we can interactively visualize the graph network with <em>visNetwork</em> package:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">visNetwork</span>(nodes, links) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-2">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">visIgraphLayout</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"full"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-3">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">visNodes</span>(</span>
<span id="cb7-4">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">shape =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dot"</span>,</span>
<span id="cb7-5">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(</span>
<span id="cb7-6">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">background =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#0085AF"</span>,</span>
<span id="cb7-7">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">border =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#013848"</span>,</span>
<span id="cb7-8">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">highlight =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#FF8000"</span></span>
<span id="cb7-9">        ),</span>
<span id="cb7-10">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scaling =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">min=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,</span>
<span id="cb7-11">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>),</span>
<span id="cb7-12">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">shadow =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">enabled =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)</span>
<span id="cb7-13">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-14">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">visEdges</span>(</span>
<span id="cb7-15">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">arrows=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'to'</span>,</span>
<span id="cb7-16">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">shadow =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,</span>
<span id="cb7-17">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#0085AF"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">highlight =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#C62F4B"</span>)</span>
<span id="cb7-18">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-19">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">visOptions</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">highlightNearest =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">enabled =</span> T, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">degree =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hover =</span> T)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb7-20">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">visLayout</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">randomSeed =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>)</span></code></pre></div>
<div class="cell-output-display">

<div class="visNetwork html-widget html-fill-item" id="htmlwidget-9e1effa9bfbedf79a12e" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-9e1effa9bfbedf79a12e">{"x":{"nodes":{"id":["bslib","callr","cli","cpp11","crayon","curl","data.table","devtools","digest","dplyr","evaluate","fansi","fs","generics","ggplot2","glue","htmltools","jsonlite","knitr","lifecycle","magrittr","pillar","pkgconfig","pkgdown","purrr","R6","ragg","Rcpp","readr","readxl","rgl","rlang","rmarkdown","sass","scales","sf","stringi","stringr","systemfonts","textshaping","tibble","tidyr","tidyselect","tidyverse","tinytex","utf8","vctrs","withr","xfun","yaml","base64enc","cachem","fastmap","grDevices","jquerylib","memoise","mime","processx","utils",null,"methods","desc","ellipsis","miniUI","pkgbuild","pkgload","profvis","rcmdcheck","remotes","roxygen2","rversions","sessioninfo","stats","testthat","tools","urlchecker","grid","gtable","isoband","MASS","mgcv","highr","downlit","httr","whisker","xml2","clipr","hms","vroom","cellranger","graphics","htmlwidgets","fontawesome","rappdirs","farver","labeling","munsell","RColorBrewer","viridisLite","classInt","DBI","s2","units","broom","conflicted","dbplyr","dtplyr","forcats","googledrive","googlesheets4","haven","lubridate","modelr","reprex","rstudioapi","rvest",""],"x":[0.3647032760543667,0.560134411839355,0.1831579767244667,-0.4152684319938845,0.4998909697992731,-1,0.7489399181806238,-0.1505495098635259,0.4717227435654268,0.3499774149361834,0.3722467868299084,0.4649958885402845,0.1568798547287655,0.6469213444892132,0.06670972649880813,0.1698842478833602,0.4115615842397244,0.4029936455915764,0.2212679132686113,0.1810006404072195,0.2596203661637966,0.415862327783687,0.6300945504504725,0.1821673068643084,0.3197608424386031,0.2826409044734308,0.202618439890653,0.09776922426535029,0.5202124913811672,0.6474648109736088,0.2803664705383406,0.2412222685279721,0.2709230813489298,0.3841715621695216,-0.1517568774354502,-0.07878899645607584,0.04132691726204096,0.1974630053814632,0.1687777466745615,0.08885397422999008,0.384599712673616,0.2819212492182981,0.093937192604163,0.4757875751314999,0.136742090770493,0.7860801933132626,0.2287969031035841,-0.0976506402806262,0.0847490471919734,0.1553777773239531,0.5244229065354289,0.6625584410721927,0.6280280267901994,0.1911312485011984,0.3705047138506476,0.07153331795789097,0.4838722925123726,0.9104432385101069,0.3140432462593952,-0.7407227752436201,0.3845914891741296,-0.1624042563470038,-0.3583246920868763,-0.535292522705449,-0.4850762887379624,-0.4034558000760784,-0.1776986216730028,-0.4259705738144779,-0.444577935581425,-0.3375427000702466,-0.2504827768868692,-0.5195128295724478,0.001200308640705305,-0.2740590935153852,0.02273425753267411,-0.481415895968735,-0.144419606117467,0.01272738200682633,-0.07844365634551864,-0.09709959638240306,-0.1789144240512749,0.200168549169998,-0.0496996854359204,0.4445990264261876,-0.2051613845905557,0.3089881087331052,0.8916898924768564,0.7074939834461902,0.9014474501221192,1,-0.07089490457002723,0.4823103178882935,0.3287705872392539,0.5722522695189325,-0.4790056982689369,-0.5442710592009437,-0.4537246817290971,-0.4863497148828009,-0.529758943402846,-0.3010160275238691,-0.3203767534831443,-0.3985379612858324,-0.3319615759989306,0.7548319069635108,0.6311879075904543,0.4544101298820775,0.444643747263741,0.7761071400297197,0.5473494892066006,0.5382049113005574,0.6810000860560836,0.8346259163924965,0.6325441811303369,0.8324273949573504,0.7163949404921732,0.366028228371799,-0.4533043625941722],"y":[0.4387023502481868,0.3089821010016576,0.008656082706055779,-1,0.224730396916986,-0.2586308758088548,0.4676534399168837,0.4285135441552643,0.3304206921305792,0.02836464283624895,0.6511130254238715,0.1096090645479804,0.4441273968162487,0.2026383119113195,-0.1649423038154341,-0.03759410511487138,0.398249647227801,0.1948844421137805,0.6376386763223509,0.06846120775800224,-0.005592567978628726,-0.06056854606355788,0.06737649917955291,0.1894017815299549,-0.08292684697739405,0.2160397496689865,-0.3985406166544613,0.1990504071419892,0.04022330805146934,-0.08518639451063248,0.3904725547885846,0.09508311313071616,0.5218536091591681,0.5039809778132673,-0.04541370754359286,0.0005054695394548503,0.1126951948610821,-0.1438518947641753,-0.7420609513917953,-0.7308408275694647,-0.006518525083251236,-0.1003565899239164,-0.04134217244951133,-0.2963056249299447,0.8038489120088461,-0.1129255974293271,-0.1009986968291207,0.1304526718098324,0.5485105485441724,0.5821541119631237,0.5450746408181328,0.718439848749056,0.5787853683774342,0.2372274289865142,0.7640309638941674,0.4676386307997547,0.6411690265374799,0.4345576908589119,0.1658767014167739,-0.7331988813133823,0.304374388495354,0.3360536755640715,0.7579171295203164,0.4402680681137245,0.6297477061055738,0.5729703349994844,0.800194712656918,0.69774319606719,0.4817084159897185,0.6526212556079964,0.7193194072217695,0.5413954794441025,0.2356057585866504,0.8053155975077795,0.3851316503970255,0.3742204964742377,-0.2669049555489662,-0.5263690366300252,-0.4645253932302699,-0.543867258407847,-0.4605271075076011,1,0.5084069997498566,-0.152526114314522,0.208163691305209,-0.2334790517182463,0.1356002181001397,-0.2141517415404118,0.03654571549372632,-0.1345086903759521,0.2595610993531405,0.7492043702673337,0.9080690769640105,0.8547999465457874,-0.001916503489592825,-0.04872597327506378,-0.2978815308407998,-0.1228326827312789,-0.1819462448107757,-0.2555650252235621,-0.3325373981589362,-0.1656285773535847,-0.1602572289712362,-0.4190940555384116,-0.6654332082761935,-0.5882894241011793,-0.6830289001776229,-0.536694470883301,-0.5846953621667461,-0.6896963954561222,-0.4829514626409229,-0.4548922180104726,-0.5638212827708142,-0.351694086535305,-0.6030319980023833,-0.6281211102504786,0.1530730433475522],"label":["bslib","callr","cli","cpp11","crayon","curl","data.table","devtools","digest","dplyr","evaluate","fansi","fs","generics","ggplot2","glue","htmltools","jsonlite","knitr","lifecycle","magrittr","pillar","pkgconfig","pkgdown","purrr","R6","ragg","Rcpp","readr","readxl","rgl","rlang","rmarkdown","sass","scales","sf","stringi","stringr","systemfonts","textshaping","tibble","tidyr","tidyselect","tidyverse","tinytex","utf8","vctrs","withr","xfun","yaml","base64enc","cachem","fastmap","grDevices","jquerylib","memoise","mime","processx","utils",null,"methods","desc","ellipsis","miniUI","pkgbuild","pkgload","profvis","rcmdcheck","remotes","roxygen2","rversions","sessioninfo","stats","testthat","tools","urlchecker","grid","gtable","isoband","MASS","mgcv","highr","downlit","httr","whisker","xml2","clipr","hms","vroom","cellranger","graphics","htmlwidgets","fontawesome","rappdirs","farver","labeling","munsell","RColorBrewer","viridisLite","classInt","DBI","s2","units","broom","conflicted","dbplyr","dtplyr","forcats","googledrive","googlesheets4","haven","lubridate","modelr","reprex","rstudioapi","rvest",""]},"edges":{"from":["bslib","bslib","bslib","bslib","bslib","bslib","bslib","bslib","bslib","bslib","bslib","bslib","callr","callr","callr","cli","crayon","crayon","crayon","data.table","devtools","devtools","devtools","devtools","devtools","devtools","devtools","devtools","devtools","devtools","devtools","devtools","devtools","devtools","devtools","devtools","devtools","devtools","devtools","devtools","devtools","devtools","devtools","digest","dplyr","dplyr","dplyr","dplyr","dplyr","dplyr","dplyr","dplyr","dplyr","dplyr","dplyr","dplyr","dplyr","evaluate","fansi","fansi","fs","generics","ggplot2","ggplot2","ggplot2","ggplot2","ggplot2","ggplot2","ggplot2","ggplot2","ggplot2","ggplot2","ggplot2","ggplot2","ggplot2","ggplot2","ggplot2","glue","htmltools","htmltools","htmltools","htmltools","htmltools","htmltools","knitr","knitr","knitr","knitr","knitr","knitr","lifecycle","lifecycle","lifecycle","pillar","pillar","pillar","pillar","pillar","pillar","pillar","pillar","pkgconfig","pkgdown","pkgdown","pkgdown","pkgdown","pkgdown","pkgdown","pkgdown","pkgdown","pkgdown","pkgdown","pkgdown","pkgdown","pkgdown","pkgdown","pkgdown","pkgdown","pkgdown","pkgdown","pkgdown","pkgdown","purrr","purrr","purrr","purrr","purrr","ragg","ragg","Rcpp","Rcpp","readr","readr","readr","readr","readr","readr","readr","readr","readr","readr","readr","readxl","readxl","readxl","rgl","rgl","rgl","rgl","rgl","rgl","rgl","rgl","rgl","rgl","rgl","rgl","rlang","rmarkdown","rmarkdown","rmarkdown","rmarkdown","rmarkdown","rmarkdown","rmarkdown","rmarkdown","rmarkdown","rmarkdown","rmarkdown","rmarkdown","rmarkdown","sass","sass","sass","sass","sass","scales","scales","scales","scales","scales","scales","scales","scales","scales","scales","sf","sf","sf","sf","sf","sf","sf","sf","sf","sf","sf","sf","stringi","stringi","stringi","stringr","stringr","stringr","stringr","stringr","stringr","stringr","textshaping","tibble","tibble","tibble","tibble","tibble","tibble","tibble","tibble","tibble","tidyr","tidyr","tidyr","tidyr","tidyr","tidyr","tidyr","tidyr","tidyr","tidyr","tidyr","tidyr","tidyselect","tidyselect","tidyselect","tidyselect","tidyselect","tidyselect","tidyverse","tidyverse","tidyverse","tidyverse","tidyverse","tidyverse","tidyverse","tidyverse","tidyverse","tidyverse","tidyverse","tidyverse","tidyverse","tidyverse","tidyverse","tidyverse","tidyverse","tidyverse","tidyverse","tidyverse","tidyverse","tidyverse","tidyverse","tidyverse","tidyverse","tidyverse","tidyverse","tidyverse","tidyverse","tidyverse","tinytex","vctrs","vctrs","vctrs","vctrs","withr","withr","withr","xfun","xfun","xfun"],"to":["base64enc","cachem","fastmap","grDevices","htmltools","jquerylib","jsonlite","lifecycle","memoise","mime","rlang","sass","processx","R6","utils","utils","grDevices","methods","utils","methods","cli","desc","ellipsis","fs","lifecycle","memoise","miniUI","pkgbuild","pkgdown","pkgload","profvis","rcmdcheck","remotes","rlang","roxygen2","rversions","sessioninfo","stats","testthat","tools","urlchecker","utils","withr","utils","cli","generics","glue","lifecycle","magrittr","methods","pillar","R6","rlang","tibble","tidyselect","utils","vctrs","methods","grDevices","utils","methods","methods","cli","glue","grDevices","grid","gtable","isoband","lifecycle","MASS","mgcv","rlang","scales","stats","tibble","vctrs","withr","methods","base64enc","digest","fastmap","grDevices","rlang","utils","evaluate","highr","methods","tools","xfun","yaml","cli","glue","rlang","cli","fansi","glue","lifecycle","rlang","utf8","utils","vctrs","utils","bslib","callr","cli","desc","digest","downlit","fs","httr","jsonlite","magrittr","memoise","purrr","ragg","rlang","rmarkdown","tibble","whisker","withr","xml2","yaml","cli","lifecycle","magrittr","rlang","vctrs","systemfonts","textshaping","methods","utils","cli","clipr","crayon","hms","lifecycle","methods","R6","rlang","tibble","utils","vroom","cellranger","tibble","utils","graphics","grDevices","stats","utils","htmlwidgets","htmltools","knitr","jsonlite","magrittr","R6","base64enc","mime","utils","bslib","evaluate","fontawesome","htmltools","jquerylib","jsonlite","knitr","methods","tinytex","tools","utils","xfun","yaml","fs","rlang","htmltools","R6","rappdirs","cli","farver","glue","labeling","lifecycle","munsell","R6","RColorBrewer","rlang","viridisLite","classInt","DBI","graphics","grDevices","grid","magrittr","Rcpp","s2","stats","tools","units","utils","tools","utils","stats","cli","glue","lifecycle","magrittr","rlang","stringi","vctrs","systemfonts","fansi","lifecycle","magrittr","methods","pillar","pkgconfig","rlang","utils","vctrs","cli","dplyr","glue","lifecycle","magrittr","purrr","rlang","stringr","tibble","tidyselect","utils","vctrs","cli","glue","lifecycle","rlang","vctrs","withr","broom","conflicted","cli","dbplyr","dplyr","dtplyr","forcats","ggplot2","googledrive","googlesheets4","haven","hms","httr","jsonlite","lubridate","magrittr","modelr","pillar","purrr","ragg","readr","readxl","reprex","rlang","rstudioapi","rvest","stringr","tibble","tidyr","xml2","xfun","cli","glue","lifecycle","rlang","graphics","grDevices","","grDevices","stats","tools"]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"physics":false,"shape":"dot","color":{"background":"#0085AF","border":"#013848","highlight":"#FF8000"},"shadow":{"enabled":true,"size":10},"scaling":{"min":2,"max":10}},"manipulation":{"enabled":false},"edges":{"smooth":false,"arrows":"to","color":{"color":"#0085AF","highlight":"#C62F4B"},"shadow":false},"physics":{"stabilization":false},"interaction":{"hover":true,"zoomSpeed":1},"layout":{"randomSeed":11}},"groups":null,"width":null,"height":null,"idselection":{"enabled":false,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","igraphlayout":{"type":"full"},"tooltipStay":300,"tooltipStyle":"position: fixed;visibility:hidden;padding: 5px;white-space: nowrap;font-family: verdana;font-size:14px;font-color:#000000;background-color: #f5f4ed;-moz-border-radius: 3px;-webkit-border-radius: 3px;border-radius: 3px;border: 1px solid #808074;box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);","highlight":{"enabled":true,"hoverNearest":true,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Do not hesitate to move, zoom in or select packages to see their dependencies !</p>


</section>

<a onclick="window.scrollTo(0, 0); return false;" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a> ]]></description>
  <category>R</category>
  <category>EDA</category>
  <guid>https://aureliencallens.github.io/posts/2022-07-19-top-r-packages/index.html</guid>
  <pubDate>Mon, 18 Jul 2022 22:00:00 GMT</pubDate>
</item>
<item>
  <title>Can R and Shiny make me a better fisherman? Part 4</title>
  <dc:creator>Aurélien Callens</dc:creator>
  <link>https://aureliencallens.github.io/posts/2022-04-12-datascience-fishing-part4/index.html</link>
  <description><![CDATA[ 




<p>In this post, I explore the data I have collected during the last year with the updated version of the application (presented <a href="../../2021/06/01/r-shiny-fishing-part3/">here</a>). This quick exploratory analysis is performed with two packages I really enjoy: <em>Plotly</em> and <em>shiny</em>.</p>
<p>For reminder, my new application store the data in three csv files. The first one contains variables related to the fishing conditions. The second one contains information about my catches and finally the third one contains information about the characteristics of the lures I used during the session.</p>
<section id="shiny-to-explore-fishing-data-by-session" class="level2">
<h2 class="anchored" data-anchor-id="shiny-to-explore-fishing-data-by-session">Shiny to explore fishing data by session</h2>
<p>I coded a small shiny application that provide a summary of the tide and river flow conditions, the lure changes and catches for each session. Don’t hesitate to explore my fishing data!</p>
<div class="wrap" style="width: 100%; height: 1500px;
    padding: 0; overflow: hidden;">
<iframe style="width: 800px;
    height: 1550px;
    border: 0;
    -ms-transform: scale(0.25);
    -moz-transform: scale(0.25);
    -o-transform: scale(0.25);
    -webkit-transform: scale(0.25);
    transform: scale(0.95);
    -ms-transform-origin: 0 0;
    -moz-transform-origin: 0 0;
    -o-transform-origin: 0 0;
    -webkit-transform-origin: 0 0;
    transform-origin: 0 0;" src="https://aureliencallens.shinyapps.io/Fishing_analysis/">
</iframe>
</div>
</section>
<section id="code-of-the-shiny-application" class="level2">
<h2 class="anchored" data-anchor-id="code-of-the-shiny-application">Code of the shiny application</h2>
<p>Here is the code of the plotly graphs in the application:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(plotly)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb1-3"></span>
<span id="cb1-4"></span>
<span id="cb1-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' For the tide plot</span></span>
<span id="cb1-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' </span></span>
<span id="cb1-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param dat first dataframe with session characteristics</span></span>
<span id="cb1-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param n_ses the id (number) of the session</span></span>
<span id="cb1-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param temporal_range number of hours to display (before and after the session)</span></span>
<span id="cb1-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @return A plotly object</span></span>
<span id="cb1-11">plot_tide_ses <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(dat, n_ses, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">temporal_range =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>){</span>
<span id="cb1-12"></span>
<span id="cb1-13">  dat_t <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> dat <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-14">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(Session <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> n_ses) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-15">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Tide_ts =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">eval</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">parse</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> Ts_tide))))</span>
<span id="cb1-16">  dat_tide <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.data.frame</span>(dat_t<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Tide_ts)</span>
<span id="cb1-17">  dat_tide<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>hour <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.POSIXct</span>(dat_tide<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>hour, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">origin =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1970-01-01"</span>)</span>
<span id="cb1-18">  dat_tide<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Water <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.character</span>(dat_tide<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Water))</span>
<span id="cb1-19">  </span>
<span id="cb1-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_ly</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dat_tide, </span>
<span id="cb1-21">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> hour, </span>
<span id="cb1-22">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> Water, </span>
<span id="cb1-23">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mode =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'lines'</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span>  </span>
<span id="cb1-24">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">layout</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">shapes =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(</span>
<span id="cb1-25">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'line'</span>,</span>
<span id="cb1-26">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x0 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.POSIXct</span>(dat_t<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Beg),</span>
<span id="cb1-27">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x1 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.POSIXct</span>(dat_t<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Beg),</span>
<span id="cb1-28">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y0 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">min</span>(dat_tide<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Water),</span>
<span id="cb1-29">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y1 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">max</span>(dat_tide<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Water),</span>
<span id="cb1-30">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">line =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dash =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'dot'</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)),</span>
<span id="cb1-31">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'line'</span>,</span>
<span id="cb1-32">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x0 =</span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.POSIXct</span>(dat_t<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>End),</span>
<span id="cb1-33">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x1 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.POSIXct</span>(dat_t<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>End),</span>
<span id="cb1-34">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y0 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">min</span>(dat_tide<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Water),</span>
<span id="cb1-35">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y1 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">max</span>(dat_tide<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Water),</span>
<span id="cb1-36">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">line =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dash =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'dot'</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>))),</span>
<span id="cb1-37">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xaxis =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">range =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.POSIXct</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.POSIXct</span>(dat_t<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Beg) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3600</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>temporal_range ,</span>
<span id="cb1-38">                                        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.POSIXct</span>(dat_t<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>End) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3600</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>temporal_range )),</span>
<span id="cb1-39">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>),</span>
<span id="cb1-40">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yaxis =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Tide level"</span>))</span>
<span id="cb1-41">}</span>
<span id="cb1-42"></span>
<span id="cb1-43"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' For the river flow plot</span></span>
<span id="cb1-44"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' </span></span>
<span id="cb1-45"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param dat first dataframe with session characteristics</span></span>
<span id="cb1-46"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param n_ses the id (number) of the session</span></span>
<span id="cb1-47"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param past_days number of previous to display (before the session)</span></span>
<span id="cb1-48"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @return A plotly object</span></span>
<span id="cb1-49">plot_flow_ses <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(dat, n_ses, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">past_days =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>){</span>
<span id="cb1-50">  dat_t <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> dat <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-51">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(Session <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> n_ses) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-52">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Flow_ts =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">eval</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">parse</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> Ts_flow))))</span>
<span id="cb1-53">  </span>
<span id="cb1-54">  dat_flow <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.data.frame</span>(dat_t<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Flow_ts)</span>
<span id="cb1-55">  dat_flow<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Date <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.POSIXct</span>(dat_flow<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Date, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">origin =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1970-01-01"</span>)</span>
<span id="cb1-56">  dat_flow<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Nive <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.character</span>(dat_flow<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Nive))</span>
<span id="cb1-57">  dat_flow<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Adour <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.character</span>(dat_flow<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Adour))</span>
<span id="cb1-58">  </span>
<span id="cb1-59">  </span>
<span id="cb1-60">  dat_flow <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> dat_flow <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-61">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cols =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(Nive, Adour), </span>
<span id="cb1-62">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"River"</span>,</span>
<span id="cb1-63">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Flow"</span>)</span>
<span id="cb1-64">  </span>
<span id="cb1-65">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_ly</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dat_flow, </span>
<span id="cb1-66">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> Date,</span>
<span id="cb1-67">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> Flow, </span>
<span id="cb1-68">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> River, </span>
<span id="cb1-69">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mode =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'lines'</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span>  </span>
<span id="cb1-70">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">layout</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">shapes =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(</span>
<span id="cb1-71">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'line'</span>,</span>
<span id="cb1-72">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x0 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.POSIXct</span>(dat_t<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Beg),</span>
<span id="cb1-73">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x1 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.POSIXct</span>(dat_t<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Beg),</span>
<span id="cb1-74">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y0 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">min</span>(dat_flow<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Flow),</span>
<span id="cb1-75">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y1 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">max</span>(dat_flow<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Flow),</span>
<span id="cb1-76">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">line =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dash =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'dot'</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>))),</span>
<span id="cb1-77">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xaxis =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">range =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.POSIXct</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.POSIXct</span>(dat_t<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Beg) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3600</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">24</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>past_days,</span>
<span id="cb1-78">                                        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.POSIXct</span>(dat_t<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>End) )),</span>
<span id="cb1-79">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>))</span>
<span id="cb1-80">}</span>
<span id="cb1-81"></span>
<span id="cb1-82"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' Function to prepare the dataset for the plot of lure change and catch</span></span>
<span id="cb1-83"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' </span></span>
<span id="cb1-84"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param lure third dataframe with lure changes (hours) and characteristics</span></span>
<span id="cb1-85"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param session first dataframe with session characteristics</span></span>
<span id="cb1-86"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param ses_n the id (number) of the session</span></span>
<span id="cb1-87"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @return A dataframe</span></span>
<span id="cb1-88">start_end_fonction <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(lure, session, ses_n){</span>
<span id="cb1-89">  dat_ses <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> session <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-90">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(Session <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> ses_n)</span>
<span id="cb1-91">  </span>
<span id="cb1-92">  dat_lure <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> lure <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-93">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(n_ses <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> ses_n)</span>
<span id="cb1-94">  </span>
<span id="cb1-95">  startdates <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> dat_lure<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>time</span>
<span id="cb1-96">  enddates <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(startdates[<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], dat_ses<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>End)</span>
<span id="cb1-97">  </span>
<span id="cb1-98">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">change =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(startdates)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, </span>
<span id="cb1-99">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">start =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.POSIXct</span>(startdates),</span>
<span id="cb1-100">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">end =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.POSIXct</span>(enddates),</span>
<span id="cb1-101">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> dat_lure<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>type_lure,</span>
<span id="cb1-102">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(dat_lure<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>color_lure, dat_lure<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>length_lure))</span>
<span id="cb1-103">}</span>
<span id="cb1-104"></span>
<span id="cb1-105"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' For the plot of lure change and catch</span></span>
<span id="cb1-106"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' </span></span>
<span id="cb1-107"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param lure third dataframe with lure changes (hours) and characteristics</span></span>
<span id="cb1-108"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param caught second dataframe with fish caught characteristics</span></span>
<span id="cb1-109"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param session first dataframe with session characteristics</span></span>
<span id="cb1-110"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param n_ses the id (number) of the session</span></span>
<span id="cb1-111"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @return A plotly object</span></span>
<span id="cb1-112">lure_change <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(lure, caught, dat, n_ses){</span>
<span id="cb1-113">  </span>
<span id="cb1-114">  df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">start_end_fonction</span>(lure, dat, n_ses)</span>
<span id="cb1-115">  </span>
<span id="cb1-116">  catch <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> caught <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-117">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(n_ses <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> n_ses)</span>
<span id="cb1-118">  </span>
<span id="cb1-119">  dat_t <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> dat <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-120">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(Session <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> n_ses) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-121">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Tide_ts =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">eval</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">parse</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> Ts_tide))))</span>
<span id="cb1-122">  dat_tide <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.data.frame</span>(dat_t<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Tide_ts)</span>
<span id="cb1-123">  dat_tide<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>hour <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.POSIXct</span>(dat_tide<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>hour, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">origin =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1970-01-01"</span>)</span>
<span id="cb1-124">  dat_tide<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Water <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.character</span>(dat_tide<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Water))</span>
<span id="cb1-125">  </span>
<span id="cb1-126">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_ly</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-127">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_segments</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> df,</span>
<span id="cb1-128">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> start,</span>
<span id="cb1-129">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xend =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> end,</span>
<span id="cb1-130">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> change,</span>
<span id="cb1-131">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yend =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> change,</span>
<span id="cb1-132">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> type,</span>
<span id="cb1-133">                 <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#text = ~ text,</span></span>
<span id="cb1-134">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">I</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>),</span>
<span id="cb1-135">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb1-136">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_segments</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.POSIXct</span>(catch<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>time),</span>
<span id="cb1-137">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xend =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.POSIXct</span>(catch<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>time),</span>
<span id="cb1-138">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">min</span>(df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>change),</span>
<span id="cb1-139">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yend =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">max</span>(df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>change),</span>
<span id="cb1-140">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">line =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dash =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dash"</span>),</span>
<span id="cb1-141">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Fish caught'</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb1-142">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_trace</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dat_tide, </span>
<span id="cb1-143">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> hour, </span>
<span id="cb1-144">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> Water, </span>
<span id="cb1-145">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mode =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'lines'</span>, </span>
<span id="cb1-146">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yaxis =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y2"</span>,</span>
<span id="cb1-147">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Water level"</span>,</span>
<span id="cb1-148">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>,</span>
<span id="cb1-149">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hoverinfo =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'skip'</span></span>
<span id="cb1-150">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-151">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">layout</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xaxis =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">range =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>start[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span> , df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>end[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(df)] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>),</span>
<span id="cb1-152">                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>),</span>
<span id="cb1-153">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yaxis =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">zeroline =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">showline =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,</span>
<span id="cb1-154">                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">showticklabels =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">showgrid =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span> ),</span>
<span id="cb1-155">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yaxis2 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">overlaying =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">side =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"right"</span>))</span>
<span id="cb1-156">}</span></code></pre></div>
</div>
<p>Here is the code of this simple yet informative application:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(shiny)</span>
<span id="cb2-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(shinyWidgets)</span>
<span id="cb2-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(shinydashboard)</span>
<span id="cb2-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(plotly)</span>
<span id="cb2-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb2-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">source</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'plot_functions.R'</span>)</span>
<span id="cb2-7">dat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"session1.csv"</span>)</span>
<span id="cb2-8">caught <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"catch1.csv"</span>)</span>
<span id="cb2-9">lure <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lure.csv"</span>)</span>
<span id="cb2-10"></span>
<span id="cb2-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># In order to save the tide and flow time series I parse the data in the dataframe</span></span>
<span id="cb2-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># The following line is used to transform the parsed text into usable values</span></span>
<span id="cb2-13">dat_t <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> dat <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb2-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Tide_ts =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">eval</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">parse</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> Ts_tide))),</span>
<span id="cb2-15">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Flow_ts =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">eval</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">parse</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> Ts_flow))))</span>
<span id="cb2-16"></span>
<span id="cb2-17">body <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dashboardBody</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fluidPage</span>(</span>
<span id="cb2-18">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Application title</span></span>
<span id="cb2-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">h1</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Exploratory analysis of fishing data"</span>,</span>
<span id="cb2-20">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">align =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"center"</span>,</span>
<span id="cb2-21">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">style =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"padding: 40px;  text-align: center;  background: #605ca8;  color: white;  font-size: 40px;"</span>),</span>
<span id="cb2-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">br</span>(),</span>
<span id="cb2-23">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Dropdown menu to select the fishing session</span></span>
<span id="cb2-24">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fluidRow</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">align =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"center"</span>,</span>
<span id="cb2-25">           <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pickerInput</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">inputId =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Ses'</span>,</span>
<span id="cb2-26">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">h3</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Select a fishing session:'</span>),</span>
<span id="cb2-27">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">choices =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unique</span>(dat<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Session[<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]),</span>
<span id="cb2-28">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">options =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(</span>
<span id="cb2-29">                         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">style =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"btn-primary"</span>),</span>
<span id="cb2-30">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">choicesOpt =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(</span>
<span id="cb2-31">                         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">style =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep_len</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"font-size: 75%; line-height: 1.6;"</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)</span>
<span id="cb2-32">                       ))),</span>
<span id="cb2-33">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">br</span>(),</span>
<span id="cb2-34">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">br</span>(),</span>
<span id="cb2-35">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Key figures of the session</span></span>
<span id="cb2-36">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fluidRow</span>(</span>
<span id="cb2-37">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">valueBoxOutput</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"progressD"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>),</span>
<span id="cb2-38">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">valueBoxOutput</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"progressF"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>),</span>
<span id="cb2-39">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">valueBoxOutput</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"progressL"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)),</span>
<span id="cb2-40">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">br</span>(),</span>
<span id="cb2-41">  </span>
<span id="cb2-42">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">br</span>(),</span>
<span id="cb2-43">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Graphs of the tide and river flow of recent days</span></span>
<span id="cb2-44">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fluidRow</span>(</span>
<span id="cb2-45">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">box</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Tidal water level"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">status =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"primary"</span>, </span>
<span id="cb2-46">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plotlyOutput</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"TidePlot"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>),</span>
<span id="cb2-47">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">box</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"River flow"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">status =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"primary"</span>,</span>
<span id="cb2-48">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plotlyOutput</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FlowPlot"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>)),</span>
<span id="cb2-49">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">br</span>(),</span>
<span id="cb2-50">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Graph lure changes during the session + catch</span></span>
<span id="cb2-51">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fluidRow</span>(</span>
<span id="cb2-52">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">box</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Lures tested and fish capture"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">status =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"warning"</span>, </span>
<span id="cb2-53">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plotlyOutput</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"LurePlot"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>))</span>
<span id="cb2-54">))</span>
<span id="cb2-55"></span>
<span id="cb2-56">ui <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dashboardPage</span>(</span>
<span id="cb2-57">  </span>
<span id="cb2-58">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dashboardHeader</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">disable =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>),</span>
<span id="cb2-59">  </span>
<span id="cb2-60">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dashboardSidebar</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">disable =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>),</span>
<span id="cb2-61">  </span>
<span id="cb2-62">  body</span>
<span id="cb2-63">)</span>
<span id="cb2-64"></span>
<span id="cb2-65"></span>
<span id="cb2-66"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define server logic required to draw a histogram</span></span>
<span id="cb2-67">server <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(input, output) {</span>
<span id="cb2-68">  </span>
<span id="cb2-69">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Duration</span></span>
<span id="cb2-70">  output<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>progressD <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">renderValueBox</span>({</span>
<span id="cb2-71">    Duration <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.integer</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">difftime</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.POSIXct</span>(dat<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>End[dat<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Session <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> input<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Ses]), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.POSIXct</span>(dat<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Beg[dat<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Session <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> input<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Ses]), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">units =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'mins'</span>))</span>
<span id="cb2-72">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">valueBox</span>(tags<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">p</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Duration"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">style =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"font-size: 80%;"</span>),</span>
<span id="cb2-73">             tags<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">p</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(Duration, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"min"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">style =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"font-size: 150%; font-weight: bold;"</span>),</span>
<span id="cb2-74">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">icon =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">icon</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"clock"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"purple"</span>)</span>
<span id="cb2-75">  })</span>
<span id="cb2-76">  </span>
<span id="cb2-77">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Number of fish</span></span>
<span id="cb2-78">  </span>
<span id="cb2-79">  output<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>progressF <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">renderValueBox</span>({</span>
<span id="cb2-80">    fish_caught <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.integer</span>(caught <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(n_ses <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> input<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Ses) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>())</span>
<span id="cb2-81">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">valueBox</span>(tags<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">p</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Fish caught"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">style =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"font-size: 80%;"</span>), tags<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">p</span>(fish_caught, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">style =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"font-size: 150%;font-weight: bold;"</span>),</span>
<span id="cb2-82">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">icon =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">icon</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"trophy"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"purple"</span>)</span>
<span id="cb2-83">  })</span>
<span id="cb2-84">  </span>
<span id="cb2-85">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Number of lures tried</span></span>
<span id="cb2-86">  </span>
<span id="cb2-87">  output<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>progressL <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">renderValueBox</span>({</span>
<span id="cb2-88">    Lure <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.integer</span>(lure <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(n_ses <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> input<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Ses) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>())</span>
<span id="cb2-89">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">valueBox</span>(tags<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">p</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Lure tried"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">style =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"font-size: 80%;"</span>), tags<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">p</span>(Lure, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">style =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"font-size: 150%;font-weight: bold;"</span>),</span>
<span id="cb2-90">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">icon =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">icon</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fish"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"purple"</span>)</span>
<span id="cb2-91">  })</span>
<span id="cb2-92">  </span>
<span id="cb2-93">  output<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>TidePlot <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">renderPlotly</span>({</span>
<span id="cb2-94">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># generate plot depending on session</span></span>
<span id="cb2-95">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_tide_ses</span>(dat, input<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Ses, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)</span>
<span id="cb2-96">  })</span>
<span id="cb2-97">  output<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>FlowPlot <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">renderPlotly</span>({</span>
<span id="cb2-98">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># generate plot depending on session</span></span>
<span id="cb2-99">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_flow_ses</span>(dat_t, input<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Ses, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)</span>
<span id="cb2-100">  })</span>
<span id="cb2-101">  output<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>LurePlot <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">renderPlotly</span>({</span>
<span id="cb2-102">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># generate plot depending on session</span></span>
<span id="cb2-103">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lure_change</span>(lure, caught, dat, input<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Ses)</span>
<span id="cb2-104">  })</span>
<span id="cb2-105">  </span>
<span id="cb2-106">}</span>
<span id="cb2-107"></span>
<span id="cb2-108"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run the application </span></span>
<span id="cb2-109"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">shinyApp</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ui =</span> ui, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">server =</span> server)</span></code></pre></div>
</div>


</section>

<a onclick="window.scrollTo(0, 0); return false;" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a> ]]></description>
  <category>R</category>
  <category>Shiny</category>
  <category>EDA</category>
  <guid>https://aureliencallens.github.io/posts/2022-04-12-datascience-fishing-part4/index.html</guid>
  <pubDate>Mon, 11 Apr 2022 22:00:00 GMT</pubDate>
  <media:content url="https://aureliencallens.github.io/posts/2022-04-12-datascience-fishing-part4/images/seabass_bay.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>The end of my PhD journey</title>
  <dc:creator>Aurelien Callens</dc:creator>
  <link>https://aureliencallens.github.io/posts/2021-10-02-the-end-of-a-journey/index.html</link>
  <description><![CDATA[ 




<p>Two weeks ago, I defended my thesis entitled ‘Statistical learning for coastal risks assessment’ in front of an academic jury. The defense went extremely well and the jury and the auditory were genuinely interested by the work I had done during my thesis. This thesis was an amazing and enriching journey in terms of knowledge and research, but also in terms of collaboration and exchange. I now am excited to start a new journey and discover new subjects to work on !</p>
<p>You can find my thesis manuscript here: <a href="http://www.theses.fr/2021PAUU3016" target="_blank"> http://www.theses.fr/2021PAUU3016</a>. If you don’t have the courage to read the entire manuscript (I understand :wink:) you can find below a short abstract of my thesis and the slides I presented during my PhD defense.</p>
<section id="abstract-of-my-thesis" class="level2">
<h2 class="anchored" data-anchor-id="abstract-of-my-thesis">Abstract of my thesis</h2>
<p>Over the last decades, the quantity of data related to coastal risk has greatly increased with the installation of numerous monitoring networks. In this era of big data, the use of statistical learning methods (SLM) in the development of local predictive models becomes more legitimate and justified. The objective of this thesis is to demonstrate how SLM can contribute to the improvement of coastal risk assessment tools and to the development of an early warning system which aims to reduce coastal flooding risk.</p>
<p>Three methodologies have been developed and tested on real study sites. The first methodology aims to improve the local wave forecast made by spectral wave model with machine learning methods and data from monitoring networks. We showed that data assimilation with machine learning methods improve significantly the forecast of wave parameters especially the wave height and period. The second methodology concerns the creation of storm impact databases. Even though these databases are essential for the disaster risk reduction process they are rare and sparse. We therefore proposed a methodology based on a deep learning method (convolutional neural networks) to generate automatically qualitative storm impact data from images provided by video monitoring stations installed on the coast. The last methodology is about the development of a storm impact model with a statistical method (bayesian network) based exclusively on data acquired with diverse monitoring networks. With this methodology we were able to predict qualitatively the storm impact on our study site, the Grande Plage of Biarritz.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://aureliencallens.github.io/posts/2021-10-02-the-end-of-a-journey/images/thesis_organization.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Organization of my PhD manuscript</figcaption>
</figure>
</div>
</section>
<section id="my-presentation-for-the-phd-defense" class="level2">
<h2 class="anchored" data-anchor-id="my-presentation-for-the-phd-defense">My presentation for the PhD defense</h2>
<p>You can find my presentation <a href="../../doc/Presentation_thesis_Callens_Aurelien.pdf">here</a></p>


</section>

<a onclick="window.scrollTo(0, 0); return false;" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a> ]]></description>
  <guid>https://aureliencallens.github.io/posts/2021-10-02-the-end-of-a-journey/index.html</guid>
  <pubDate>Fri, 01 Oct 2021 22:00:00 GMT</pubDate>
</item>
<item>
  <title>Can R and Shiny make me a better fisherman? Part 3</title>
  <dc:creator>Aurélien Callens</dc:creator>
  <link>https://aureliencallens.github.io/posts/2021-06-01-datascience-fishing-part3/index.html</link>
  <description><![CDATA[ 




<p>In this <a href="../../posts/2020-09-12-datascience-fishing-part1">previous post</a>, I presented the shiny application I developed to record data about my fishing session. In today’s post, I will present briefly the changes and updates I made to improve the application. Here are the main changes:</p>
<ul>
<li><p><strong>Weather API</strong>: the API I was using (Dark Sky) stopped furnishing free data. I changed for <a href="https://openweathermap.org/">Openweathermap</a> and I needed to update the functions to gather the same information as before.</p></li>
<li><p><strong>River flow</strong>: the first version of the application did not collect any data about the flow of the river in which I am fishing. However I am convinced that the river flow before the fishing session might have an impact on the presence of seabass. I therefore created a web scrapping function that collect the flow of the Nive and the Adour (main fishing rivers).</p></li>
<li><p><strong>Collecting lure data</strong>: in the first version, data about fishing lures I used were only collected when a fish was caught. However I did not have data about how long I used the lure before catching a fish. The new version of the application now collects data about lure and how often I change lure.</p></li>
</ul>
<section id="weather-api" class="level2">
<h2 class="anchored" data-anchor-id="weather-api">Weather API</h2>
<p>Small changes were made to adapt the former weather function to the new weather API. As this new API do not furnish moon phase data, I decided to compute the moon phase with the <em>oce</em> package:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(httr)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(jsonlite)</span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb1-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(rvest)</span>
<span id="cb1-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(oce)</span>
<span id="cb1-6"></span>
<span id="cb1-7">weather <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(lat, lon, API_key){</span>
<span id="cb1-8">  url <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"api.openweathermap.org/data/2.5/weather?lat="</span>, lat, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&amp;lon="</span>, lon, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&amp;appid="</span>, API_key, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&amp;units=metric"</span>)</span>
<span id="cb1-9">  </span>
<span id="cb1-10">  rep <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">GET</span>(url)</span>
<span id="cb1-11">  </span>
<span id="cb1-12">  table <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fromJSON</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">content</span>(rep, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text"</span>))</span>
<span id="cb1-13">  </span>
<span id="cb1-14">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># The weather API don't provide moon phase so I compute it with Oce package</span></span>
<span id="cb1-15">  moon_phase <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">moonAngle</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">t =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Sys.Date</span>(),</span>
<span id="cb1-16">                                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">longitude =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(lon),</span>
<span id="cb1-17">                                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">latitude =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(lat))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>illuminatedFraction,</span>
<span id="cb1-18">                      <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span>
<span id="cb1-19">  </span>
<span id="cb1-20">  </span>
<span id="cb1-21">  current.weather.info <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Air_temp =</span> table<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>main<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>temp,</span>
<span id="cb1-22">                                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Weather =</span> table<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>weather<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>main,</span>
<span id="cb1-23">                                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Atm_pres =</span> table<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>main<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>pressure,</span>
<span id="cb1-24">                                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Wind_str =</span> table<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>wind<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>speed,</span>
<span id="cb1-25">                                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Wind_dir =</span> table<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>wind<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>deg,</span>
<span id="cb1-26">                                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Cloud_cover =</span> table<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>clouds<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>all,</span>
<span id="cb1-27">                                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">PrecipInt =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.null</span>(table<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>rains<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">1h</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, table<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>rains<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">1h</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>),  </span>
<span id="cb1-28">                                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Moon =</span> moon_phase)</span>
<span id="cb1-29">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(current.weather.info)</span>
<span id="cb1-30">}</span></code></pre></div>
</div>
</section>
<section id="river-flow" class="level2">
<h2 class="anchored" data-anchor-id="river-flow">River flow</h2>
<p>I wrote functions to scrap information about the flows of the rivers in which I fish the most on a french website:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get and prepare the flow data</span></span>
<span id="cb2-2">get_Qdata <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(link){</span>
<span id="cb2-3">  table <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fromJSON</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">content</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">GET</span>(link), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text"</span>))</span>
<span id="cb2-4">  table <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> table<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Serie<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>ObssHydro</span>
<span id="cb2-5">  table <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.data.frame</span>(table)</span>
<span id="cb2-6">  table<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>DtObsHydro <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sub</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"T"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" "</span>, table<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>DtObsHydro)</span>
<span id="cb2-7">  table<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>DtObsHydro <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">substr</span>(table<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>DtObsHydro, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">start =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stop =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">19</span>)</span>
<span id="cb2-8">  ts <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Date =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq.POSIXt</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.POSIXct</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">range</span>(table<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>DtObsHydro)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>],<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'%m/%d/%y %H:%M:%S'</span>), </span>
<span id="cb2-9">                                     <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.POSIXct</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">range</span>(table<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>DtObsHydro)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>],<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'%m/%d/%y %H:%M:%S'</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"hour"</span>))</span>
<span id="cb2-10">  </span>
<span id="cb2-11">  table<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>DtObsHydro <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.POSIXct</span>(table<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>DtObsHydro, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">format =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"%Y-%m-%d %H:%M:%S"</span>)</span>
<span id="cb2-12">  </span>
<span id="cb2-13">  table <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">full_join</span>(table, ts, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"DtObsHydro"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Date"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(DtObsHydro)</span>
<span id="cb2-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(table)</span>
<span id="cb2-15">}</span>
<span id="cb2-16"></span>
<span id="cb2-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Main function to collect river flow </span></span>
<span id="cb2-18"></span>
<span id="cb2-19">river_flow <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(){</span>
<span id="cb2-20">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Url of website to scrap:</span></span>
<span id="cb2-21">  url_index <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://www.vigicrues.gouv.fr/services/station.json/index.php"</span></span>
<span id="cb2-22">  </span>
<span id="cb2-23">  rep <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">GET</span>(url_index)</span>
<span id="cb2-24">  </span>
<span id="cb2-25">  table_index <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fromJSON</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">content</span>(rep, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text"</span>))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Stations<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb2-26">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">na.omit</span>()</span>
<span id="cb2-27">  </span>
<span id="cb2-28">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># I need to add the flow of several rivers to get the flow of the rivers I am interested in:</span></span>
<span id="cb2-29">  stations <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> table_index <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb2-30">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(LbStationHydro <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Pontonx-sur-l'Adour"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"St-Pandelon"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Artiguelouve"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Escos"</span>,</span>
<span id="cb2-31">                                 <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Aïcirits [St-Palais]"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Cambo-les-Bains"</span>))</span>
<span id="cb2-32">  </span>
<span id="cb2-33">  base_url <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"http://www.vigicrues.gouv.fr/services/observations.json?CdStationHydro="</span></span>
<span id="cb2-34">  height_url <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&amp;FormatDate=iso"</span></span>
<span id="cb2-35">  Q_url <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&amp;GrdSerie=Q"</span></span>
<span id="cb2-36">  </span>
<span id="cb2-37">  stations <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> stations <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb2-38">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">WL_link =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(base_url, CdStationHydro, height_url),</span>
<span id="cb2-39">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Q_link =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(WL_link, Q_url))</span>
<span id="cb2-40">  </span>
<span id="cb2-41">  data_Q <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lapply</span>(stations<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Q_link, </span>
<span id="cb2-42">                   <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(x){<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">get_Qdata</span>(x)})</span>
<span id="cb2-43">  </span>
<span id="cb2-44">  data_Q <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">suppressWarnings</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Reduce</span>(<span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(...) <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">merge</span>(..., <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">all =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"DtObsHydro"</span>),</span>
<span id="cb2-45">                   data_Q))</span>
<span id="cb2-46">  </span>
<span id="cb2-47">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(data_Q) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Date"</span>, stations<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>LbStationHydro) </span>
<span id="cb2-48">  </span>
<span id="cb2-49">  data_Q <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> data_Q  <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb2-50">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hour_of_day =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">format</span>(Date, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"%Y-%m-%d %H"</span>))</span>
<span id="cb2-51">  </span>
<span id="cb2-52">  </span>
<span id="cb2-53">  data_Q <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aggregate</span>(.<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>hour_of_day, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> data_Q, mean, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.action =</span> na.pass)</span>
<span id="cb2-54">  </span>
<span id="cb2-55">  data_Q <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> imputeTS<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">na_interpolation</span>(data_Q, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">option =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"linear"</span>)</span>
<span id="cb2-56">  </span>
<span id="cb2-57">  final_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> data_Q <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb2-58">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Adour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Pontonx-sur-l'Adour</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Aïcirits [St-Palais]</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> Artiguelouve <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> Escos <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">St-Pandelon</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>,</span>
<span id="cb2-59">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Date =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.POSIXct</span>(hour_of_day, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">tryFormats =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"%Y-%m-%d %H"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb2-60">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(Date, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Cambo-les-Bains</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>, Adour) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb2-61">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rename</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Nive =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Cambo-les-Bains</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>)</span>
<span id="cb2-62">  </span>
<span id="cb2-63">  Cur_flow <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Nive_c"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> final_data[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(final_data), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>],</span>
<span id="cb2-64">                         <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Adour_c"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> final_data[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(final_data), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>])</span>
<span id="cb2-65">  </span>
<span id="cb2-66">  </span>
<span id="cb2-67">  final_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cbind</span>(Cur_flow, final_data) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb2-68">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nest</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Ts_flow =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(Date, Nive, Adour)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb2-69">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Ts_flow =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(Ts_flow))</span>
<span id="cb2-70"></span>
<span id="cb2-71">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(final_data)</span>
<span id="cb2-72">}</span></code></pre></div>
</div>
</section>
<section id="shiny-application" class="level2">
<h2 class="anchored" data-anchor-id="shiny-application">Shiny application</h2>
<p>A simplified graph of the new application is showed below:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://aureliencallens.github.io/posts/2021-06-01-datascience-fishing-part3/images/graph_newapp.svg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Simplified workflow of the new version of application</figcaption>
</figure>
</div>
<section id="ui-side" class="level3">
<h3 class="anchored" data-anchor-id="ui-side">UI side</h3>
<p>The UI side did not change that much, I only removed the tab that displayed fishing data on a map because I wasn’t using this feature too much:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load libraries </span></span>
<span id="cb3-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(shiny)</span>
<span id="cb3-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(shinyWidgets)</span>
<span id="cb3-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(googlesheets)</span>
<span id="cb3-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(miniUI)</span>
<span id="cb3-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(leaflet)</span>
<span id="cb3-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(rdrop2)</span>
<span id="cb3-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Sys.setenv</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">TZ=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Europe/Paris"</span>)</span>
<span id="cb3-9"></span>
<span id="cb3-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#Import the functions for weather API and webscrapping </span></span>
<span id="cb3-11"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">suppressMessages</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">source</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"api_functions.R"</span>))</span>
<span id="cb3-12"></span>
<span id="cb3-13"></span>
<span id="cb3-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load the dropbox token : </span></span>
<span id="cb3-15">token <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">readRDS</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"token.rds"</span>)</span>
<span id="cb3-16"></span>
<span id="cb3-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Minipage for small screens</span></span>
<span id="cb3-18">ui <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">miniPage</span>(tags<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">script</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'$(document).ready(function () {</span></span>
<span id="cb3-19"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                           navigator.geolocation.getCurrentPosition(onSuccess, onError);</span></span>
<span id="cb3-20"></span>
<span id="cb3-21"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                           function onError (err) {</span></span>
<span id="cb3-22"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                           Shiny.onInputChange("geolocation", false);</span></span>
<span id="cb3-23"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                           }</span></span>
<span id="cb3-24"></span>
<span id="cb3-25"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                           function onSuccess (position) {</span></span>
<span id="cb3-26"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                           setTimeout(function () {</span></span>
<span id="cb3-27"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                           var coords = position.coords;</span></span>
<span id="cb3-28"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                           console.log(coords.latitude + ", " + coords.longitude);</span></span>
<span id="cb3-29"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                           Shiny.onInputChange("geolocation", true);</span></span>
<span id="cb3-30"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                           Shiny.onInputChange("lat", coords.latitude);</span></span>
<span id="cb3-31"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                           Shiny.onInputChange("long", coords.longitude);</span></span>
<span id="cb3-32"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                           }, 1100)</span></span>
<span id="cb3-33"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                           }</span></span>
<span id="cb3-34"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                           });'</span>),</span>
<span id="cb3-35">               </span>
<span id="cb3-36">               <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gadgetTitleBar</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Catch them all"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">left =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">right =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>),</span>
<span id="cb3-37">               </span>
<span id="cb3-38">               <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">miniTabstripPanel</span>(</span>
<span id="cb3-39">                 </span>
<span id="cb3-40">                 <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">miniTabPanel</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Session"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">icon =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">icon</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sliders"</span>),</span>
<span id="cb3-41">                              </span>
<span id="cb3-42">                              <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">miniContentPanel</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">uiOutput</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"UI_sess"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">align =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"center"</span>),</span>
<span id="cb3-43">                                               <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">uiOutput</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"UI"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">align =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"center"</span>))</span>
<span id="cb3-44">                              </span>
<span id="cb3-45">                 )</span>
<span id="cb3-46">               )</span>
<span id="cb3-47">               </span>
<span id="cb3-48">)</span></code></pre></div>
</div>
</section>
<section id="server-side" class="level3">
<h3 class="anchored" data-anchor-id="server-side">Server side</h3>
<p>Several changes were made in the server side to collect data about the lures I used. Now, each time I change my fishing lure, I fill a small form to collect the lure characteristics and it adds a line in a third csv file:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">server <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(input, output, session){</span>
<span id="cb4-2">  </span>
<span id="cb4-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">observeEvent</span>(input<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>go ,{</span>
<span id="cb4-4">    </span>
<span id="cb4-5">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Read the csv file containing information about fishing session. If a session is running,</span></span>
<span id="cb4-6">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># display the UI that allows the user to input data about the fish caught. If a session is not started,</span></span>
<span id="cb4-7">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># display a button to start the session and small survey on lure characteristics.</span></span>
<span id="cb4-8">    </span>
<span id="cb4-9">    dat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">drop_read_csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/app_peche/session1.csv"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">header =</span> T, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stringsAsFactors =</span> F, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dtoken =</span> token)</span>
<span id="cb4-10">    </span>
<span id="cb4-11">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Reactive UI</span></span>
<span id="cb4-12">    </span>
<span id="cb4-13">    output<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>UI <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">renderUI</span>({</span>
<span id="cb4-14">      </span>
<span id="cb4-15">      <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rev</span>(dat<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>End)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])){</span>
<span id="cb4-16">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># We now indicate what type of lure we use at the beginning of the session:</span></span>
<span id="cb4-17">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tagList</span>(</span>
<span id="cb4-18">          <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">selectInput</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lure1"</span>, </span>
<span id="cb4-19">                      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Type de leurre"</span>,</span>
<span id="cb4-20">                      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">choices =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Shad"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"shad"</span>,</span>
<span id="cb4-21">                                     <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Slug"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"slug"</span>,</span>
<span id="cb4-22">                                     <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Jerkbait"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"jerkbait"</span>,</span>
<span id="cb4-23">                                     <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Casting jig"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"jig"</span>,</span>
<span id="cb4-24">                                     <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Topwater"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"topwater"</span>),</span>
<span id="cb4-25">                      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">selected =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"shad"</span>,</span>
<span id="cb4-26">                      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">selectize =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>),</span>
<span id="cb4-27">          </span>
<span id="cb4-28">          <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">selectInput</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"color_lure1"</span>, </span>
<span id="cb4-29">                      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Couleur du leurre"</span>,</span>
<span id="cb4-30">                      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">choices =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Naturel"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"naturel"</span>,</span>
<span id="cb4-31">                                     <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sombre"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sombre"</span>,</span>
<span id="cb4-32">                                     <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Clair"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"clair"</span>,</span>
<span id="cb4-33">                                     <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Flashy"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"flashy"</span> ),</span>
<span id="cb4-34">                      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">selected =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"naturel"</span>,</span>
<span id="cb4-35">                      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">selectize =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>),</span>
<span id="cb4-36">          </span>
<span id="cb4-37">          <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">selectInput</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"length_lure1"</span>,</span>
<span id="cb4-38">                      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Taille du leurre"</span>,</span>
<span id="cb4-39">                      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">choices =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Petit"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"petit"</span>,</span>
<span id="cb4-40">                                     <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Moyen"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"moyen"</span>,</span>
<span id="cb4-41">                                     <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Grand"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grand"</span>),</span>
<span id="cb4-42">                      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">selected =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"petit"</span>,</span>
<span id="cb4-43">                      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">selectize =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>),</span>
<span id="cb4-44">          </span>
<span id="cb4-45">          <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">actionButton</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"go"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Commencer session !"</span>))</span>
<span id="cb4-46">      }<span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span>{</span>
<span id="cb4-47">        </span>
<span id="cb4-48">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tagList</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">actionButton</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"go"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"End session"</span>))</span>
<span id="cb4-49">      }</span>
<span id="cb4-50">      </span>
<span id="cb4-51">    })</span>
<span id="cb4-52">    </span>
<span id="cb4-53">    output<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>UI_sess <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">renderUI</span>({</span>
<span id="cb4-54">      </span>
<span id="cb4-55">      <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rev</span>(dat<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>End)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])){</span>
<span id="cb4-56">        </span>
<span id="cb4-57">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tagList</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">textInput</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"comments"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Commentaire avant le début?"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">value =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"NA"</span>))</span>
<span id="cb4-58">        </span>
<span id="cb4-59">      }<span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span>{</span>
<span id="cb4-60">        input<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>catch</span>
<span id="cb4-61">        input<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>lure</span>
<span id="cb4-62">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tagList</span>(</span>
<span id="cb4-63">          </span>
<span id="cb4-64">          <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">selectInput</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lure_type"</span>, </span>
<span id="cb4-65">                      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Type de leurre"</span>,</span>
<span id="cb4-66">                      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">choices =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Shad"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"shad"</span>,</span>
<span id="cb4-67">                                     <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Slug"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"slug"</span>,</span>
<span id="cb4-68">                                     <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Jerkbait"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"jerkbait"</span>,</span>
<span id="cb4-69">                                     <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Casting jig"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"jig"</span>,</span>
<span id="cb4-70">                                     <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Topwater"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"topwater"</span>),</span>
<span id="cb4-71">                      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">selected =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"shad"</span>,</span>
<span id="cb4-72">                      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">selectize =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>),</span>
<span id="cb4-73">          </span>
<span id="cb4-74">          <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">selectInput</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"color_lure"</span>, </span>
<span id="cb4-75">                      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Couleur du leurre"</span>,</span>
<span id="cb4-76">                      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">choices =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Naturel"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"naturel"</span>,</span>
<span id="cb4-77">                                     <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sombre"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sombre"</span>,</span>
<span id="cb4-78">                                     <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Clair"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"clair"</span>,</span>
<span id="cb4-79">                                     <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Flashy"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"flashy"</span> ),</span>
<span id="cb4-80">                      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">selected =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"naturel"</span>,</span>
<span id="cb4-81">                      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">selectize =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>),</span>
<span id="cb4-82">          </span>
<span id="cb4-83">          <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">selectInput</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"length_lure"</span>,</span>
<span id="cb4-84">                      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Taille du leurre"</span>,</span>
<span id="cb4-85">                      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">choices =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Petit"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"petit"</span>,</span>
<span id="cb4-86">                                     <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Moyen"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"moyen"</span>,</span>
<span id="cb4-87">                                     <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Grand"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grand"</span>),</span>
<span id="cb4-88">                      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">selected =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"petit"</span>,</span>
<span id="cb4-89">                      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">selectize =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>),</span>
<span id="cb4-90">          </span>
<span id="cb4-91">          <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">actionButton</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lure"</span>,</span>
<span id="cb4-92">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Changer de leurre!"</span>),</span>
<span id="cb4-93">          </span>
<span id="cb4-94">          <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">br</span>(), </span>
<span id="cb4-95">          <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">br</span>(), </span>
<span id="cb4-96">          </span>
<span id="cb4-97">          <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">h4</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Ajouter une capture"</span>),</span>
<span id="cb4-98">          </span>
<span id="cb4-99">          <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">selectInput</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"species"</span>, </span>
<span id="cb4-100">                      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Espèces"</span>,</span>
<span id="cb4-101">                      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">choices =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Bar"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bar"</span>,</span>
<span id="cb4-102">                                     <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Bar moucheté"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bar_m"</span>,</span>
<span id="cb4-103">                                     <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Alose"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"alose"</span>,</span>
<span id="cb4-104">                                     <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Maquereau"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"maquereau"</span>,</span>
<span id="cb4-105">                                     <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Chinchard"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"chinchard"</span>),</span>
<span id="cb4-106">                      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">selected =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bar"</span>),</span>
<span id="cb4-107">          </span>
<span id="cb4-108">          <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sliderInput</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"length"</span>,</span>
<span id="cb4-109">                      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Taille du poisson"</span>,</span>
<span id="cb4-110">                      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">value =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>, </span>
<span id="cb4-111">                      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">min =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, </span>
<span id="cb4-112">                      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">80</span>, </span>
<span id="cb4-113">                      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">step =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb4-114">          </span>
<span id="cb4-115">          <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">actionButton</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"catch"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Rajoutez cette capture aux stats!"</span>),</span>
<span id="cb4-116">          </span>
<span id="cb4-117">          <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">br</span>(), </span>
<span id="cb4-118">          <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">br</span>(), </span>
<span id="cb4-119">          </span>
<span id="cb4-120">          <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">textInput</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"comments1"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">h4</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Commentaire avant la fin ?"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">value =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"NA"</span>)</span>
<span id="cb4-121">        )</span>
<span id="cb4-122">      }</span>
<span id="cb4-123">    })</span>
<span id="cb4-124">  }, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ignoreNULL =</span> F)</span>
<span id="cb4-125">  </span>
<span id="cb4-126">  </span>
<span id="cb4-127">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#If the button is pushed, create the line to be added in the csv file. </span></span>
<span id="cb4-128">  </span>
<span id="cb4-129">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">observeEvent</span>(input<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>go,{</span>
<span id="cb4-130">    </span>
<span id="cb4-131">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Two outcomes depending if the session starts or ends. This gives the possibility </span></span>
<span id="cb4-132">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># to the user to add a comment before starting the session or after ending the session</span></span>
<span id="cb4-133">    </span>
<span id="cb4-134">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rev</span>(dat<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>End)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])){</span>
<span id="cb4-135">      </span>
<span id="cb4-136">      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#Tide + geoloc + Weather</span></span>
<span id="cb4-137">      c_tide <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tide</span>()</span>
<span id="cb4-138">      geoloc <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(input<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>lat,input<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>long)</span>
<span id="cb4-139">      current.weather.info <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">weather</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lat =</span> geoloc[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lon =</span> geoloc[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>])</span>
<span id="cb4-140">      river.flow <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">river_flow</span>()</span>
<span id="cb4-141">      </span>
<span id="cb4-142">      n_ses <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rev</span>(dat<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Session)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb4-143">      time_beg <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.character</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.POSIXct</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Sys.time</span>()))</span>
<span id="cb4-144">      comment <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> input<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>comments</span>
<span id="cb4-145">      dat.f <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cbind</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(n_ses,</span>
<span id="cb4-146">                                 time_beg,</span>
<span id="cb4-147">                                 <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>,</span>
<span id="cb4-148">                                 geoloc[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>],</span>
<span id="cb4-149">                                 geoloc[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]),</span>
<span id="cb4-150">                      current.weather.info,</span>
<span id="cb4-151">                      c_tide,</span>
<span id="cb4-152">                      river.flow,</span>
<span id="cb4-153">                      comment)</span>
<span id="cb4-154">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(dat.f) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(dat)</span>
<span id="cb4-155">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(dat.f)</span>
<span id="cb4-156">      final_dat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rbind</span>(dat, dat.f)</span>
<span id="cb4-157">      </span>
<span id="cb4-158">      lure <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">drop_read_csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/app_peche/lure.csv"</span>,</span>
<span id="cb4-159">                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">header =</span> T,</span>
<span id="cb4-160">                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stringsAsFactors =</span> F,</span>
<span id="cb4-161">                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dtoken =</span> token)</span>
<span id="cb4-162">      </span>
<span id="cb4-163">      new_lure <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n_ses =</span> n_ses,</span>
<span id="cb4-164">                             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">time =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.character</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.POSIXct</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Sys.time</span>())),</span>
<span id="cb4-165">                             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type_lure =</span> input<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>lure1,</span>
<span id="cb4-166">                             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color_lure =</span> input<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>color_lure1,</span>
<span id="cb4-167">                             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length_lure =</span> input<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>length_lure1)</span>
<span id="cb4-168">      </span>
<span id="cb4-169">      new_df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rbind</span>(lure, </span>
<span id="cb4-170">                      new_lure)</span>
<span id="cb4-171">      </span>
<span id="cb4-172">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">write_csv</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.data.frame</span>(new_df), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lure.csv"</span>)</span>
<span id="cb4-173">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">drop_upload</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lure.csv"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">path =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"App_peche"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mode =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"overwrite"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dtoken =</span> token)</span>
<span id="cb4-174">      </span>
<span id="cb4-175"></span>
<span id="cb4-176">    }<span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span>{</span>
<span id="cb4-177">      </span>
<span id="cb4-178">      dat<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>End[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(dat)] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.character</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.POSIXct</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Sys.time</span>()))</span>
<span id="cb4-179">      dat<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Comments[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(dat)] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(dat<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Comments[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(dat)], <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/"</span>, input<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>comments1)</span>
<span id="cb4-180">      final_dat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> dat </span>
<span id="cb4-181">    }</span>
<span id="cb4-182">    </span>
<span id="cb4-183">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Write csv in temporary files of shiny server </span></span>
<span id="cb4-184">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">write_csv</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.data.frame</span>(final_dat), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"session1.csv"</span>)</span>
<span id="cb4-185">    </span>
<span id="cb4-186">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Upload it to dropbox account </span></span>
<span id="cb4-187">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">drop_upload</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"session1.csv"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">path =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"App_peche"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mode =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"overwrite"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dtoken =</span> token)</span>
<span id="cb4-188">  })</span>
<span id="cb4-189">  </span>
<span id="cb4-190">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add a line to the catch csv file whenever a fish is caught</span></span>
<span id="cb4-191">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">observeEvent</span>(input<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>catch,{</span>
<span id="cb4-192">    caugth <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">drop_read_csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/app_peche/catch1.csv"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">header =</span> T, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stringsAsFactors =</span> F, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dtoken =</span> token)</span>
<span id="cb4-193">    </span>
<span id="cb4-194">    catch <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n_ses =</span> dat<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Session[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(dat)],</span>
<span id="cb4-195">                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">time =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.character</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.POSIXct</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Sys.time</span>())),</span>
<span id="cb4-196">                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">species =</span> input<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>species,</span>
<span id="cb4-197">                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length =</span> input<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>length)</span>
<span id="cb4-198">    </span>
<span id="cb4-199">    b <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rbind</span>(caugth,catch)</span>
<span id="cb4-200">    </span>
<span id="cb4-201">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">write_csv</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.data.frame</span>(b), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"catch1.csv"</span>)</span>
<span id="cb4-202">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">drop_upload</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"catch1.csv"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">path =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"App_peche"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mode =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"overwrite"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dtoken =</span> token)</span>
<span id="cb4-203">  })</span>
<span id="cb4-204">  </span>
<span id="cb4-205">  </span>
<span id="cb4-206">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">observeEvent</span>(input<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>lure,{</span>
<span id="cb4-207">    lure <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">drop_read_csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/app_peche/lure.csv"</span>,</span>
<span id="cb4-208">                          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">header =</span> T,</span>
<span id="cb4-209">                          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stringsAsFactors =</span> F,</span>
<span id="cb4-210">                          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dtoken =</span> token)</span>
<span id="cb4-211">    </span>
<span id="cb4-212">    new_lure <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n_ses =</span> dat<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Session[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(dat)],</span>
<span id="cb4-213">                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">time =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.character</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.POSIXct</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Sys.time</span>())),</span>
<span id="cb4-214">                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type_lure =</span> input<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>lure_type,</span>
<span id="cb4-215">                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color_lure =</span> input<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>color_lure,</span>
<span id="cb4-216">                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length_lure =</span> input<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>length_lure)</span>
<span id="cb4-217">    </span>
<span id="cb4-218">    new_df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rbind</span>(lure, </span>
<span id="cb4-219">               new_lure)</span>
<span id="cb4-220">    </span>
<span id="cb4-221">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">write_csv</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.data.frame</span>(new_df), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lure.csv"</span>)</span>
<span id="cb4-222">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">drop_upload</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lure.csv"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">path =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"App_peche"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mode =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"overwrite"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dtoken =</span> token)</span>
<span id="cb4-223">  })</span>
<span id="cb4-224">}</span></code></pre></div>
</div>
</section>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p>I have tested this new application during two fishing sessions and it has been working like a charm. I can’t wait to present you my findings at the end of this fishing season !</p>


</section>

<a onclick="window.scrollTo(0, 0); return false;" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a> ]]></description>
  <category>R</category>
  <category>Shiny</category>
  <category>Web scraping</category>
  <guid>https://aureliencallens.github.io/posts/2021-06-01-datascience-fishing-part3/index.html</guid>
  <pubDate>Mon, 31 May 2021 22:00:00 GMT</pubDate>
</item>
<item>
  <title>Coastal risks and statistical learning: Analyzing Google trends with gtrendsR package</title>
  <dc:creator>Aurélien Callens</dc:creator>
  <link>https://aureliencallens.github.io/posts/2021-03-03-coastal-risks-google-trends-r/index.html</link>
  <description><![CDATA[ 




<p>I am currently in the third year of my PhD and it is time for me to synthesize all the work I have done by writing my thesis. One important step is the introduction which presents the general context and the contributions of my thesis in the research world. For my introduction, I decided to include the Google trend analysis of specific terms related to my PhD subject. For information, the aim of my PhD is to demonstrate the potential contributions of statistical learning methods in the study of coastal risks.</p>
<p>In this post, we are going to use the R package <code>gtrendsR</code> to analyze the trends of specific words related to statistical learning such as “machine learning” or “data science” and also related to coastal risks: “coastal flood”, “storm surge”.</p>
<section id="analysis-of-specific-terms-for-the-whole-world" class="level2">
<h2 class="anchored" data-anchor-id="analysis-of-specific-terms-for-the-whole-world">Analysis of specific terms for the whole world</h2>
<p>In this first section, we are going to analyze the interest over time for several terms in the whole world. The <code>gtrends</code> function extracts the “hits” variable for a given term. This variable is a normalized measure of the interest made by Google Trends. The number of search is normalized by geography and time range, then the resulting numbers are scaled on a range of 0 to 100 based on a topic’s proportion to all searches on all topics. All the details are given in the support of Google Trends (<a href="https://support.google.com/trends/answer/4365533?hl=en" target="_blank">here</a>).</p>
<p>We can look at the interest over time for “data science”, “deep learning” and “machine learning”:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(gtrendsR)</span>
<span id="cb1-3"></span>
<span id="cb1-4">words_stats <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"machine learning"</span>,</span>
<span id="cb1-5">           <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"deep learning"</span>,</span>
<span id="cb1-6">           <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data science"</span>)</span>
<span id="cb1-7"></span>
<span id="cb1-8">res_stats <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lapply</span>(words_stats, <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(x){</span>
<span id="cb1-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gtrends</span>(x,</span>
<span id="cb1-10">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geo =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>,</span>
<span id="cb1-11">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">time =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"all"</span>)})</span>
<span id="cb1-12"></span>
<span id="cb1-13"></span>
<span id="cb1-14">interest_stats <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">do.call</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"rbind"</span>, </span>
<span id="cb1-15">                    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lapply</span>(res_stats, <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(x){x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>interest_over_time}))</span>
<span id="cb1-16"></span>
<span id="cb1-17">interest_stats <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(hits <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;1"</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, hits))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> date, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> hits)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb1-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb1-21">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_grid</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> keyword) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_bw</span>()</span></code></pre></div>
</details>
<div class="cell-output-display">
<p><img src="https://aureliencallens.github.io/posts/2021-03-03-coastal-risks-google-trends-r/index_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>From this figure, we see the increasing interest for these terms over the last decade.</p>
<p>We can do the same for terms related to coastal risks :</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1">words_coastal <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"coastal risk"</span>,</span>
<span id="cb2-2">                   <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"coastal flood"</span>,</span>
<span id="cb2-3">                   <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"storm surge"</span>)</span>
<span id="cb2-4"></span>
<span id="cb2-5"></span>
<span id="cb2-6">res_coast <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lapply</span>(words_coastal, <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(x){</span>
<span id="cb2-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gtrends</span>(x,</span>
<span id="cb2-8">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geo =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>,</span>
<span id="cb2-9">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">time =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"all"</span>)})</span>
<span id="cb2-10"></span>
<span id="cb2-11"></span>
<span id="cb2-12">interest_coast <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">do.call</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"rbind"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lapply</span>(res_coast, <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(x){x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>interest_over_time}))</span>
<span id="cb2-13"></span>
<span id="cb2-14">interest_coast <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb2-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(hits <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;1"</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, hits))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb2-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> date, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> hits)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb2-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb2-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_grid</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> keyword) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_bw</span>()</span></code></pre></div>
</details>
<div class="cell-output-display">
<p><img src="https://aureliencallens.github.io/posts/2021-03-03-coastal-risks-google-trends-r/index_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Contrary to the interest for the statistical terms, the interest in terms related to coastal risk is more punctual. One of my hypothesis is that the interest in these topic increases after a large storm event has occurred in the world. We will investigate on this hypothesis at the end of the post.</p>
</section>
<section id="mapping-the-interest-of-storm-surge-and-data-science-in-the-world" class="level2">
<h2 class="anchored" data-anchor-id="mapping-the-interest-of-storm-surge-and-data-science-in-the-world">Mapping the interest of “storm surge” and “data science” in the world</h2>
<p>In addition to analyze the trend over time with <code>gtrendsR</code>, we can also visualize the interest depending on the countries.</p>
<p>Let’s start with “storm surge”:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">res_world <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gtrends</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Storm surge"</span>,</span>
<span id="cb3-2">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geo =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>,</span>
<span id="cb3-3">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">time =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"all"</span>)</span>
<span id="cb3-4"></span>
<span id="cb3-5"></span>
<span id="cb3-6">Int_country <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_tibble</span>(res_world<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>interest_by_country)</span>
<span id="cb3-7"></span>
<span id="cb3-8">Int_country <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> Int_country <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb3-9">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rename</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">region =</span> location)</span>
<span id="cb3-10"></span>
<span id="cb3-11">WolrdMap <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> ggplot2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">map_data</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">map =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"world"</span>)</span>
<span id="cb3-12"></span>
<span id="cb3-13"></span>
<span id="cb3-14">Int_Merged <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> Int_country <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb3-15">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">full_join</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> ., </span>
<span id="cb3-16">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> WolrdMap , </span>
<span id="cb3-17">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"region"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb3-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(hits))</span>
<span id="cb3-19"></span>
<span id="cb3-20"></span>
<span id="cb3-21">Int_Merged <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb3-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> long, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> lat)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-23">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_polygon</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group =</span> group, </span>
<span id="cb3-24">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> hits), </span>
<span id="cb3-25">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey40"</span>,</span>
<span id="cb3-26">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-27">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_gradientn</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colors =</span> RColorBrewer<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">brewer.pal</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"OrRd"</span>),</span>
<span id="cb3-28">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.value =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-29">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_cartesian</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">55</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">85</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb3-30">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bottom"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-31">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_bw</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb3-32">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb3-33">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid.major =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_line</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>),</span>
<span id="cb3-34">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid.minor =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>()) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-35">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<p><img src="https://aureliencallens.github.io/posts/2021-03-03-coastal-risks-google-trends-r/index_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We see from this map that the number of Google searches for this term is quite low for many countries in comparison with other terms (white color means not enough search comparing to the total number of search). In general the interest is higher in countries that are more likely to be impacted by marine storms or hurricanes. The Republic of Philippines seems the most interested country in storm surge.</p>
<p>We can then continue with the term “data science”:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">res_world <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gtrends</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Data Science"</span>,</span>
<span id="cb4-2">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geo =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>,</span>
<span id="cb4-3">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">time =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"all"</span>)</span>
<span id="cb4-4"></span>
<span id="cb4-5"></span>
<span id="cb4-6">Int_country <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_tibble</span>(res_world<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>interest_by_country)</span>
<span id="cb4-7"></span>
<span id="cb4-8">Int_country <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> Int_country <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb4-9">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rename</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">region =</span> location)</span>
<span id="cb4-10"></span>
<span id="cb4-11">WolrdMap <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> ggplot2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">map_data</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">map =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"world"</span>)</span>
<span id="cb4-12"></span>
<span id="cb4-13"></span>
<span id="cb4-14">Int_Merged <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> Int_country <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb4-15">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">full_join</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> ., </span>
<span id="cb4-16">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> WolrdMap , </span>
<span id="cb4-17">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"region"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb4-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(hits))</span>
<span id="cb4-19"></span>
<span id="cb4-20"></span>
<span id="cb4-21">Int_Merged <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb4-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> long, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> lat)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-23">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_polygon</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group =</span> group, </span>
<span id="cb4-24">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> hits), </span>
<span id="cb4-25">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey40"</span>,</span>
<span id="cb4-26">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-27">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_gradientn</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colors =</span> RColorBrewer<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">brewer.pal</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"OrRd"</span>),</span>
<span id="cb4-28">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.value =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-29">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_cartesian</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">55</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">85</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb4-30">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bottom"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-31">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_bw</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb4-32">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb4-33">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid.major =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_line</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>),</span>
<span id="cb4-34">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid.minor =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>()) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-35">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<p><img src="https://aureliencallens.github.io/posts/2021-03-03-coastal-risks-google-trends-r/index_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Much more countries are interested by this topic with India being the country with the highest number of Google searchs about data science.</p>
</section>
<section id="focusing-on-the-trend-of-storm-surge-in-france" class="level2">
<h2 class="anchored" data-anchor-id="focusing-on-the-trend-of-storm-surge-in-france">Focusing on the trend of “storm surge” in France</h2>
<p>Earlier in this post, I made the hypothesis that the number of Google search for terms like “storm surge” was related to the recent occurrence of a storm event. Let’s investigate this hypothesis for the term “Submersion marine” (marine submersion/ flood in English) in France.</p>
<p>First, we extract the number of hits on this term for France by indicating <code>geo = "FR"</code> in the <code>gtrends</code> function. Then we create a data frame where we gather some severe storms that impacted France (<a href="http://tempetes.meteo.fr/" target="_blank">Website listing the severe storms in France</a>). Finally, we join all the information on the same graph (red dashed lines represent storm events):</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">res_fr <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gtrends</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"submersion marine"</span>,</span>
<span id="cb5-2">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geo =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FR"</span>,</span>
<span id="cb5-3">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">time =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"all"</span>)</span>
<span id="cb5-4"></span>
<span id="cb5-5">df_storm <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.data.frame</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">matrix</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(</span>
<span id="cb5-6">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2009-01-24 GMT"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Klaus"</span>,</span>
<span id="cb5-7">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2010-02-27 GMT"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Xynthia"</span>,</span>
<span id="cb5-8">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2011-12-16 GMT"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Joachim"</span>,</span>
<span id="cb5-9">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2014-02-14 GMT"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Ulla"</span>,</span>
<span id="cb5-10">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2014-11-04 GMT"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Qendresa"</span>,</span>
<span id="cb5-11">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2016-02-10 GMT"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"No name"</span>,</span>
<span id="cb5-12">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2017-03-06 GMT"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Zeus"</span>,</span>
<span id="cb5-13">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2018-01-03 GMT"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Eleanor"</span>,</span>
<span id="cb5-14">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2019-12-13 GMT"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"No name"</span></span>
<span id="cb5-15">  ), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncol =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">byrow =</span> T), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stringsAsFactors =</span> F)</span>
<span id="cb5-16"></span>
<span id="cb5-17"></span>
<span id="cb5-18"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(df_storm) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"date"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Name of storm"</span>)</span>
<span id="cb5-19">df_storm<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>date <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.POSIXct</span>(df_storm<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>date, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">tz =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"GMT"</span>)</span>
<span id="cb5-20"></span>
<span id="cb5-21"></span>
<span id="cb5-22">res_fr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>interest_over_time <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb5-23">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(hits <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;1"</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, hits))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb5-24">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(date <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.POSIXct</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2006-01-24 GMT"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">tz =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"GMT"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb5-25">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> date, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> hits)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb5-26">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-27">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_vline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xintercept =</span> df_storm<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>date, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lty =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lwd =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb5-28">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_label</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span>date, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">38</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length.out=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(df_storm)), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Name of storm</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> df_storm) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-29">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#geom_vline(xintercept = as.POSIXct("2011-07-11 GMT", tz = "GMT"), col = "blue", lty = 2, alpha = 0.5) + </span></span>
<span id="cb5-30">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_grid</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> keyword) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-31">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_bw</span>()</span></code></pre></div>
</details>
<div class="cell-output-display">
<p><img src="https://aureliencallens.github.io/posts/2021-03-03-coastal-risks-google-trends-r/index_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>From this figure, we can see that after a storm event there is often a surge in interest in the term “marine submersion” in France. This confirms my hypothesis !</p>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p>This analysis was really interesting for me as it confirmed what I knew with numbers and graphs. Without a doubt, this analysis will be a great asset for my introduction, especially in the part where I will discuss about the growing interest in data science. I hope this post gave you the envy to reproduce this analysis for the terms of your choice !</p>


<!-- -->

</section>

<a onclick="window.scrollTo(0, 0); return false;" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a> ]]></description>
  <category>R</category>
  <category>EDA</category>
  <guid>https://aureliencallens.github.io/posts/2021-03-03-coastal-risks-google-trends-r/index.html</guid>
  <pubDate>Tue, 02 Mar 2021 23:00:00 GMT</pubDate>
</item>
<item>
  <title>Webscraping Aliexpress with Rselenium</title>
  <dc:creator>Aurelien Callens</dc:creator>
  <link>https://aureliencallens.github.io/posts/2020-11-18-webscraping-aliexpress-rselenium/index.html</link>
  <description><![CDATA[ 




<p>Today, I am going to show you how to scrape product prices from Aliexpress website.</p>
<section id="a-few-words-on-web-scraping" class="level2">
<h2 class="anchored" data-anchor-id="a-few-words-on-web-scraping">A few words on web scraping</h2>
<p>Before diving into the subject, you should be aware that web scraping is not allowed on certain websites. To know if it is the case for the website you want to scrape, I invit you to check the <em>robots.txt</em> page which should be located at the root of the website address. For Aliexpress this page is located here : <a href="https://www.aliexpress.com/robots.txt" target="_blank">www.aliexpress.com/robots.txt .</a></p>
<p>This page indicates that webscrapping and crawling are not allowed on several page categories such as <code>/bin/*</code>, <code>/search/*</code>, <code>/wholesale*</code> for example. Fortunately for us, the <code>/item/*</code> category, where the product pages are stored, can be scraped.</p>
</section>
<section id="rselenium" class="level2">
<h2 class="anchored" data-anchor-id="rselenium">RSelenium</h2>
<section id="installation-for-ubuntu-18.04-lts" class="level3">
<h3 class="anchored" data-anchor-id="installation-for-ubuntu-18.04-lts">Installation for Ubuntu 18.04 LTS</h3>
<p>The installation for RSelenium was not as easy as expected and I encountered two errors.</p>
<p>The first error I got after I installed the package and tried the function <em>Rsdriver</em> was :</p>
<pre><code>Error in curl::curl_fetch_disk(url, x$path, handle = handle) :
Unrecognized content encoding type. libcurl understands deflate, gzip content encodings.</code></pre>
<p>Thanks to <a href="https://github.com/ropensci/RSelenium/issues/186" target="_blank">this post</a>, I installed the missing package : <em>stringi</em>.</p>
<p>Once this error was addressed, I had a different one :</p>
<pre><code>Error: Invalid or corrupt jarfile /home/aurelien/.local/share/binman_seleniumserver/generic/4.0.0-alpha-2/selenium-server-standalone-4.0.0-alpha-2.jar</code></pre>
<p>This time the problem came from a corrupted file. Thanks to <a href="https://stackoverflow.com/questions/20680229/invalid-or-corrupt-jarfile-usr-local-bin-selenium-server-standalone-2-38-0-jar" target="_blank">this post</a>, I knew that I just had to download this file <em>selenium-server-standalone-4.0.0-alpha-2.jar</em> from the official <a href="https://selenium-release.storage.googleapis.com/index.html?path=4.0/" target="_blank">selenium website</a> and replace the corrupted file with it.</p>
<p>I hope this will help some of you to install RSelenium with Ubuntu 18.04 LTS !</p>
</section>
<section id="opening-a-web-browser" class="level3">
<h3 class="anchored" data-anchor-id="opening-a-web-browser">Opening a web browser</h3>
<p>After addressing the errors above, I can now open a firefox browser :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(RSelenium)</span>
<span id="cb3-2"></span>
<span id="cb3-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#Open a firefox driver</span></span>
<span id="cb3-4">rD <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rsDriver</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">browser =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"firefox"</span>) </span>
<span id="cb3-5">remDr <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> rD[[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"client"</span>]]</span></code></pre></div>
</div>
</section>
<section id="logging-in-aliexpress" class="level3">
<h3 class="anchored" data-anchor-id="logging-in-aliexpress">Logging in Aliexpress</h3>
<p>The first step to scrape product prices on Aliexpress is to log in into your account:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">log_id <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Your_mail_adress"</span></span>
<span id="cb4-2">password <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Your_password"</span></span>
<span id="cb4-3"></span>
<span id="cb4-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Navigate to aliexpress login page </span></span>
<span id="cb4-5">remDr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">navigate</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://login.aliexpress.com/"</span>)</span>
<span id="cb4-6"></span>
<span id="cb4-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Fill the form with mail address</span></span>
<span id="cb4-8">remDr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">findElement</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">using =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"id"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fm-login-id"</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sendKeysToElement</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(log_id))</span>
<span id="cb4-9"></span>
<span id="cb4-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Fill the form with password</span></span>
<span id="cb4-11">remDr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">findElement</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">using =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'id'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fm-login-password"</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sendKeysToElement</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(password))</span>
<span id="cb4-12"></span>
<span id="cb4-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#Submit the login form by clicking Submit button</span></span>
<span id="cb4-14">remDr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">findElement</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"class"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fm-button"</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">clickElement</span>()</span></code></pre></div>
</div>
</section>
<section id="navigating-through-the-urls-and-scraping-the-prices" class="level3">
<h3 class="anchored" data-anchor-id="navigating-through-the-urls-and-scraping-the-prices">Navigating through the URLs and scraping the prices</h3>
<p>Now we have to navigate through a vector containing the URL of the aliexpress products we are interested in. Then we extract the price of the product by using the xpath of the product price of the webpage. The xpath of the element you want to scrape can be found by using the developer tool of chrome or firefox ( <a href="https://www.scrapingbee.com/blog/practical-xpath-for-web-scraping/">tutorial here !</a> ). Once the price is extracted we have to ensure this price is in numerical format by removing any special character (euro or dollar sign) and replace the comma by a point for the decimal separator. Here is the R code:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">  url_list <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://fr.aliexpress.com/store/product/Maxcatch-6Pcs-lot-Craws-Soft-Fishing-Lures-110mm-11-5g-Artificial-Bait-Soft-Bait-Craws-Lures/406467_32419930548.html?spm=a2g0w.12010612.0.0.5deb64f7836LnZ"</span>,</span>
<span id="cb5-2">            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://fr.aliexpress.com/store/product/Maxcatch-Fishing-Lure-5Pcs-Lot-155mm-7-4g-3-colors-Swimbait-Artificial-Lizard-Soft-Fishing-Lures/406467_32613648610.html?spm=a2g0w.12010612.0.0.5deb64f7836LnZ"</span>,</span>
<span id="cb5-3">            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://fr.aliexpress.com/store/product/Maxcatch-6Pcs-lot-Soft-Fishing-Lures-Minnow-Biat-95mm-6g-Jerkbait-Soft-Bait/406467_32419066106.html?spm=a2g0w.12010612.0.0.25fe5872CBqy0m"</span>) </span>
<span id="cb5-4"></span>
<span id="cb5-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Allocate a vector to store the price of the products </span></span>
<span id="cb5-6">currentp <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>()</span>
<span id="cb5-7"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span>(i <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(url_list)){</span>
<span id="cb5-8">  </span>
<span id="cb5-9">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Navigate to link [i]</span></span>
<span id="cb5-10">  remDr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">navigate</span>(url_list[i])</span>
<span id="cb5-11">  </span>
<span id="cb5-12">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Find the price with an xpath selector and findElement.  </span></span>
<span id="cb5-13">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Sometimes products can be removed and this could throw an error this is why we are using 'try' to handle the potential errors</span></span>
<span id="cb5-14">  </span>
<span id="cb5-15">  current <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">try</span>(remDr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">findElement</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">using =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"xpath"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'//*[contains(concat( " ", @class, " " ), concat( " ", "product-price-value", " " ))]'</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">silent =</span> T)</span>
<span id="cb5-16">  </span>
<span id="cb5-17">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#If error : current price is NA </span></span>
<span id="cb5-18">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">class</span>(current) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'try-error'</span>){</span>
<span id="cb5-19">    currentp[i] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span></span>
<span id="cb5-20">  }<span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span>{</span>
<span id="cb5-21">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get the price </span></span>
<span id="cb5-22">    text <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unlist</span>(current<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">getElementText</span>())</span>
<span id="cb5-23">    </span>
<span id="cb5-24">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#Remove euro sign</span></span>
<span id="cb5-25">    text <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gsub</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"[^A-Za-z0-9,;._-]"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>,text)</span>
<span id="cb5-26">    </span>
<span id="cb5-27">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#Case when there is a range of price instead of one price + replace comma by point</span></span>
<span id="cb5-28">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grepl</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-"</span>, text)) {  </span>
<span id="cb5-29">      pe <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sub</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-.*"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>,text) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sub</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">","</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"."</span>, ., <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fixed =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb5-30">      currentp[i] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(pe)</span>
<span id="cb5-31">    }<span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span>{</span>
<span id="cb5-32">      currentp[i] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sub</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">","</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"."</span>, text, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fixed =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>))</span>
<span id="cb5-33">  }</span>
<span id="cb5-34">  }</span>
<span id="cb5-35">  </span>
<span id="cb5-36"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Sys.sleep</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)</span>
<span id="cb5-37">}</span></code></pre></div>
</div>
<p>Between each link it is advised to wait a few seconds with <em>Sys.sleep(4)</em> to avoid being black-listed by the website.</p>
</section>
<section id="phantomjs-version" class="level3">
<h3 class="anchored" data-anchor-id="phantomjs-version">Phantomjs version</h3>
<p>If you execute the code above, you should see a firefox browser open and navigate through the list you provided. In case you don’t want an active window, you can replace firefox by phantomjs browser which is a headless browser (without a window).</p>
<p>I don’t know why but using <code>rsDriver(browser = "phantomjs")</code> does not work for me. I found <a href="https://cbelanger.netlify.app/post/web-scraping-in-r-selenium-firefox-and-phantomjs/" target="_blank">this post</a> which propose to start the phantomjs browser with the wdman package:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(wdman)</span>
<span id="cb6-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(RSelenium)</span>
<span id="cb6-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># start phantomjs instance</span></span>
<span id="cb6-4">rPJS <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> wdman<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">phantomjs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">port =</span> 4680L)</span>
<span id="cb6-5"></span>
<span id="cb6-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># is it alive?</span></span>
<span id="cb6-7">rPJS<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>process<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is_alive</span>()</span>
<span id="cb6-8"></span>
<span id="cb6-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#connect selenium to it?</span></span>
<span id="cb6-10">remDr <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span>  RSelenium<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">remoteDriver</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">browserName=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"phantomjs"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">port=</span>4680L)</span>
<span id="cb6-11"></span>
<span id="cb6-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># open a browser</span></span>
<span id="cb6-13">remDr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">open</span>()</span>
<span id="cb6-14"></span>
<span id="cb6-15">remDr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">navigate</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"http://www.google.com/"</span>)</span>
<span id="cb6-16"></span>
<span id="cb6-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Screenshot of the headless browser to check if everything is working</span></span>
<span id="cb6-18">remDr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">screenshot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">display =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb6-19"></span>
<span id="cb6-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Don't forget to close the browser when you are finished ! </span></span>
<span id="cb6-21">remDr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">close</span>()</span></code></pre></div>
</div>
</section>
<section id="conclusion" class="level3">
<h3 class="anchored" data-anchor-id="conclusion">Conclusion</h3>
<p>Once you have understand the basics of RSelenium and how to select elements inside HTML pages, it is really easy to write a script to scrape data on the web. This post was a short example to scrape the product price on Aliexpress pages but the script can be extended to scrape more data on each page such as the name of the item, its rating etc… It is even possible to automate this script to run daily in order to see price changes over time. As you see possibilities are endless!</p>


</section>
</section>

<a onclick="window.scrollTo(0, 0); return false;" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a> ]]></description>
  <category>R</category>
  <category>Web scraping</category>
  <guid>https://aureliencallens.github.io/posts/2020-11-18-webscraping-aliexpress-rselenium/index.html</guid>
  <pubDate>Tue, 17 Nov 2020 23:00:00 GMT</pubDate>
</item>
<item>
  <title>Can R and Shiny make me a better fisherman? Part 2</title>
  <dc:creator>Aurélien Callens</dc:creator>
  <link>https://aureliencallens.github.io/posts/2020-09-25-datascience-fishing-part2/index.html</link>
  <description><![CDATA[ 




<p>In the previous blog article, I described in details how I built a shiny application that stores data about my fishing sessions. In this post, I will explore the data I have collected during the last year.</p>
<p>To sum up, my application store the data in two csv files. The first one contains variables related to the fishing conditions at the beginning and at the end of the session such as :</p>
<ul>
<li>Time</li>
<li>Longitude and Latitude</li>
<li>Meteorological conditions (9 in total : Air temperature, Atmospheric pressure, Wind speed and direction …)</li>
<li>Tide conditions (Current water level, Tide status and Time since the tide peak)</li>
<li>Specific comments</li>
</ul>
<p>The second one contains information about my catches :</p>
<ul>
<li>Time when caught</li>
<li>Time since the beginning of the session</li>
<li>Species</li>
<li>Length of the fish</li>
<li>Fishing lure used</li>
<li>Color of the fishing lure</li>
<li>Length of the lure</li>
</ul>
<section id="importing-and-cleaning-my-fishing-data" class="level2">
<h2 class="anchored" data-anchor-id="importing-and-cleaning-my-fishing-data">Importing and cleaning my fishing data</h2>
<p>The first step of this analysis is to import both csv files and make some transformations.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Change character variables to factor</span></span>
<span id="cb1-2">session_data <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&lt;&gt;%</span> </span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate_at</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vars</span>(Weather, Tide_status), as.factor)</span>
<span id="cb1-4"></span>
<span id="cb1-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Change character variables to factor</span></span>
<span id="cb1-6">catch_data <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&lt;&gt;%</span> </span>
<span id="cb1-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate_at</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vars</span>(species, lure, colour, length_lure), as.factor)</span></code></pre></div>
</details>
</div>
<p>&nbsp;</p>
<p>After cleaning and rearranging the data (code hidden below), we are ready to explore graphically our data!</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Compute mean conditions (between beg and end session) </span></span>
<span id="cb2-2"></span>
<span id="cb2-3">mean_weather_cond <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> session_data <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb2-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(Session) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb2-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(Long, Lat, Water_level, Tide_time)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb2-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise_if</span>(is.numeric, mean) </span>
<span id="cb2-7"></span>
<span id="cb2-8"></span>
<span id="cb2-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extract fixed conditions and comments + join with mean cond </span></span>
<span id="cb2-10"></span>
<span id="cb2-11">fixed_cond_com <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> session_data <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb2-12"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(Session) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb2-13"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(Session, Comments, Long, Lat, Weather) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb2-14"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Comments_parsed =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">na.omit</span>(Comments), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">collapse =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb2-15"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>Comments) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb2-16"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">slice</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb2-17"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">inner_join</span>(mean_weather_cond, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Session"</span>)</span>
<span id="cb2-18"></span>
<span id="cb2-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create end and beg variables for WL, Time , Tide_time, Tide_status</span></span>
<span id="cb2-20"></span>
<span id="cb2-21">beg_end_vars <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> session_data <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb2-22"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(Session, Status, Water_level, Time, Tide_time, Tide_status) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb2-23"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_wider</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_from =</span> Status,</span>
<span id="cb2-24"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_from =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(Time, Water_level,  Tide_time, Tide_status))</span>
<span id="cb2-25"></span>
<span id="cb2-26"></span>
<span id="cb2-27"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Assemble both file and calculate duration</span></span>
<span id="cb2-28"></span>
<span id="cb2-29">dat_ses <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">inner_join</span>(beg_end_vars,</span>
<span id="cb2-30">fixed_cond_com,</span>
<span id="cb2-31"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Session"</span>)</span>
<span id="cb2-32"></span>
<span id="cb2-33"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculate duration of the sessions</span></span>
<span id="cb2-34"></span>
<span id="cb2-35">dat_ses <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&lt;&gt;%</span> </span>
<span id="cb2-36"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">duration =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">difftime</span>(Time_end,  Time_beg,  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">units =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"hours"</span>),</span>
<span id="cb2-37"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>))</span>
<span id="cb2-38"></span>
<span id="cb2-39">catch_cond <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">full_join</span>(dat_ses,</span>
<span id="cb2-40">catch_data, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>( <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Session"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"n_ses"</span> )) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb2-41"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Session =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">factor</span>(Session, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">levels =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(dat_ses<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Session)))</span>
<span id="cb2-42"></span>
<span id="cb2-43">catch_cond <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&lt;&gt;%</span></span>
<span id="cb2-44"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Tide_status_ses =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(Tide_status_beg, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_"</span>, Tide_status_end))</span>
<span id="cb2-45"></span>
<span id="cb2-46"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Simplify the Tide status variable</span></span>
<span id="cb2-47"></span>
<span id="cb2-48">catch_cond<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Tide_status_ses <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sapply</span>(catch_cond<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Tide_status_ses , <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(x){<span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">switch</span>(x, </span>
<span id="cb2-49"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Up_Dead"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Up"</span>,</span>
<span id="cb2-50"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Up_Up"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Up"</span>,</span>
<span id="cb2-51"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Up_Down"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Dead"</span>,</span>
<span id="cb2-52"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Down_Dead"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Down"</span>,</span>
<span id="cb2-53"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Down_Up"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Dead"</span>,</span>
<span id="cb2-54"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Down_Down"</span>  <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Down"</span>,</span>
<span id="cb2-55"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Dead_Dead"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Dead"</span>,</span>
<span id="cb2-56"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Dead_Up"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Up"</span>,</span>
<span id="cb2-57"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Dead_Down"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Down"</span></span>
<span id="cb2-58">)}, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">USE.NAMES =</span> F)</span></code></pre></div>
</details>
</div>
</section>
<section id="graphical-exploration" class="level2">
<h2 class="anchored" data-anchor-id="graphical-exploration">Graphical exploration</h2>
<section id="where-did-i-fish" class="level3">
<h3 class="anchored" data-anchor-id="where-did-i-fish">Where did I fish ?</h3>
<p>We can visualize the locations I fished the most by using the <em>leaflet</em> package:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculate the number of fish caught by session </span></span>
<span id="cb3-2">fish_number <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span>  catch_cond  <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">na.omit</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(Session) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nb =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(Session))</span>
<span id="cb3-3"></span>
<span id="cb3-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Dataframe with variables we want to show on the map</span></span>
<span id="cb3-5">map_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> catch_cond <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb3-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(Session) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(Session, Time_beg, Time_end, Long,</span>
<span id="cb3-8">Lat, Water_level_beg, Tide_status_beg, Tide_time_beg, duration) </span>
<span id="cb3-9"></span>
<span id="cb3-10">map_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">full_join</span>(map_data, fish_number)</span>
<span id="cb3-11"></span>
<span id="cb3-12">map_data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>nb[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(map_data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>nb)] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb3-13"></span>
<span id="cb3-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Interactive map with Popup for each session</span></span>
<span id="cb3-15"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(leaflet)</span>
<span id="cb3-16"></span>
<span id="cb3-17"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">leaflet</span>(map_data, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"100%"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">addTiles</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-18"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">addPopups</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lng =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>Long, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lat =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>Lat, </span>
<span id="cb3-19"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">with</span>(map_data, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sprintf</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;b&gt;Session %.0f : %.1f h&lt;/b&gt; &lt;br/&gt; %s &lt;br/&gt; %.0f  fish &lt;br/&gt; Water level: %.0f m, %s, %.0f min since last peak"</span>,                                         Session, duration,  Time_beg, nb, Water_level_beg, Tide_status_beg, Tide_time_beg)), </span>
<span id="cb3-20"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">options =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">popupOptions</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">maxWidth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">minWidth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>))</span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="htmlwidget-12a4ef9bdc585990d0ef" style="width:100%;height:480px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-12a4ef9bdc585990d0ef">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"https://openstreetmap.org/copyright/\">OpenStreetMap<\/a>,  <a href=\"https://opendatacommons.org/licenses/odbl/\">ODbL<\/a>"}]},{"method":"addPopups","args":[[43.4903501,43.4903501,43.4903501,43.4948349,43.4948349,43.4948349,43.4948349,43.4948349,43.4929536,43.4929536,43.4717306,43.4856133,43.4856133,43.4898314,43.4879548,43.4891374,43.4888454,43.4903375,43.4907003,43.4883211,43.4870525,43.4882129,43.4902466,43.4879819,43.4879819,43.489656,43.4667765,43.4854263,43.4888221,43.4884741,43.4854276,43.4854276,43.4854276,43.490646,43.490646,43.490646,43.4884784,43.4891888,43.4885291,43.4885291,43.4849954,43.4849954,43.4849954,43.4853693,43.4865331,43.4853571,43.4881548,43.4865984,43.4895741,43.4831239,43.4831239,43.4831239,43.4831239,43.4831239,43.4831239,43.4831239,43.484568,43.484568,43.484568,43.484568,43.484568,43.4893757,43.4893757,43.4893757,43.4893757,43.4893757,43.4893757,43.4893757,43.4893757,43.4893757,43.4893757,43.4893757,43.4893757,43.4850086,43.4850086,43.4850086,43.488591,43.488659,43.4833471],[-1.474845,-1.474845,-1.474845,-1.4702738,-1.4702738,-1.4702738,-1.4702738,-1.4702738,-1.4727054,-1.4727054,-1.4726262,-1.4762295,-1.4762295,-1.4645089,-1.4741375,-1.4619148,-1.4750443,-1.4523802,-1.471115,-1.4737693,-1.4741375,-1.4648611,-1.4522513,-1.4720217,-1.4720217,-1.4784552,-1.4835086,-1.4752964,-1.4768579,-1.4752235,-1.4752846,-1.4752846,-1.4752846,-1.4753465,-1.4753465,-1.4753465,-1.4801831,-1.4717195,-1.4740189,-1.4740189,-1.5000672,-1.5000672,-1.5000672,-1.4762834,-1.4757226,-1.4762743,-1.4748271,-1.4754897,-1.4745318,-1.4726297,-1.4726297,-1.4726297,-1.4726297,-1.4726297,-1.4726297,-1.4726297,-1.4745762,-1.4745762,-1.4745762,-1.4745762,-1.4745762,-1.474431,-1.474431,-1.474431,-1.474431,-1.474431,-1.474431,-1.474431,-1.474431,-1.474431,-1.474431,-1.474431,-1.474431,-1.4765871,-1.4765871,-1.4765871,-1.4750231,-1.4743773,-1.4702696],["<b>Session 1 : 0.9 h<\/b> <br/> 2019-04-09 19:23:09 <br/> 3  fish <br/> Water level: 4 m, Up, 340 min since last peak","<b>Session 1 : 0.9 h<\/b> <br/> 2019-04-09 19:23:09 <br/> 3  fish <br/> Water level: 4 m, Up, 340 min since last peak","<b>Session 1 : 0.9 h<\/b> <br/> 2019-04-09 19:23:09 <br/> 3  fish <br/> Water level: 4 m, Up, 340 min since last peak","<b>Session 2 : 2.1 h<\/b> <br/> 2019-04-10 18:23:40 <br/> 5  fish <br/> Water level: 3 m, Up, 240 min since last peak","<b>Session 2 : 2.1 h<\/b> <br/> 2019-04-10 18:23:40 <br/> 5  fish <br/> Water level: 3 m, Up, 240 min since last peak","<b>Session 2 : 2.1 h<\/b> <br/> 2019-04-10 18:23:40 <br/> 5  fish <br/> Water level: 3 m, Up, 240 min since last peak","<b>Session 2 : 2.1 h<\/b> <br/> 2019-04-10 18:23:40 <br/> 5  fish <br/> Water level: 3 m, Up, 240 min since last peak","<b>Session 2 : 2.1 h<\/b> <br/> 2019-04-10 18:23:40 <br/> 5  fish <br/> Water level: 3 m, Up, 240 min since last peak","<b>Session 3 : 2.3 h<\/b> <br/> 2019-04-17 20:45:27 <br/> 2  fish <br/> Water level: 1 m, Down, 305 min since last peak","<b>Session 3 : 2.3 h<\/b> <br/> 2019-04-17 20:45:27 <br/> 2  fish <br/> Water level: 1 m, Down, 305 min since last peak","<b>Session 4 : 0.8 h<\/b> <br/> 2019-04-21 17:58:26 <br/> 0  fish <br/> Water level: 4 m, Up, 320 min since last peak","<b>Session 5 : 2.0 h<\/b> <br/> 2019-04-22 18:18:23 <br/> 2  fish <br/> Water level: 4 m, Up, 305 min since last peak","<b>Session 5 : 2.0 h<\/b> <br/> 2019-04-22 18:18:23 <br/> 2  fish <br/> Water level: 4 m, Up, 305 min since last peak","<b>Session 6 : 1.0 h<\/b> <br/> 2019-04-26 18:30:25 <br/> 0  fish <br/> Water level: 2 m, Up, 110 min since last peak","<b>Session 7 : 0.6 h<\/b> <br/> 2019-05-06 18:38:02 <br/> 0  fish <br/> Water level: 4 m, Dead, 15 min since last peak","<b>Session 8 : 0.8 h<\/b> <br/> 2019-05-10 19:37:30 <br/> 0  fish <br/> Water level: 3 m, Up, 265 min since last peak","<b>Session 9 : 1.6 h<\/b> <br/> 2019-05-10 20:23:30 <br/> 1  fish <br/> Water level: 4 m, Up, 315 min since last peak","<b>Session 10 : 1.0 h<\/b> <br/> 2019-05-16 16:08:35 <br/> 0  fish <br/> Water level: 4 m, Dead, 30 min since last peak","<b>Session 11 : 0.9 h<\/b> <br/> 2019-05-21 19:18:50 <br/> 0  fish <br/> Water level: 4 m, Dead, 15 min since last peak","<b>Session 12 : 0.6 h<\/b> <br/> 2019-05-23 19:45:32 <br/> 0  fish <br/> Water level: 4 m, Up, 330 min since last peak","<b>Session 13 : 2.2 h<\/b> <br/> 2019-05-29 18:50:42 <br/> 1  fish <br/> Water level: 2 m, Down, 290 min since last peak","<b>Session 14 : 1.6 h<\/b> <br/> 2019-05-30 13:27:48 <br/> 0  fish <br/> Water level: 3 m, Up, 295 min since last peak","<b>Session 15 : 0.9 h<\/b> <br/> 2019-06-01 15:28:24 <br/> 0  fish <br/> Water level: 4 m, Up, 335 min since last peak","<b>Session 16 : 0.8 h<\/b> <br/> 2019-06-01 21:28:06 <br/> 2  fish <br/> Water level: 1 m, Down, 325 min since last peak","<b>Session 16 : 0.8 h<\/b> <br/> 2019-06-01 21:28:06 <br/> 2  fish <br/> Water level: 1 m, Down, 325 min since last peak","<b>Session 17 : 1.2 h<\/b> <br/> 2019-06-02 14:26:22 <br/> 0  fish <br/> Water level: 3 m, Up, 235 min since last peak","<b>Session 18 : 1.0 h<\/b> <br/> 2019-06-07 19:20:32 <br/> 0  fish <br/> Water level: 4 m, Up, 315 min since last peak","<b>Session 19 : 1.6 h<\/b> <br/> 2019-06-19 18:13:14 <br/> 0  fish <br/> Water level: 4 m, Up, 340 min since last peak","<b>Session 20 : 1.1 h<\/b> <br/> 2019-06-22 20:38:02 <br/> 0  fish <br/> Water level: 4 m, Dead, 370 min since last peak","<b>Session 21 : 0.8 h<\/b> <br/> 2019-06-26 20:13:34 <br/> 1  fish <br/> Water level: 2 m, Up, 115 min since last peak","<b>Session 22 : 0.2 h<\/b> <br/> 2019-06-27 20:05:43 <br/> 3  fish <br/> Water level: 2 m, Up, 45 min since last peak","<b>Session 22 : 0.2 h<\/b> <br/> 2019-06-27 20:05:43 <br/> 3  fish <br/> Water level: 2 m, Up, 45 min since last peak","<b>Session 22 : 0.2 h<\/b> <br/> 2019-06-27 20:05:43 <br/> 3  fish <br/> Water level: 2 m, Up, 45 min since last peak","<b>Session 23 : 3.3 h<\/b> <br/> 2019-06-28 18:55:31 <br/> 3  fish <br/> Water level: 2 m, Down, 295 min since last peak","<b>Session 23 : 3.3 h<\/b> <br/> 2019-06-28 18:55:31 <br/> 3  fish <br/> Water level: 2 m, Down, 295 min since last peak","<b>Session 23 : 3.3 h<\/b> <br/> 2019-06-28 18:55:31 <br/> 3  fish <br/> Water level: 2 m, Down, 295 min since last peak","<b>Session 24 : 1.4 h<\/b> <br/> 2019-07-13 19:06:20 <br/> 0  fish <br/> Water level: 2 m, Down, 250 min since last peak","<b>Session 25 : 0.2 h<\/b> <br/> 2019-08-13 21:35:09 <br/> 0  fish <br/> Water level: 1 m, Down, 310 min since last peak","<b>Session 26 : 1.3 h<\/b> <br/> 2020-05-20 20:47:38 <br/> 2  fish <br/> Water level: 2 m, Down, 270 min since last peak","<b>Session 26 : 1.3 h<\/b> <br/> 2020-05-20 20:47:38 <br/> 2  fish <br/> Water level: 2 m, Down, 270 min since last peak","<b>Session 27 : 0.0 h<\/b> <br/> 2020-05-22 22:51:04 <br/> 3  fish <br/> Water level: 1 m, Down, 325 min since last peak","<b>Session 27 : 0.0 h<\/b> <br/> 2020-05-22 22:51:04 <br/> 3  fish <br/> Water level: 1 m, Down, 325 min since last peak","<b>Session 27 : 0.0 h<\/b> <br/> 2020-05-22 22:51:04 <br/> 3  fish <br/> Water level: 1 m, Down, 325 min since last peak","<b>Session 28 : 1.4 h<\/b> <br/> 2020-05-25 20:44:09 <br/> 1  fish <br/> Water level: 4 m, Down, 110 min since last peak","<b>Session 29 : 1.2 h<\/b> <br/> 2020-05-26 21:22:28 <br/> 0  fish <br/> Water level: 4 m, Down, 95 min since last peak","<b>Session 30 : 1.3 h<\/b> <br/> 2020-06-01 20:55:54 <br/> 1  fish <br/> Water level: 2 m, Up, 70 min since last peak","<b>Session 31 : 2.3 h<\/b> <br/> 2020-06-08 19:56:35 <br/> 0  fish <br/> Water level: 4 m, Down, 40 min since last peak","<b>Session 32 : 2.0 h<\/b> <br/> 2020-06-15 20:30:55 <br/> 0  fish <br/> Water level: 2 m, Up, 50 min since last peak","<b>Session 33 : 1.1 h<\/b> <br/> 2020-06-30 20:59:48 <br/> 0  fish <br/> Water level: 2 m, Up, 105 min since last peak","<b>Session 34 : 2.5 h<\/b> <br/> 2020-07-16 21:58:40 <br/> 0  fish <br/> Water level: 2 m, Up, 80 min since last peak","<b>Session 34 : 2.5 h<\/b> <br/> 2020-07-16 21:58:40 <br/> 0  fish <br/> Water level: 2 m, Up, 80 min since last peak","<b>Session 34 : 2.5 h<\/b> <br/> 2020-07-16 21:58:40 <br/> 0  fish <br/> Water level: 2 m, Up, 80 min since last peak","<b>Session 34 : 2.5 h<\/b> <br/> 2020-07-16 21:58:40 <br/> 0  fish <br/> Water level: 2 m, Up, 80 min since last peak","<b>Session 34 : 2.5 h<\/b> <br/> 2020-07-16 21:58:40 <br/> 0  fish <br/> Water level: 2 m, Up, 80 min since last peak","<b>Session 34 : 2.5 h<\/b> <br/> 2020-07-16 21:58:40 <br/> 0  fish <br/> Water level: 2 m, Up, 80 min since last peak","<b>Session 34 : 2.5 h<\/b> <br/> 2020-07-16 21:58:40 <br/> 0  fish <br/> Water level: 2 m, Up, 80 min since last peak","<b>Session 35 : 2.6 h<\/b> <br/> 2020-07-17 21:51:40 <br/> 0  fish <br/> Water level: 2 m, Up, 20 min since last peak","<b>Session 35 : 2.6 h<\/b> <br/> 2020-07-17 21:51:40 <br/> 0  fish <br/> Water level: 2 m, Up, 20 min since last peak","<b>Session 35 : 2.6 h<\/b> <br/> 2020-07-17 21:51:40 <br/> 0  fish <br/> Water level: 2 m, Up, 20 min since last peak","<b>Session 35 : 2.6 h<\/b> <br/> 2020-07-17 21:51:40 <br/> 0  fish <br/> Water level: 2 m, Up, 20 min since last peak","<b>Session 35 : 2.6 h<\/b> <br/> 2020-07-17 21:51:40 <br/> 0  fish <br/> Water level: 2 m, Up, 20 min since last peak","<b>Session 36 : 1.5 h<\/b> <br/> 2020-07-18 23:25:07 <br/> 0  fish <br/> Water level: 2 m, Up, 80 min since last peak","<b>Session 36 : 1.5 h<\/b> <br/> 2020-07-18 23:25:07 <br/> 0  fish <br/> Water level: 2 m, Up, 80 min since last peak","<b>Session 36 : 1.5 h<\/b> <br/> 2020-07-18 23:25:07 <br/> 0  fish <br/> Water level: 2 m, Up, 80 min since last peak","<b>Session 36 : 1.5 h<\/b> <br/> 2020-07-18 23:25:07 <br/> 0  fish <br/> Water level: 2 m, Up, 80 min since last peak","<b>Session 36 : 1.5 h<\/b> <br/> 2020-07-18 23:25:07 <br/> 0  fish <br/> Water level: 2 m, Up, 80 min since last peak","<b>Session 36 : 1.5 h<\/b> <br/> 2020-07-18 23:25:07 <br/> 0  fish <br/> Water level: 2 m, Up, 80 min since last peak","<b>Session 36 : 1.5 h<\/b> <br/> 2020-07-18 23:25:07 <br/> 0  fish <br/> Water level: 2 m, Up, 80 min since last peak","<b>Session 36 : 1.5 h<\/b> <br/> 2020-07-18 23:25:07 <br/> 0  fish <br/> Water level: 2 m, Up, 80 min since last peak","<b>Session 36 : 1.5 h<\/b> <br/> 2020-07-18 23:25:07 <br/> 0  fish <br/> Water level: 2 m, Up, 80 min since last peak","<b>Session 36 : 1.5 h<\/b> <br/> 2020-07-18 23:25:07 <br/> 0  fish <br/> Water level: 2 m, Up, 80 min since last peak","<b>Session 36 : 1.5 h<\/b> <br/> 2020-07-18 23:25:07 <br/> 0  fish <br/> Water level: 2 m, Up, 80 min since last peak","<b>Session 36 : 1.5 h<\/b> <br/> 2020-07-18 23:25:07 <br/> 0  fish <br/> Water level: 2 m, Up, 80 min since last peak","<b>Session 37 : 1.6 h<\/b> <br/> 2020-09-04 20:50:17 <br/> 3  fish <br/> Water level: 3 m, Down, 125 min since last peak","<b>Session 37 : 1.6 h<\/b> <br/> 2020-09-04 20:50:17 <br/> 3  fish <br/> Water level: 3 m, Down, 125 min since last peak","<b>Session 37 : 1.6 h<\/b> <br/> 2020-09-04 20:50:17 <br/> 3  fish <br/> Water level: 3 m, Down, 125 min since last peak","<b>Session 38 : 0.6 h<\/b> <br/> 2020-09-13 21:33:41 <br/> 0  fish <br/> Water level: 2 m, Up, 50 min since last peak","<b>Session 39 : 0.2 h<\/b> <br/> 2020-09-23 19:35:26 <br/> 1  fish <br/> Water level: 3 m, Up, 230 min since last peak","<b>Session 40 : 0.6 h<\/b> <br/> 2020-10-09 21:17:36 <br/> 0  fish <br/> Water level: 3 m, Up, 315 min since last peak"],null,null,{"maxWidth":100,"minWidth":50,"autoPan":true,"keepInView":false,"closeButton":true,"className":""}]}],"limits":{"lat":[43.4667765,43.4948349],"lng":[-1.5000672,-1.4522513]}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>As you see I fish mostly in the Nive river that is flowing through Bayonne city.</p>
</section>
<section id="when-it-is-best-to-fish" class="level3">
<h3 class="anchored" data-anchor-id="when-it-is-best-to-fish">When it is best to fish ?</h3>
<section id="time-of-the-year" class="level4">
<h4 class="anchored" data-anchor-id="time-of-the-year">Time of the year</h4>
<p>The following graph shows the number of fish caught depending on the time of the year :</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">catch_cond <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb4-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(Session, Time_beg, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.drop =</span> F) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb4-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">na.omit</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb4-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n_catch =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">n</span>()) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb4-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">right_join</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unique</span>(catch_cond[, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Session"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Time_beg"</span>)])) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb4-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n_catch =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(n_catch), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, n_catch )) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> n_catch, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span>Time_beg)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>( <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb4-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Date"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Number of catch"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_datetime</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">date_labels =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"%d/%m/%y"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">date_breaks =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"3 months"</span>) </span></code></pre></div>
</details>
<div class="cell-output-display">
<p><img src="https://aureliencallens.github.io/posts/2020-09-25-datascience-fishing-part2/index_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>From this graph we see that I didn’t go fishing during the autumn and winter of 2019, I don’t have any data. Unfortunately for me, autumn is known to be a great period for sea bass fishing, I must go fishing this year to compensate the lack of data in this season. During winter, fishing is really complicated because the large majority of sea bass are returned to the ocean.</p>
</section>
<section id="time-of-the-day" class="level4">
<h4 class="anchored" data-anchor-id="time-of-the-day">Time of the day</h4>
<p>This graph shows the number of fish I catch depending on the hour of the day :</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">catch_cond <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb5-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(Session, Time_beg, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.drop =</span> F) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb5-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">na.omit</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb5-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n_catch =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">n</span>()) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb5-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">right_join</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unique</span>(catch_cond[, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Session"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Time_beg"</span>)])) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb5-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n_catch =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(n_catch), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, n_catch ), </span>
<span id="cb5-7"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hour =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">format</span>(Time_beg, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"%H"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb5-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> n_catch, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span>hour)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>( <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)  <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Hour"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Number of catch"</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-10"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>()</span></code></pre></div>
</details>
<div class="cell-output-display">
<p><img src="https://aureliencallens.github.io/posts/2020-09-25-datascience-fishing-part2/index_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>I mostly fish after work or during evenings. To draw relevant conclusions about the influence of the fishing hour, I have to go fishing at different hours of the day (in the morning for example).</p>
</section>
<section id="the-tide" class="level4">
<h4 class="anchored" data-anchor-id="the-tide">The tide</h4>
<p>The tide is an important parameter for fishing in estuaries. Let’s see the effect of the tide current on my catches:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggpubr)</span>
<span id="cb6-2"></span>
<span id="cb6-3">gg1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> catch_cond <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb6-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(Session, Tide_status_ses, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.drop =</span> F)  <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span>  </span>
<span id="cb6-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">drop_na</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb6-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n_catch =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">n</span>()) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb6-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">right_join</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unique</span>(catch_cond[, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Session"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Tide_status_ses"</span>)])) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb6-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n_catch =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(n_catch), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, n_catch )) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb6-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> n_catch, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> Tide_status_ses, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> Tide_status_ses)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_boxplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Status of tide current"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Number of catch"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"None"</span>)</span>
<span id="cb6-13"></span>
<span id="cb6-14">gg2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> catch_cond <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb6-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">na.omit</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb6-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> length,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> Tide_status_ses, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> Tide_status_ses)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_boxplot</span>()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Status of tide current"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Length of the fish"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"None"</span>)</span>
<span id="cb6-20"></span>
<span id="cb6-21"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggarrange</span>(gg1, gg2)</span></code></pre></div>
</details>
<div class="cell-output-display">
<p><img src="https://aureliencallens.github.io/posts/2020-09-25-datascience-fishing-part2/index_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>It seems that the status of the tide current does not influence the number of my catch but influences the length of the fish. I tend to catch bigger fish when the current is going down.</p>
</section>
</section>
<section id="does-the-moon-affect-my-fishing-results" class="level3">
<h3 class="anchored" data-anchor-id="does-the-moon-affect-my-fishing-results">Does the moon affect my fishing results?</h3>
<p>A widespread belief among fishermen is that the moon influences greatly the behavior of the fish. Data about the moon phase were available thanks to the weather API, I decided to record this variable to investigate if the belief was true. The two graphs show the number and length of fish depending on the phase of moon (0 corresponding to new moon and 1 to full moon):</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1">gg3 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> catch_cond <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb7-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(Session, Moon, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.drop =</span> F) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span>  </span>
<span id="cb7-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">na.omit</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb7-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n_catch =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">n</span>()) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb7-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">right_join</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unique</span>(catch_cond[, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Session"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Moon"</span>)])) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb7-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n_catch =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(n_catch), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, n_catch )) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb7-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> n_catch, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> Moon)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>( <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Moon phase"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Number of catch"</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>()</span>
<span id="cb7-11"></span>
<span id="cb7-12">gg4 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> catch_cond <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb7-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> length, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> Moon)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>( <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_smooth</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lm"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">se=</span>T) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb7-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Moon phase"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Length of the fish"</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>()</span>
<span id="cb7-18"></span>
<span id="cb7-19"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggarrange</span>(gg3, gg4)</span></code></pre></div>
</details>
<div class="cell-output-display">
<p><img src="https://aureliencallens.github.io/posts/2020-09-25-datascience-fishing-part2/index_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The phase of the moon does not seem to influence the number of fish I catch during a session. However, I tend to catch bigger fish the closer we are to the full moon. To confirm this observation, I need to keep going fishing to get more data !</p>
</section>
<section id="does-the-weather-affect-my-fishing-results" class="level3">
<h3 class="anchored" data-anchor-id="does-the-weather-affect-my-fishing-results">Does the weather affect my fishing results?</h3>
<p>We can look at the number of fish caught during different weather conditions:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># precipitation probability </span></span>
<span id="cb8-2"></span>
<span id="cb8-3">gg5 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> catch_cond <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb8-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(Session, Preci_prob, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.drop =</span> F) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span>  </span>
<span id="cb8-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">na.omit</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb8-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n_catch =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">n</span>()) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb8-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">right_join</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unique</span>(catch_cond[, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Session"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Preci_prob"</span>)])) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb8-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n_catch =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(n_catch), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, n_catch )) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb8-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> n_catch, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> Preci_prob)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Precipitation prob."</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Number of catch"</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>()</span>
<span id="cb8-13"></span>
<span id="cb8-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Atm pressure </span></span>
<span id="cb8-15"></span>
<span id="cb8-16">gg6 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> catch_cond <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb8-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(Session, Atm_pres, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.drop =</span> F) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span>  </span>
<span id="cb8-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">na.omit</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb8-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n_catch =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">n</span>()) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb8-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">right_join</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unique</span>(catch_cond[, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Session"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Atm_pres"</span>)])) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb8-21">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n_catch =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(n_catch), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, n_catch )) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb8-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> n_catch, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> Atm_pres)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-23">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-24">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Atm. pressure"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Number of catch"</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-25">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>()</span>
<span id="cb8-26"></span>
<span id="cb8-27"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#Air temp</span></span>
<span id="cb8-28"></span>
<span id="cb8-29">gg7 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> catch_cond <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb8-30">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(Session, Air_temp, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.drop =</span> F) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span>  </span>
<span id="cb8-31">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">na.omit</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb8-32">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n_catch =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">n</span>()) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb8-33">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">right_join</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unique</span>(catch_cond[, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Session"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Air_temp"</span>)])) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb8-34">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n_catch =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(n_catch), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, n_catch )) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb8-35">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> n_catch, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> Air_temp)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-36">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-37">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Air temp."</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Number of catch"</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-38">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>()</span>
<span id="cb8-39"></span>
<span id="cb8-40"></span>
<span id="cb8-41"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#Cloud cover</span></span>
<span id="cb8-42"></span>
<span id="cb8-43">gg8 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> catch_cond <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb8-44">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(Session, Cloud_cover, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.drop =</span> F) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span>  </span>
<span id="cb8-45">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">na.omit</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb8-46">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n_catch =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">n</span>()) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb8-47">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">right_join</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unique</span>(catch_cond[, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Session"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Cloud_cover"</span>)])) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb8-48">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n_catch =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(n_catch), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, n_catch )) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb8-49">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> n_catch, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> Cloud_cover)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-50">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-51">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Cloud cover"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Number of catchh"</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-52">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>()</span>
<span id="cb8-53"></span>
<span id="cb8-54"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggarrange</span>(gg5, gg6, gg7, gg8)</span></code></pre></div>
</details>
<div class="cell-output-display">
<p><img src="https://aureliencallens.github.io/posts/2020-09-25-datascience-fishing-part2/index_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>And to their length :</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1">gg15 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> catch_cond <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb9-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> length, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> Preci_prob)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>( <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>( <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Length of the fish"</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>()</span>
<span id="cb9-6"></span>
<span id="cb9-7">gg16 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> catch_cond <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb9-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> length, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> Atm_pres)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>( <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>( <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Length of the fish"</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>()</span>
<span id="cb9-12"></span>
<span id="cb9-13">gg17 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> catch_cond <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb9-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> length, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> Air_temp)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>( <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>( <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Length of the fish"</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>()</span>
<span id="cb9-18"></span>
<span id="cb9-19"></span>
<span id="cb9-20">gg18  <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> catch_cond <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb9-21">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> length, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> Cloud_cover)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>( <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-23">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>( <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Length of the fish"</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-24">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>()</span>
<span id="cb9-25"></span>
<span id="cb9-26"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggarrange</span>(gg15, gg16, gg17, gg18)</span></code></pre></div>
</details>
<div class="cell-output-display">
<p><img src="https://aureliencallens.github.io/posts/2020-09-25-datascience-fishing-part2/index_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Because we have limited data and not all weather conditions are covered, it is difficult to draw any conclusions.</p>
</section>
<section id="what-are-the-best-lures-to-catch-fish" class="level3">
<h3 class="anchored" data-anchor-id="what-are-the-best-lures-to-catch-fish">What are the best lures to catch fish ?</h3>
<p>Each time I catch a fish, I fill a form with my shiny application in order to record the characteristics of the lure used. There are different types of lures that have specific swimming patterns, different colors and size. We can represent the number of fish caught depending on the lure characteristics:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">levels</span>(catch_cond<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>colour) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"clear"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"natural"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dark"</span>)</span>
<span id="cb10-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">levels</span>(catch_cond<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>length_lure) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"large"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"medium"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"small"</span>)</span>
<span id="cb10-3"></span>
<span id="cb10-4">gg9 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> catch_cond <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb10-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">na.omit</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb10-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>( <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span>lure, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> lure)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_bar</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stat=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"count"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Type of lure"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb10-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"None"</span>)</span>
<span id="cb10-11"></span>
<span id="cb10-12">gg10 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> catch_cond <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb10-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">na.omit</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb10-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>( <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span>colour, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> colour)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_bar</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stat=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"count"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Color of the lures"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-18">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_brewer</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">palette=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"BuPu"</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb10-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"None"</span>)</span>
<span id="cb10-20"></span>
<span id="cb10-21">gg11 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> catch_cond <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb10-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">na.omit</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb10-23">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>( <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span>length_lure, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> length_lure)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-24">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_bar</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stat=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"count"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-25">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Size of the lure"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-26">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_brewer</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">palette=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Dark2"</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-27">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"None"</span>)</span>
<span id="cb10-28"></span>
<span id="cb10-29"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">annotate_figure</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggarrange</span>(gg9, gg10, gg11, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncol =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>),</span>
<span id="cb10-30">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">left =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">text_grob</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Number of catch"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rot =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span>)</span>
<span id="cb10-31">)</span></code></pre></div>
</details>
<div class="cell-output-display">
<p><img src="https://aureliencallens.github.io/posts/2020-09-25-datascience-fishing-part2/index_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We can do the same for the length of fish caught:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1">gg12 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span>catch_cond <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb11-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">na.omit</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb11-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> length, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> lure, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill=</span>lure)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_boxplot</span>()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Type of lure"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"None"</span>)</span>
<span id="cb11-7"></span>
<span id="cb11-8">gg13 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span>catch_cond <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb11-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">na.omit</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb11-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> length, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> colour, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill=</span> colour)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_boxplot</span>()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Color of the lures"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-14">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_brewer</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">palette=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"BuPu"</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"None"</span>)</span>
<span id="cb11-15"></span>
<span id="cb11-16">gg14 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span>catch_cond <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb11-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">na.omit</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb11-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> length, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> length_lure, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill=</span>length_lure)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_boxplot</span>()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Size of the lure"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-21">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-22">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_brewer</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">palette=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Dark2"</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"None"</span>)</span>
<span id="cb11-23"></span>
<span id="cb11-24"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">annotate_figure</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggarrange</span>(gg12, gg13, gg14, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncol =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>),</span>
<span id="cb11-25">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">left =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">text_grob</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Length of fish"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rot =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span>)</span>
<span id="cb11-26">)</span></code></pre></div>
</details>
<div class="cell-output-display">
<p><img src="https://aureliencallens.github.io/posts/2020-09-25-datascience-fishing-part2/index_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>With these 6 graphs, we can see that the most successful types of lures for me are the shad and slug types. An honorable mention is the jerkbait type: it only accounts for 2 fish, but 2 big fish (median around 47cm). The colors that worked best for me were clear and natural. For the size of the lure, bigger lures tend to catch bigger fish in average. These conclusions must be taken with a grain of salt because we do not know the time spent with each lure before catching a fish. In addition, I tend to use the same types and colors of lures (habits), I should vary more.</p>
</section>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p>Analyzing my fishing data was very interesting and it brought me some insights on my fishing style! I understood that I was fishing almost the same way with the same habits. Although it seems to be working for me, I have a biased view on how to catch European sea bass. I must use bigger lures to catch bigger fish and I must vary the types of lures used. Indeed, I fish most of the times with slug or shad lures, hence the higher number of fish caught with these types of lures.</p>
<p>I will keep using the application to gather more data and have a better understanding on my fishing session. I will keep you updated on the results ! :wink:</p>


<!-- -->

</section>

<a onclick="window.scrollTo(0, 0); return false;" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a> ]]></description>
  <category>R</category>
  <category>EDA</category>
  <guid>https://aureliencallens.github.io/posts/2020-09-25-datascience-fishing-part2/index.html</guid>
  <pubDate>Thu, 24 Sep 2020 22:00:00 GMT</pubDate>
</item>
<item>
  <title>Can R and Shiny make me a better fisherman? Part 1</title>
  <dc:creator>Aurélien Callens</dc:creator>
  <link>https://aureliencallens.github.io/posts/2020-09-12-datascience-fishing-part1/index.html</link>
  <description><![CDATA[ 




<p>My favorite hobby, in addition to R coding of course, is fishing. Most of the time, I fish European sea bass (<em>Dicentrarchus labrax</em>) in estuaries. The sea bass is a predatory fish that has a broad range of preys: crabs, sand eels, prawns, shrimps and other fish. To catch these predators, I don’t use live baits, I prefer to use artificial lures that imitate a specific prey.</p>
<p>In theory, it is quite easy to catch a fish:</p>
<ol type="1">
<li><p>Use a lure that imitate the current prey of the sea bass.</p></li>
<li><p>Animate the lure in a spot where the fish are active.</p></li>
<li><p>Catch a really big fish !</p></li>
</ol>
<p>In practice, it is an other story ! Indeed, the feeding activity, the position of the European sea bass in the estuary and their preys will vary depending on different parameters:</p>
<ul>
<li>the characteristics of the riverbed, which will depend where I fish</li>
<li>the time of the day: the sea bass is more active during dawn and dusk</li>
<li>the current and water level associated with the tide. The water level in estuaries is constantly varying to greater or lesser degree due to the tide influence. It is also influenced by the river flow which can be higher in case of heavy rains.</li>
</ul>
<p>As you understand, there are many parameters potentially influencing the results of my fishing session. This is why I decided to create a shiny application to augment the number and the length of the fish caught during my sessions. To reach this objective, I need to better understand the activity, the position and the prey of the sea bass depending on the parameters described above.</p>
<section id="requirements-of-my-application" class="level2">
<h2 class="anchored" data-anchor-id="requirements-of-my-application">Requirements of my application</h2>
<ul>
<li>It must store data about my fishing session:</li>
</ul>
<table class="table">
<colgroup>
<col style="width: 33%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th>Information needed</th>
<th>Description of the variables</th>
<th>Where do I get the data ?</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Time</td>
<td>Time when a fish is caught, time since the beginning of the session</td>
<td>R</td>
</tr>
<tr class="even">
<td>Catch</td>
<td>Species and length of the fish caught</td>
<td>Geolocation from smartphone?</td>
</tr>
<tr class="odd">
<td>Lures</td>
<td>Type, length, color of lure used</td>
<td>Weather API</td>
</tr>
</tbody>
</table>
<ul>
<li>It must record data about my catch and the artificial lures used:</li>
</ul>
<table class="table">
<colgroup>
<col style="width: 33%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th>Information needed</th>
<th>Description of the variables</th>
<th>Where do I get the data ?</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Time</td>
<td>Time when a fish is caught, time since the beginning of the session</td>
<td>R</td>
</tr>
<tr class="even">
<td>Catch</td>
<td>Species and length of the fish caught</td>
<td>User input</td>
</tr>
<tr class="odd">
<td>Lures</td>
<td>Type, length, color of lure used</td>
<td>User input</td>
</tr>
</tbody>
</table>
<ul>
<li><p>It must be adapted to small screens because I will always use the application on my phone.</p></li>
<li><p>It must remain free.</p></li>
</ul>
</section>
<section id="collecting-the-data" class="level2">
<h2 class="anchored" data-anchor-id="collecting-the-data">Collecting the data</h2>
<section id="getting-my-gps-location" class="level3">
<h3 class="anchored" data-anchor-id="getting-my-gps-location">Getting my gps location</h3>
<p>My gps location is collected by using a bit of Javascript in the header of the shiny application. This code has been developed by AugusT and is available on his <a href="https://github.com/AugustT/shiny_geolocation" target="_blank">github repository</a>.</p>
</section>
<section id="weather-api" class="level3">
<h3 class="anchored" data-anchor-id="weather-api">Weather API</h3>
<p>For the weather data, I found a free API called Dark Sky. I made a function that takes as input the coordinates of a place and the API user key and returns the current weather conditions in a dataframe:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(httr)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(jsonlite)</span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb1-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(rvest)</span>
<span id="cb1-5"></span>
<span id="cb1-6">weather <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(x, API_key){</span>
<span id="cb1-7">  url <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://api.darksky.net/forecast/"</span>,API_key,</span>
<span id="cb1-8">                <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/"</span>, x[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">","</span>, x[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>],</span>
<span id="cb1-9">                <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"?units=ca&amp;exclude=hourly,alerts,flags"</span>)</span>
<span id="cb1-10">  </span>
<span id="cb1-11">  rep <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">GET</span>(url)</span>
<span id="cb1-12">  </span>
<span id="cb1-13">  table <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fromJSON</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">content</span>(rep, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text"</span>))</span>
<span id="cb1-14">  </span>
<span id="cb1-15">  current.weather.info <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">with</span>(table,</span>
<span id="cb1-16">                               <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Air_temp =</span> currently<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>temperature,</span>
<span id="cb1-17">                                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Weather =</span> currently<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>summary,</span>
<span id="cb1-18">                                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Atm_pres =</span> currently<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>pressure,</span>
<span id="cb1-19">                                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Wind_str =</span> currently<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>windSpeed,</span>
<span id="cb1-20">                                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Wind_dir =</span> currently<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>windBearing,</span>
<span id="cb1-21">                                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Cloud_cover =</span> currently<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>cloudCover,</span>
<span id="cb1-22">                                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">PrecipProb =</span> currently<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>precipProbability,</span>
<span id="cb1-23">                                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">PrecipInt =</span> currently<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>precipIntensity,  </span>
<span id="cb1-24">                                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Moon =</span> daily<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>moonPhase[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]))</span>
<span id="cb1-25">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(current.weather.info)</span>
<span id="cb1-26">}</span></code></pre></div>
</div>
</section>
<section id="web-scrapping-for-tide-data" class="level3">
<h3 class="anchored" data-anchor-id="web-scrapping-for-tide-data">Web scrapping for Tide data</h3>
<p>I created a function to scrap information about the tide on a french website. The following function takes no argument and return the current water level, the tide status (going up or down) and time since the tide peak for the location I fish.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1">tide <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(){</span>
<span id="cb2-2">  </span>
<span id="cb2-3">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set the current time and time zone </span></span>
<span id="cb2-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Sys.setenv</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">TZ=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Europe/Paris"</span>)</span>
<span id="cb2-5">  time <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.POSIXct</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Sys.time</span>())</span>
<span id="cb2-6">  url <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://services.data.shom.fr/hdm/vignette/grande/BOUCAU-BAYONNE?locale=en"</span></span>
<span id="cb2-7">  </span>
<span id="cb2-8">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Read the web page that contains the tide data </span></span>
<span id="cb2-9">  text <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> url <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb2-10">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_html</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-11">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">html_text</span>()</span>
<span id="cb2-12">  </span>
<span id="cb2-13">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Clean the html data to get a dataframe  with two cols Time and water level: </span></span>
<span id="cb2-14"></span>
<span id="cb2-15">  text <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.character</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sub</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".*var data = *(.*?) *</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">;.*"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">1"</span>, text))</span>
<span id="cb2-16">  text <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unlist</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_split</span>( <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">substr</span>(text, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nchar</span>(text)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">],"</span>))</span>
<span id="cb2-17">  tidy_df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hour=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Water=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>)</span>
<span id="cb2-18">  </span>
<span id="cb2-19">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span>(i <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(text)){</span>
<span id="cb2-20">    text_dat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unlist</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_split</span>(text[i], <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'"'</span>))[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)]</span>
<span id="cb2-21">    text_dat[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">substr</span>(text_dat[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nchar</span>(text_dat[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb2-22">    text_dat[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">substr</span>(text_dat[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>], <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nchar</span>(text_dat[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>])))</span>
<span id="cb2-23">    tidy_df[i,] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> text_dat</span>
<span id="cb2-24">  }</span>
<span id="cb2-25">  </span>
<span id="cb2-26">  tidy_df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>hour <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.POSIXct</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">format</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Sys.time</span>(),<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"%Y-%m-%d"</span>), tidy_df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>hour))</span>
<span id="cb2-27">  </span>
<span id="cb2-28">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Some lines to get the tide status (going down or up) : </span></span>
<span id="cb2-29">  </span>
<span id="cb2-30">  n_closest <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">which</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>(tidy_df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>hour <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> time) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">min</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>(tidy_df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>hour <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> time)))</span>
<span id="cb2-31">  </span>
<span id="cb2-32">  water_level <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(tidy_df[n_closest, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>])</span>
<span id="cb2-33">  </span>
<span id="cb2-34">  all_decrea <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">all</span>(tidy_df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Water[(n_closest<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">-6</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>(n_closest<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>)] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span></span>
<span id="cb2-35">                      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cummin</span>(tidy_df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Water[(n_closest<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">-6</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>(n_closest<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>)] ))</span>
<span id="cb2-36">  </span>
<span id="cb2-37">  all_increa <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">all</span>(tidy_df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Water[(n_closest<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">-6</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>(n_closest<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>)] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span></span>
<span id="cb2-38">                      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cummax</span>(tidy_df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Water[(n_closest<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">-6</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>(n_closest<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>)] ))</span>
<span id="cb2-39">  </span>
<span id="cb2-40">  maree <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(all_decrea, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Down"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(all_increa, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Up"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Dead"</span>))</span>
<span id="cb2-41">  </span>
<span id="cb2-42">  </span>
<span id="cb2-43">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Compute time since the last peak :</span></span>
<span id="cb2-44">  </span>
<span id="cb2-45">  last_peak <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">max</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cumsum</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rle</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">diff</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(tidy_df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Water), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lag =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>lengths)</span>
<span id="cb2-46">                   [<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cumsum</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rle</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">diff</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(tidy_df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Water), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lag =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>lengths) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> n_closest])</span>
<span id="cb2-47">  </span>
<span id="cb2-48">  </span>
<span id="cb2-49">  time_after <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">difftime</span>(tidy_df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>hour[n_closest], tidy_df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>hour[last_peak], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">units =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mins"</span>))</span>
<span id="cb2-50">  </span>
<span id="cb2-51">  </span>
<span id="cb2-52">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Return the list with the results :</span></span>
<span id="cb2-53">  </span>
<span id="cb2-54">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Water_level =</span> water_level,</span>
<span id="cb2-55">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Maree =</span> maree,</span>
<span id="cb2-56">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Time_peak =</span> time_after))</span>
<span id="cb2-57">  </span>
<span id="cb2-58">}</span></code></pre></div>
</div>
</section>
</section>
<section id="the-shiny-application" class="level2">
<h2 class="anchored" data-anchor-id="the-shiny-application">The shiny application</h2>
<p>The main problem I encountered while developing this application was data storage. Shinyapps.io host freely your shiny application but there were some problems when I used the shiny application to modify the csv files. The solution I found was to store the data in my dropbox account, you can find <a href="https://shiny.rstudio.com/articles/persistent-data-storage.html" target="_blank">here</a> more details on the subject and alternatives solutions. I used the package <em>rdrop2</em> to access and modify the data with the shiny application.</p>
<p>Here are the main steps of this application :</p>
<ol type="1">
<li><p>When the application is started, it reads a csv file stored on my dropbox to see if a fishing session is running or not. If not the user can start a fishing session.</p></li>
<li><p>When starting a new session, a line with coordinates, weather conditions, and tide condition is added to the csv file previously mentioned.</p></li>
<li><p>If a fish is caught, the user can fill out a form to store the data in a second csv file. This file contains : the time, the species and length of the fish and information about the fishing lure used (type, color, length).</p></li>
<li><p>The user can end the fishing session by pushing a button. This will register the ending time, weather conditions, and tide condition in the first csv file.</p></li>
</ol>
<p>A simplified graph is showed below:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://aureliencallens.github.io/posts/2020-09-12-datascience-fishing-part1/images/graph.svg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Simplified workflow of the application</figcaption>
</figure>
</div>
<section id="ui-side" class="level3">
<h3 class="anchored" data-anchor-id="ui-side">UI side</h3>
<p>The user interface of the application is built using the <em>miniUI</em> package. This package allows R user to develop shiny application adapted to small screens.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load libraries </span></span>
<span id="cb3-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(shiny)</span>
<span id="cb3-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(shinyWidgets)</span>
<span id="cb3-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(googlesheets)</span>
<span id="cb3-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(miniUI)</span>
<span id="cb3-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(leaflet)</span>
<span id="cb3-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(rdrop2)</span>
<span id="cb3-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Sys.setenv</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">TZ=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Europe/Paris"</span>)</span>
<span id="cb3-9"></span>
<span id="cb3-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#Import the functions for weather API and webscrapping </span></span>
<span id="cb3-11"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">suppressMessages</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">source</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"api_functions.R"</span>))</span>
<span id="cb3-12"></span>
<span id="cb3-13"></span>
<span id="cb3-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load the dropbox token : </span></span>
<span id="cb3-15">token <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">readRDS</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"token.rds"</span>)</span>
<span id="cb3-16"></span>
<span id="cb3-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Minipage for small screens</span></span>
<span id="cb3-18">ui <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">miniPage</span>(</span>
<span id="cb3-19">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Javascript that give user location (input$lat,input$long)</span></span>
<span id="cb3-20">  tags<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">script</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'$(document).ready(function () {</span></span>
<span id="cb3-21"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                           navigator.geolocation.getCurrentPosition(onSuccess, onError);</span></span>
<span id="cb3-22"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                           </span></span>
<span id="cb3-23"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                           function onError (err) {</span></span>
<span id="cb3-24"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                           Shiny.onInputChange("geolocation", false);</span></span>
<span id="cb3-25"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                           }</span></span>
<span id="cb3-26"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                           </span></span>
<span id="cb3-27"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                           function onSuccess (position) {</span></span>
<span id="cb3-28"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                           setTimeout(function () {</span></span>
<span id="cb3-29"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                           var coords = position.coords;</span></span>
<span id="cb3-30"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                           console.log(coords.latitude + ", " + coords.longitude);</span></span>
<span id="cb3-31"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                           Shiny.onInputChange("geolocation", true);</span></span>
<span id="cb3-32"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                           Shiny.onInputChange("lat", coords.latitude);</span></span>
<span id="cb3-33"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                           Shiny.onInputChange("long", coords.longitude);</span></span>
<span id="cb3-34"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                           }, 1100)</span></span>
<span id="cb3-35"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                           }</span></span>
<span id="cb3-36"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">                           });'</span>),</span>
<span id="cb3-37">  </span>
<span id="cb3-38">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gadgetTitleBar</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Catch them all"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">left =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">right =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>),</span>
<span id="cb3-39">  </span>
<span id="cb3-40">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">miniTabstripPanel</span>(</span>
<span id="cb3-41">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#First panel depends if a fishing session is started or not </span></span>
<span id="cb3-42">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">miniTabPanel</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Session"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">icon =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">icon</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sliders"</span>),</span>
<span id="cb3-43">                 <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">miniContentPanel</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">uiOutput</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"UI_sess"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">align =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"center"</span>),</span>
<span id="cb3-44">                                  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">uiOutput</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"UI"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">align =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"center"</span>))</span>
<span id="cb3-45">    ),</span>
<span id="cb3-46">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Second panel displays the location of the previous fishing session with the number of fish caught </span></span>
<span id="cb3-47">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">miniTabPanel</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Map"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">icon =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">icon</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"map-o"</span>),</span>
<span id="cb3-48">                 <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">miniContentPanel</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scrollable =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">padding =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb3-49">                                  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">div</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">style=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text-align:center"</span>,</span>
<span id="cb3-50">                                      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">prettyRadioButtons</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"radio"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">inline =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>,</span>
<span id="cb3-51">                                                         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">choices =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"3 dernières sessions"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb3-52">                                                                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"3 Meilleures Sessions"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,</span>
<span id="cb3-53">                                                                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Tout afficher"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>), </span>
<span id="cb3-54">                                                         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">selected =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)),</span>
<span id="cb3-55">                                  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">leafletOutput</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"map"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"93%"</span>)</span>
<span id="cb3-56">                 ))</span>
<span id="cb3-57">  )</span>
<span id="cb3-58">  </span>
<span id="cb3-59">)</span></code></pre></div>
</div>
</section>
<section id="server-side" class="level3">
<h3 class="anchored" data-anchor-id="server-side">Server side</h3>
<p>The server side is mainly composed by observeEvent functions. The utility of each observeEvent is provided in the script as commentary.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">server <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(input, output, session){</span>
<span id="cb4-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">source</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"api_functions.R"</span>)</span>
<span id="cb4-3">  </span>
<span id="cb4-4">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Read the csv file containing information about fishing session. If a session is running,</span></span>
<span id="cb4-5">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># display the UI that allows the user to input data about the fish caught. If a session is not started,</span></span>
<span id="cb4-6">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># display a button to start the session.</span></span>
<span id="cb4-7">  </span>
<span id="cb4-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">observeEvent</span>(input<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>go ,{</span>
<span id="cb4-9">    </span>
<span id="cb4-10">    dat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">drop_read_csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/app_peche/session.csv"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">header =</span> T, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stringsAsFactors =</span> F, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dtoken =</span> token) </span>
<span id="cb4-11">    </span>
<span id="cb4-12">    output<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>UI<span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">renderUI</span>({</span>
<span id="cb4-13">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tagList</span>(</span>
<span id="cb4-14">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rev</span>(dat<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Status)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"end"</span>){</span>
<span id="cb4-15">          <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">actionButton</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"go"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Start session"</span>)}</span>
<span id="cb4-16">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span>{</span>
<span id="cb4-17">          <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">actionButton</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"go"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"End session"</span>) </span>
<span id="cb4-18">        }</span>
<span id="cb4-19">      )</span>
<span id="cb4-20">    })</span>
<span id="cb4-21">    </span>
<span id="cb4-22">    output<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>UI_sess<span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">renderUI</span>({</span>
<span id="cb4-23">      <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rev</span>(dat<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Status)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"end"</span>){</span>
<span id="cb4-24">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tagList</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">textInput</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"comments"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">h3</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Commentaires"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">value =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"NA"</span>))</span>
<span id="cb4-25">      }<span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span>{</span>
<span id="cb4-26">        input<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>catch</span>
<span id="cb4-27">        </span>
<span id="cb4-28">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tagList</span>(</span>
<span id="cb4-29">          <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">selectInput</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"species"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">h3</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Espèces"</span>), </span>
<span id="cb4-30">                      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">choices =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Bar"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bar"</span>, </span>
<span id="cb4-31">                                     <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Bar moucheté"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bar_m"</span>, </span>
<span id="cb4-32">                                     <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Alose"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"alose"</span>,</span>
<span id="cb4-33">                                     <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Alose Feinte"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"alose_f"</span>,</span>
<span id="cb4-34">                                     <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Maquereau"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"maquereau"</span>, </span>
<span id="cb4-35">                                     <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Chinchard"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"chinchard"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">selected =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bar"</span>),</span>
<span id="cb4-36">          </span>
<span id="cb4-37">          <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sliderInput</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"length"</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">h3</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Taille du poisson"</span>),<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">value=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">min=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">80</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">step=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb4-38">          </span>
<span id="cb4-39">          <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">selectInput</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lure"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">h3</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Type de leurre"</span>), </span>
<span id="cb4-40">                      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">choices =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Shad"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"shad"</span>,</span>
<span id="cb4-41">                                     <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Slug"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"slug"</span>,</span>
<span id="cb4-42">                                     <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Jerkbait"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"jerkbait"</span>,</span>
<span id="cb4-43">                                     <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Casting jig"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"jig"</span>,</span>
<span id="cb4-44">                                     <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Topwater"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"topwater"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">selectize =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>),</span>
<span id="cb4-45">          </span>
<span id="cb4-46">          <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">selectInput</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"color_lure"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">h3</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Couleur du leurre"</span>), </span>
<span id="cb4-47">                      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">choices =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Naturel"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"naturel"</span>,</span>
<span id="cb4-48">                                     <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sombre"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sombre"</span>,</span>
<span id="cb4-49">                                     <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Clair"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"clair"</span>,</span>
<span id="cb4-50">                                     <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Flashy"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"flashy"</span> ), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">selectize =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>),</span>
<span id="cb4-51">          </span>
<span id="cb4-52">          <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">selectInput</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"length_lure"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">h3</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Taille du leurre"</span>), </span>
<span id="cb4-53">                      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">choices =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Petit"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"petit"</span>,</span>
<span id="cb4-54">                                     <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Moyen"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"moyen"</span>,</span>
<span id="cb4-55">                                     <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Grand"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grand"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">selectize =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>),</span>
<span id="cb4-56">          </span>
<span id="cb4-57">          <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">actionButton</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"catch"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Rajoutez cette capture aux stats!"</span>),</span>
<span id="cb4-58">          </span>
<span id="cb4-59">          <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">textInput</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"comments1"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">h3</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Commentaire avant la fin ?"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">value =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"NA"</span>)</span>
<span id="cb4-60">          </span>
<span id="cb4-61">          </span>
<span id="cb4-62">        )</span>
<span id="cb4-63">        </span>
<span id="cb4-64">        </span>
<span id="cb4-65">      }</span>
<span id="cb4-66">      </span>
<span id="cb4-67">    })  </span>
<span id="cb4-68">    </span>
<span id="cb4-69">    </span>
<span id="cb4-70">  }, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ignoreNULL =</span> F)</span>
<span id="cb4-71">  </span>
<span id="cb4-72">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#If the button is pushed, create the line to be added in the csv file. </span></span>
<span id="cb4-73">  </span>
<span id="cb4-74">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">observeEvent</span>(input<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>go,{</span>
<span id="cb4-75">    </span>
<span id="cb4-76">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#Tide + geoloc + Weather</span></span>
<span id="cb4-77">    c_tide <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unlist</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tide</span>())</span>
<span id="cb4-78">    geoloc <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(input<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>lat,input<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>long)</span>
<span id="cb4-79">    current.weather.info <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">weather</span>(geoloc) </span>
<span id="cb4-80">    </span>
<span id="cb4-81">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Two outcomes depending if the session starts or ends. This gives the possibility </span></span>
<span id="cb4-82">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># to the user to add a comment before starting the session or after ending the session</span></span>
<span id="cb4-83">    </span>
<span id="cb4-84">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rev</span>(dat<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Status)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"end"</span>){</span>
<span id="cb4-85">      </span>
<span id="cb4-86">      n_ses <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rev</span>(dat<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Session)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb4-87">      stat_ses <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"beg"</span>)</span>
<span id="cb4-88">      time_beg <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.character</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.POSIXct</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Sys.time</span>()))</span>
<span id="cb4-89">      comment <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> input<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>comments</span>
<span id="cb4-90">      dat.f <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(n_ses, stat_ses, time_beg ,geoloc[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>], geoloc[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], current.weather.info, c_tide[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], c_tide[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>], c_tide[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>], comment)</span>
<span id="cb4-91">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(dat.f)<span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(dat)</span>
<span id="cb4-92">      a <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rbind</span>(dat,dat.f)</span>
<span id="cb4-93">      </span>
<span id="cb4-94">    }<span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span>{</span>
<span id="cb4-95">      </span>
<span id="cb4-96">      n_ses <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rev</span>(dat<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Session)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])</span>
<span id="cb4-97">      stat_ses <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"end"</span>)</span>
<span id="cb4-98">      time_beg <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.character</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.POSIXct</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Sys.time</span>()))</span>
<span id="cb4-99">      comment1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> input<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>comments1</span>
<span id="cb4-100">      dat.f<span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(n_ses, stat_ses, time_beg ,geoloc[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>], geoloc[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], current.weather.info, c_tide[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], c_tide[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>], c_tide[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>], comment1)</span>
<span id="cb4-101">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(dat.f)<span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(dat)</span>
<span id="cb4-102">      a <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rbind</span>(dat,dat.f)</span>
<span id="cb4-103">    }</span>
<span id="cb4-104">    </span>
<span id="cb4-105">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Write csv in temporary files of shiny server </span></span>
<span id="cb4-106">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">write_csv</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.data.frame</span>(a), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"session.csv"</span>)</span>
<span id="cb4-107">    </span>
<span id="cb4-108">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Upload it to dropbox account </span></span>
<span id="cb4-109">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">drop_upload</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"session.csv"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">path =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"App_peche"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mode =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"overwrite"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dtoken =</span> token)</span>
<span id="cb4-110">  })</span>
<span id="cb4-111">  </span>
<span id="cb4-112">  </span>
<span id="cb4-113">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add a line to the catch csv file whenever a fish is caught</span></span>
<span id="cb4-114">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">observeEvent</span>(input<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>catch,{</span>
<span id="cb4-115">    caugth <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">drop_read_csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/app_peche/catch.csv"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">header =</span> T, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stringsAsFactors =</span> F, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dtoken =</span> token) </span>
<span id="cb4-116">    </span>
<span id="cb4-117">    n_ses <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rev</span>(dat<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Session)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])</span>
<span id="cb4-118">    time <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.POSIXct</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Sys.time</span>())</span>
<span id="cb4-119">    time_after_beg <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">difftime</span>(time, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rev</span>(dat<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Time)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">units =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mins"</span>)), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb4-120">    </span>
<span id="cb4-121">    catch <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(n_ses, </span>
<span id="cb4-122">                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">time =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.character</span>(time),</span>
<span id="cb4-123">                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">min_fishing =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.character</span>(time_after_beg),</span>
<span id="cb4-124">                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">species =</span> input<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>species,</span>
<span id="cb4-125">                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length =</span> input<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>length,</span>
<span id="cb4-126">                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lure =</span> input<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>lure,</span>
<span id="cb4-127">                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> input<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>color_lure,</span>
<span id="cb4-128">                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length_lure =</span> input<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>length_lure)</span>
<span id="cb4-129">    </span>
<span id="cb4-130">    b <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rbind</span>(caugth,catch)</span>
<span id="cb4-131">    </span>
<span id="cb4-132">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Write csv in temporary files of shiny server </span></span>
<span id="cb4-133">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">write_csv</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.data.frame</span>(b), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"catch.csv"</span>)</span>
<span id="cb4-134">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Upload it to dropbox account </span></span>
<span id="cb4-135">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">drop_upload</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"catch.csv"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">path =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"App_peche"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mode =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"overwrite"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dtoken =</span> token)</span>
<span id="cb4-136">  })</span>
<span id="cb4-137">  </span>
<span id="cb4-138">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create the map with the results of previous session depending on the choice of the user :</span></span>
<span id="cb4-139">  </span>
<span id="cb4-140">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">observeEvent</span>(input<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>radio,{</span>
<span id="cb4-141">    </span>
<span id="cb4-142">    output<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>map <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">renderLeaflet</span>({</span>
<span id="cb4-143">      map_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">map_choice</span>(input<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>radio)</span>
<span id="cb4-144">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">leaflet</span>(map_data) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">addTiles</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-145">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">addPopups</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lng =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>Long,</span>
<span id="cb4-146">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lat =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>Lat, </span>
<span id="cb4-147">                  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">with</span>(map_data,</span>
<span id="cb4-148">                       <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sprintf</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;b&gt;Session %.0f : %.1f h&lt;/b&gt; &lt;br/&gt; %s &lt;br/&gt; %.0f  poissons &lt;br/&gt; hauteur d'eau: %.0f m, %s, %.0f min après l'étal"</span>,</span>
<span id="cb4-149">                               n_ses,</span>
<span id="cb4-150">                               duration,</span>
<span id="cb4-151">                               Time,</span>
<span id="cb4-152">                               nb,</span>
<span id="cb4-153">                               Water_level,</span>
<span id="cb4-154">                               Tide_status,</span>
<span id="cb4-155">                               Tide_time)),</span>
<span id="cb4-156">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">options =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">popupOptions</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">maxWidth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">minWidth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>))</span>
<span id="cb4-157">    })</span>
<span id="cb4-158">    </span>
<span id="cb4-159">  })</span>
<span id="cb4-160">  </span>
<span id="cb4-161">}</span></code></pre></div>
</div>
</section>
</section>
<section id="conclusion-and-future-improvments" class="level2">
<h2 class="anchored" data-anchor-id="conclusion-and-future-improvments">Conclusion and future improvments</h2>
<p>You can find a dummy example of this application (not linked to the dropbox account) <a href="https://aureliencallens.shinyapps.io/Dummy_angler_app/" target="_blank">here</a>. I have been using this application for 1 year without any problems! The data I collected will be presented in the next post.</p>
<p>In the coming months, I must find a new free API to replace the actual one. Indeed, the weather API I am using has been bought by Apple and the free requests will be stopped in the following year.</p>


</section>

<a onclick="window.scrollTo(0, 0); return false;" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a> ]]></description>
  <category>R</category>
  <category>Shiny</category>
  <category>Web scraping</category>
  <guid>https://aureliencallens.github.io/posts/2020-09-12-datascience-fishing-part1/index.html</guid>
  <pubDate>Fri, 11 Sep 2020 22:00:00 GMT</pubDate>
  <media:content url="https://aureliencallens.github.io/posts/2020-09-12-datascience-fishing-part1/images/seabass_bay.jpg" medium="image" type="image/jpeg"/>
</item>
</channel>
</rss>
