{
  "hash": "d7287b57f92707667520677c4cf95625",
  "result": {
    "markdown": "---\ntitle: \"Can R and Shiny make me a better fisherman? Part 2\"\nsubtitle: \"Exploratory analysis on my fishing data\"\nauthor: \"Aur√©lien Callens\"\ndate: \"2020-09-25\"\nformat: \n  html:\n    code-fold: true\n    code-tools: true\n    code-summary: \"Show the code\"\nexecute:\n  freeze: true\ntoc: true\ncategories:\n  - R\n  - EDA\n---\n\n\n\n\nIn the previous blog article, I described in details how I built a shiny application that stores data about my fishing sessions. In this post, I will explore the data I have collected during the last year. \n\n \nTo sum up, my application store the data in two csv files. The first one contains variables related to the fishing conditions at the beginning and at the end of the session such as : \n\n+ Time \n+ Longitude and Latitude\n+ Meteorological conditions (9 in total : Air temperature, Atmospheric pressure, Wind speed and direction ...)\n+ Tide conditions (Current water level, Tide status and Time since the tide peak)\n+ Specific comments\n\nThe second one contains information about my catches : \n\n+ Time when caught \n+ Time since the beginning of the session \n+ Species \n+ Length of the fish \n+ Fishing lure used\n+ Color of the fishing lure \n+ Length of the lure\n\n## Importing and cleaning my fishing data \n\nThe first step of this analysis is to import both csv files and make some transformations. \n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Change character variables to factor\nsession_data %<>% \nmutate_at(vars(Weather, Tide_status), as.factor)\n\n# Change character variables to factor\ncatch_data %<>% \nmutate_at(vars(species, lure, colour, length_lure), as.factor)\n```\n:::\n\n\n\n&nbsp;\n\nAfter cleaning and rearranging the data (code hidden below), we are ready to explore \ngraphically our data! \n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Compute mean conditions (between beg and end session) \n\nmean_weather_cond <- session_data %>% \ngroup_by(Session) %>% \nselect(-c(Long, Lat, Water_level, Tide_time)) %>% \nsummarise_if(is.numeric, mean) \n\n\n# Extract fixed conditions and comments + join with mean cond \n\nfixed_cond_com <- session_data %>% \ngroup_by(Session) %>% \nselect(Session, Comments, Long, Lat, Weather) %>% \nmutate(Comments_parsed = paste(na.omit(Comments), collapse = \"\")) %>% \nselect(-Comments) %>% \nslice(1) %>% \ninner_join(mean_weather_cond, by = \"Session\")\n\n# Create end and beg variables for WL, Time , Tide_time, Tide_status\n\nbeg_end_vars <- session_data %>% \nselect(Session, Status, Water_level, Time, Tide_time, Tide_status) %>% \npivot_wider(names_from = Status,\nvalues_from = c(Time, Water_level,  Tide_time, Tide_status))\n\n\n# Assemble both file and calculate duration\n\ndat_ses <-  inner_join(beg_end_vars,\nfixed_cond_com,\nby = \"Session\")\n\n# Calculate duration of the sessions\n\ndat_ses %<>% \nmutate(duration = round(difftime(Time_end,  Time_beg,  units = \"hours\"),\ndigits = 1))\n\ncatch_cond <- full_join(dat_ses,\ncatch_data, by = c( \"Session\" = \"n_ses\" )) %>% \nmutate(Session = factor(Session, levels = 1:length(dat_ses$Session)))\n\ncatch_cond %<>%\nmutate(Tide_status_ses = paste0(Tide_status_beg, \"_\", Tide_status_end))\n\n# Simplify the Tide status variable\n\ncatch_cond$Tide_status_ses <- sapply(catch_cond$Tide_status_ses , function(x){switch(x, \n\"Up_Dead\" = \"Up\",\n\"Up_Up\" = \"Up\",\n\"Up_Down\" = \"Dead\",\n\"Down_Dead\" = \"Down\",\n\"Down_Up\" = \"Dead\",\n\"Down_Down\"  = \"Down\",\n\"Dead_Dead\" = \"Dead\",\n\"Dead_Up\" = \"Up\",\n\"Dead_Down\" = \"Down\"\n)}, USE.NAMES = F)\n```\n:::\n\n\n\n## Graphical exploration\n\n### Where did I fish ? \n\nWe can visualize the locations I fished the most by using the *leaflet* package: \n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Calculate the number of fish caught by session \nfish_number <-  catch_cond  %>% na.omit() %>% group_by(Session) %>%  summarise(nb = length(Session))\n\n# Dataframe with variables we want to show on the map\nmap_data <- catch_cond %>% \ngroup_by(Session) %>%\nselect(Session, Time_beg, Time_end, Long,\nLat, Water_level_beg, Tide_status_beg, Tide_time_beg, duration) \n\nmap_data <- full_join(map_data, fish_number)\n\nmap_data$nb[is.na(map_data$nb)] <- 0\n\n# Interactive map with Popup for each session\nlibrary(leaflet)\n\nleaflet(map_data, width = \"100%\") %>% addTiles() %>%\naddPopups(lng = ~Long, lat = ~Lat, \nwith(map_data, sprintf(\"<b>Session %.0f : %.1f h</b> <br/> %s <br/> %.0f  fish <br/> Water level: %.0f m, %s, %.0f min since last peak\",                                         Session, duration,  Time_beg, nb, Water_level_beg, Tide_status_beg, Tide_time_beg)), \noptions = popupOptions(maxWidth = 100, minWidth = 50))\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"htmlwidget-12a4ef9bdc585990d0ef\" style=\"width:100%;height:480px;\" class=\"leaflet html-widget\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-12a4ef9bdc585990d0ef\">{\"x\":{\"options\":{\"crs\":{\"crsClass\":\"L.CRS.EPSG3857\",\"code\":null,\"proj4def\":null,\"projectedBounds\":null,\"options\":{}}},\"calls\":[{\"method\":\"addTiles\",\"args\":[\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\",null,null,{\"minZoom\":0,\"maxZoom\":18,\"tileSize\":256,\"subdomains\":\"abc\",\"errorTileUrl\":\"\",\"tms\":false,\"noWrap\":false,\"zoomOffset\":0,\"zoomReverse\":false,\"opacity\":1,\"zIndex\":1,\"detectRetina\":false,\"attribution\":\"&copy; <a href=\\\"https://openstreetmap.org/copyright/\\\">OpenStreetMap<\\/a>,  <a href=\\\"https://opendatacommons.org/licenses/odbl/\\\">ODbL<\\/a>\"}]},{\"method\":\"addPopups\",\"args\":[[43.4903501,43.4903501,43.4903501,43.4948349,43.4948349,43.4948349,43.4948349,43.4948349,43.4929536,43.4929536,43.4717306,43.4856133,43.4856133,43.4898314,43.4879548,43.4891374,43.4888454,43.4903375,43.4907003,43.4883211,43.4870525,43.4882129,43.4902466,43.4879819,43.4879819,43.489656,43.4667765,43.4854263,43.4888221,43.4884741,43.4854276,43.4854276,43.4854276,43.490646,43.490646,43.490646,43.4884784,43.4891888,43.4885291,43.4885291,43.4849954,43.4849954,43.4849954,43.4853693,43.4865331,43.4853571,43.4881548,43.4865984,43.4895741,43.4831239,43.4831239,43.4831239,43.4831239,43.4831239,43.4831239,43.4831239,43.484568,43.484568,43.484568,43.484568,43.484568,43.4893757,43.4893757,43.4893757,43.4893757,43.4893757,43.4893757,43.4893757,43.4893757,43.4893757,43.4893757,43.4893757,43.4893757,43.4850086,43.4850086,43.4850086,43.488591,43.488659,43.4833471],[-1.474845,-1.474845,-1.474845,-1.4702738,-1.4702738,-1.4702738,-1.4702738,-1.4702738,-1.4727054,-1.4727054,-1.4726262,-1.4762295,-1.4762295,-1.4645089,-1.4741375,-1.4619148,-1.4750443,-1.4523802,-1.471115,-1.4737693,-1.4741375,-1.4648611,-1.4522513,-1.4720217,-1.4720217,-1.4784552,-1.4835086,-1.4752964,-1.4768579,-1.4752235,-1.4752846,-1.4752846,-1.4752846,-1.4753465,-1.4753465,-1.4753465,-1.4801831,-1.4717195,-1.4740189,-1.4740189,-1.5000672,-1.5000672,-1.5000672,-1.4762834,-1.4757226,-1.4762743,-1.4748271,-1.4754897,-1.4745318,-1.4726297,-1.4726297,-1.4726297,-1.4726297,-1.4726297,-1.4726297,-1.4726297,-1.4745762,-1.4745762,-1.4745762,-1.4745762,-1.4745762,-1.474431,-1.474431,-1.474431,-1.474431,-1.474431,-1.474431,-1.474431,-1.474431,-1.474431,-1.474431,-1.474431,-1.474431,-1.4765871,-1.4765871,-1.4765871,-1.4750231,-1.4743773,-1.4702696],[\"<b>Session 1 : 0.9 h<\\/b> <br/> 2019-04-09 19:23:09 <br/> 3  fish <br/> Water level: 4 m, Up, 340 min since last peak\",\"<b>Session 1 : 0.9 h<\\/b> <br/> 2019-04-09 19:23:09 <br/> 3  fish <br/> Water level: 4 m, Up, 340 min since last peak\",\"<b>Session 1 : 0.9 h<\\/b> <br/> 2019-04-09 19:23:09 <br/> 3  fish <br/> Water level: 4 m, Up, 340 min since last peak\",\"<b>Session 2 : 2.1 h<\\/b> <br/> 2019-04-10 18:23:40 <br/> 5  fish <br/> Water level: 3 m, Up, 240 min since last peak\",\"<b>Session 2 : 2.1 h<\\/b> <br/> 2019-04-10 18:23:40 <br/> 5  fish <br/> Water level: 3 m, Up, 240 min since last peak\",\"<b>Session 2 : 2.1 h<\\/b> <br/> 2019-04-10 18:23:40 <br/> 5  fish <br/> Water level: 3 m, Up, 240 min since last peak\",\"<b>Session 2 : 2.1 h<\\/b> <br/> 2019-04-10 18:23:40 <br/> 5  fish <br/> Water level: 3 m, Up, 240 min since last peak\",\"<b>Session 2 : 2.1 h<\\/b> <br/> 2019-04-10 18:23:40 <br/> 5  fish <br/> Water level: 3 m, Up, 240 min since last peak\",\"<b>Session 3 : 2.3 h<\\/b> <br/> 2019-04-17 20:45:27 <br/> 2  fish <br/> Water level: 1 m, Down, 305 min since last peak\",\"<b>Session 3 : 2.3 h<\\/b> <br/> 2019-04-17 20:45:27 <br/> 2  fish <br/> Water level: 1 m, Down, 305 min since last peak\",\"<b>Session 4 : 0.8 h<\\/b> <br/> 2019-04-21 17:58:26 <br/> 0  fish <br/> Water level: 4 m, Up, 320 min since last peak\",\"<b>Session 5 : 2.0 h<\\/b> <br/> 2019-04-22 18:18:23 <br/> 2  fish <br/> Water level: 4 m, Up, 305 min since last peak\",\"<b>Session 5 : 2.0 h<\\/b> <br/> 2019-04-22 18:18:23 <br/> 2  fish <br/> Water level: 4 m, Up, 305 min since last peak\",\"<b>Session 6 : 1.0 h<\\/b> <br/> 2019-04-26 18:30:25 <br/> 0  fish <br/> Water level: 2 m, Up, 110 min since last peak\",\"<b>Session 7 : 0.6 h<\\/b> <br/> 2019-05-06 18:38:02 <br/> 0  fish <br/> Water level: 4 m, Dead, 15 min since last peak\",\"<b>Session 8 : 0.8 h<\\/b> <br/> 2019-05-10 19:37:30 <br/> 0  fish <br/> Water level: 3 m, Up, 265 min since last peak\",\"<b>Session 9 : 1.6 h<\\/b> <br/> 2019-05-10 20:23:30 <br/> 1  fish <br/> Water level: 4 m, Up, 315 min since last peak\",\"<b>Session 10 : 1.0 h<\\/b> <br/> 2019-05-16 16:08:35 <br/> 0  fish <br/> Water level: 4 m, Dead, 30 min since last peak\",\"<b>Session 11 : 0.9 h<\\/b> <br/> 2019-05-21 19:18:50 <br/> 0  fish <br/> Water level: 4 m, Dead, 15 min since last peak\",\"<b>Session 12 : 0.6 h<\\/b> <br/> 2019-05-23 19:45:32 <br/> 0  fish <br/> Water level: 4 m, Up, 330 min since last peak\",\"<b>Session 13 : 2.2 h<\\/b> <br/> 2019-05-29 18:50:42 <br/> 1  fish <br/> Water level: 2 m, Down, 290 min since last peak\",\"<b>Session 14 : 1.6 h<\\/b> <br/> 2019-05-30 13:27:48 <br/> 0  fish <br/> Water level: 3 m, Up, 295 min since last peak\",\"<b>Session 15 : 0.9 h<\\/b> <br/> 2019-06-01 15:28:24 <br/> 0  fish <br/> Water level: 4 m, Up, 335 min since last peak\",\"<b>Session 16 : 0.8 h<\\/b> <br/> 2019-06-01 21:28:06 <br/> 2  fish <br/> Water level: 1 m, Down, 325 min since last peak\",\"<b>Session 16 : 0.8 h<\\/b> <br/> 2019-06-01 21:28:06 <br/> 2  fish <br/> Water level: 1 m, Down, 325 min since last peak\",\"<b>Session 17 : 1.2 h<\\/b> <br/> 2019-06-02 14:26:22 <br/> 0  fish <br/> Water level: 3 m, Up, 235 min since last peak\",\"<b>Session 18 : 1.0 h<\\/b> <br/> 2019-06-07 19:20:32 <br/> 0  fish <br/> Water level: 4 m, Up, 315 min since last peak\",\"<b>Session 19 : 1.6 h<\\/b> <br/> 2019-06-19 18:13:14 <br/> 0  fish <br/> Water level: 4 m, Up, 340 min since last peak\",\"<b>Session 20 : 1.1 h<\\/b> <br/> 2019-06-22 20:38:02 <br/> 0  fish <br/> Water level: 4 m, Dead, 370 min since last peak\",\"<b>Session 21 : 0.8 h<\\/b> <br/> 2019-06-26 20:13:34 <br/> 1  fish <br/> Water level: 2 m, Up, 115 min since last peak\",\"<b>Session 22 : 0.2 h<\\/b> <br/> 2019-06-27 20:05:43 <br/> 3  fish <br/> Water level: 2 m, Up, 45 min since last peak\",\"<b>Session 22 : 0.2 h<\\/b> <br/> 2019-06-27 20:05:43 <br/> 3  fish <br/> Water level: 2 m, Up, 45 min since last peak\",\"<b>Session 22 : 0.2 h<\\/b> <br/> 2019-06-27 20:05:43 <br/> 3  fish <br/> Water level: 2 m, Up, 45 min since last peak\",\"<b>Session 23 : 3.3 h<\\/b> <br/> 2019-06-28 18:55:31 <br/> 3  fish <br/> Water level: 2 m, Down, 295 min since last peak\",\"<b>Session 23 : 3.3 h<\\/b> <br/> 2019-06-28 18:55:31 <br/> 3  fish <br/> Water level: 2 m, Down, 295 min since last peak\",\"<b>Session 23 : 3.3 h<\\/b> <br/> 2019-06-28 18:55:31 <br/> 3  fish <br/> Water level: 2 m, Down, 295 min since last peak\",\"<b>Session 24 : 1.4 h<\\/b> <br/> 2019-07-13 19:06:20 <br/> 0  fish <br/> Water level: 2 m, Down, 250 min since last peak\",\"<b>Session 25 : 0.2 h<\\/b> <br/> 2019-08-13 21:35:09 <br/> 0  fish <br/> Water level: 1 m, Down, 310 min since last peak\",\"<b>Session 26 : 1.3 h<\\/b> <br/> 2020-05-20 20:47:38 <br/> 2  fish <br/> Water level: 2 m, Down, 270 min since last peak\",\"<b>Session 26 : 1.3 h<\\/b> <br/> 2020-05-20 20:47:38 <br/> 2  fish <br/> Water level: 2 m, Down, 270 min since last peak\",\"<b>Session 27 : 0.0 h<\\/b> <br/> 2020-05-22 22:51:04 <br/> 3  fish <br/> Water level: 1 m, Down, 325 min since last peak\",\"<b>Session 27 : 0.0 h<\\/b> <br/> 2020-05-22 22:51:04 <br/> 3  fish <br/> Water level: 1 m, Down, 325 min since last peak\",\"<b>Session 27 : 0.0 h<\\/b> <br/> 2020-05-22 22:51:04 <br/> 3  fish <br/> Water level: 1 m, Down, 325 min since last peak\",\"<b>Session 28 : 1.4 h<\\/b> <br/> 2020-05-25 20:44:09 <br/> 1  fish <br/> Water level: 4 m, Down, 110 min since last peak\",\"<b>Session 29 : 1.2 h<\\/b> <br/> 2020-05-26 21:22:28 <br/> 0  fish <br/> Water level: 4 m, Down, 95 min since last peak\",\"<b>Session 30 : 1.3 h<\\/b> <br/> 2020-06-01 20:55:54 <br/> 1  fish <br/> Water level: 2 m, Up, 70 min since last peak\",\"<b>Session 31 : 2.3 h<\\/b> <br/> 2020-06-08 19:56:35 <br/> 0  fish <br/> Water level: 4 m, Down, 40 min since last peak\",\"<b>Session 32 : 2.0 h<\\/b> <br/> 2020-06-15 20:30:55 <br/> 0  fish <br/> Water level: 2 m, Up, 50 min since last peak\",\"<b>Session 33 : 1.1 h<\\/b> <br/> 2020-06-30 20:59:48 <br/> 0  fish <br/> Water level: 2 m, Up, 105 min since last peak\",\"<b>Session 34 : 2.5 h<\\/b> <br/> 2020-07-16 21:58:40 <br/> 0  fish <br/> Water level: 2 m, Up, 80 min since last peak\",\"<b>Session 34 : 2.5 h<\\/b> <br/> 2020-07-16 21:58:40 <br/> 0  fish <br/> Water level: 2 m, Up, 80 min since last peak\",\"<b>Session 34 : 2.5 h<\\/b> <br/> 2020-07-16 21:58:40 <br/> 0  fish <br/> Water level: 2 m, Up, 80 min since last peak\",\"<b>Session 34 : 2.5 h<\\/b> <br/> 2020-07-16 21:58:40 <br/> 0  fish <br/> Water level: 2 m, Up, 80 min since last peak\",\"<b>Session 34 : 2.5 h<\\/b> <br/> 2020-07-16 21:58:40 <br/> 0  fish <br/> Water level: 2 m, Up, 80 min since last peak\",\"<b>Session 34 : 2.5 h<\\/b> <br/> 2020-07-16 21:58:40 <br/> 0  fish <br/> Water level: 2 m, Up, 80 min since last peak\",\"<b>Session 34 : 2.5 h<\\/b> <br/> 2020-07-16 21:58:40 <br/> 0  fish <br/> Water level: 2 m, Up, 80 min since last peak\",\"<b>Session 35 : 2.6 h<\\/b> <br/> 2020-07-17 21:51:40 <br/> 0  fish <br/> Water level: 2 m, Up, 20 min since last peak\",\"<b>Session 35 : 2.6 h<\\/b> <br/> 2020-07-17 21:51:40 <br/> 0  fish <br/> Water level: 2 m, Up, 20 min since last peak\",\"<b>Session 35 : 2.6 h<\\/b> <br/> 2020-07-17 21:51:40 <br/> 0  fish <br/> Water level: 2 m, Up, 20 min since last peak\",\"<b>Session 35 : 2.6 h<\\/b> <br/> 2020-07-17 21:51:40 <br/> 0  fish <br/> Water level: 2 m, Up, 20 min since last peak\",\"<b>Session 35 : 2.6 h<\\/b> <br/> 2020-07-17 21:51:40 <br/> 0  fish <br/> Water level: 2 m, Up, 20 min since last peak\",\"<b>Session 36 : 1.5 h<\\/b> <br/> 2020-07-18 23:25:07 <br/> 0  fish <br/> Water level: 2 m, Up, 80 min since last peak\",\"<b>Session 36 : 1.5 h<\\/b> <br/> 2020-07-18 23:25:07 <br/> 0  fish <br/> Water level: 2 m, Up, 80 min since last peak\",\"<b>Session 36 : 1.5 h<\\/b> <br/> 2020-07-18 23:25:07 <br/> 0  fish <br/> Water level: 2 m, Up, 80 min since last peak\",\"<b>Session 36 : 1.5 h<\\/b> <br/> 2020-07-18 23:25:07 <br/> 0  fish <br/> Water level: 2 m, Up, 80 min since last peak\",\"<b>Session 36 : 1.5 h<\\/b> <br/> 2020-07-18 23:25:07 <br/> 0  fish <br/> Water level: 2 m, Up, 80 min since last peak\",\"<b>Session 36 : 1.5 h<\\/b> <br/> 2020-07-18 23:25:07 <br/> 0  fish <br/> Water level: 2 m, Up, 80 min since last peak\",\"<b>Session 36 : 1.5 h<\\/b> <br/> 2020-07-18 23:25:07 <br/> 0  fish <br/> Water level: 2 m, Up, 80 min since last peak\",\"<b>Session 36 : 1.5 h<\\/b> <br/> 2020-07-18 23:25:07 <br/> 0  fish <br/> Water level: 2 m, Up, 80 min since last peak\",\"<b>Session 36 : 1.5 h<\\/b> <br/> 2020-07-18 23:25:07 <br/> 0  fish <br/> Water level: 2 m, Up, 80 min since last peak\",\"<b>Session 36 : 1.5 h<\\/b> <br/> 2020-07-18 23:25:07 <br/> 0  fish <br/> Water level: 2 m, Up, 80 min since last peak\",\"<b>Session 36 : 1.5 h<\\/b> <br/> 2020-07-18 23:25:07 <br/> 0  fish <br/> Water level: 2 m, Up, 80 min since last peak\",\"<b>Session 36 : 1.5 h<\\/b> <br/> 2020-07-18 23:25:07 <br/> 0  fish <br/> Water level: 2 m, Up, 80 min since last peak\",\"<b>Session 37 : 1.6 h<\\/b> <br/> 2020-09-04 20:50:17 <br/> 3  fish <br/> Water level: 3 m, Down, 125 min since last peak\",\"<b>Session 37 : 1.6 h<\\/b> <br/> 2020-09-04 20:50:17 <br/> 3  fish <br/> Water level: 3 m, Down, 125 min since last peak\",\"<b>Session 37 : 1.6 h<\\/b> <br/> 2020-09-04 20:50:17 <br/> 3  fish <br/> Water level: 3 m, Down, 125 min since last peak\",\"<b>Session 38 : 0.6 h<\\/b> <br/> 2020-09-13 21:33:41 <br/> 0  fish <br/> Water level: 2 m, Up, 50 min since last peak\",\"<b>Session 39 : 0.2 h<\\/b> <br/> 2020-09-23 19:35:26 <br/> 1  fish <br/> Water level: 3 m, Up, 230 min since last peak\",\"<b>Session 40 : 0.6 h<\\/b> <br/> 2020-10-09 21:17:36 <br/> 0  fish <br/> Water level: 3 m, Up, 315 min since last peak\"],null,null,{\"maxWidth\":100,\"minWidth\":50,\"autoPan\":true,\"keepInView\":false,\"closeButton\":true,\"className\":\"\"}]}],\"limits\":{\"lat\":[43.4667765,43.4948349],\"lng\":[-1.5000672,-1.4522513]}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\nAs you see I fish mostly in the Nive river that is flowing through Bayonne city. \n\n### When it is best to fish ? \n\n#### Time of the year \n\nThe following graph shows the number of fish caught depending on the time of the year : \n\n\n::: {.cell}\n\n```{.r .cell-code}\ncatch_cond %>% \ngroup_by(Session, Time_beg, .drop = F) %>% \nna.omit() %>% \nsummarise(n_catch = n()) %>% \nright_join(unique(catch_cond[, c(\"Session\", \"Time_beg\")])) %>% \nmutate(n_catch = ifelse(is.na(n_catch), 0, n_catch )) %>%\nggplot(aes(y = n_catch, x =Time_beg)) +\ngeom_point( size = 2) + \n  theme_minimal() + labs(x = \"Date\", y = \"Number of catch\") + scale_x_datetime(date_labels = \"%d/%m/%y\", date_breaks = \"3 months\") \n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\nFrom this graph we see that I didn't go fishing during the autumn and winter of 2019, I don't have any data. Unfortunately for me, autumn is known to be a great period for sea bass fishing, I must go fishing this year to compensate the lack of data in this season. During winter, fishing is really complicated because the large majority of sea bass are returned to the ocean.\n\n#### Time of the day \n\nThis graph shows the number of fish I catch depending on the hour of the day :\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncatch_cond %>% \ngroup_by(Session, Time_beg, .drop = F) %>% \nna.omit() %>% \nsummarise(n_catch = n()) %>% \nright_join(unique(catch_cond[, c(\"Session\", \"Time_beg\")])) %>% \nmutate(n_catch = ifelse(is.na(n_catch), 0, n_catch ), \nhour = format(Time_beg, \"%H\")) %>%\nggplot(aes(y = n_catch, x =hour)) +\ngeom_point( size = 2)  + labs(x = \"Hour\", y = \"Number of catch\")+\ntheme_minimal()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\nI mostly fish after work or during evenings. To draw relevant conclusions about the influence of the fishing hour, I have to go fishing at different hours of the day (in the morning for example). \n\n#### The tide \n\nThe tide is an important parameter for fishing in estuaries. Let's see the effect of the tide current on my catches: \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggpubr)\n\ngg1 <- catch_cond %>% \n  group_by(Session, Tide_status_ses, .drop = F)  %>%  \n  drop_na() %>% \n  summarise(n_catch = n()) %>% \n  right_join(unique(catch_cond[, c(\"Session\", \"Tide_status_ses\")])) %>% \n  mutate(n_catch = ifelse(is.na(n_catch), 0, n_catch )) %>%\n  ggplot(aes(y = n_catch, x = Tide_status_ses, fill = Tide_status_ses)) +\n  geom_boxplot() +\n  labs(x = \"Status of tide current\", y = \"Number of catch\") +\n  theme_minimal()+ theme(legend.position=\"None\")\n\ngg2 <- catch_cond %>% \n  na.omit() %>% \n  ggplot(aes(y = length,x = Tide_status_ses, fill = Tide_status_ses)) +\n  geom_boxplot()+\n  labs(x = \"Status of tide current\", y = \"Length of the fish\") +\n  theme_minimal()+ theme(legend.position=\"None\")\n\nggarrange(gg1, gg2)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\nIt seems that the status of the tide current does not influence the number of my catch but influences the length of the fish. I tend to catch bigger fish when the current is going down. \n\n### Does the moon affect my fishing results? \n\nA widespread belief among fishermen is that the moon influences greatly the behavior of the fish. Data about the moon phase were available thanks to the weather API, I decided to record this variable to investigate if the belief was true. The two graphs show the number and length of fish depending on the phase of moon (0 corresponding to new moon and 1 to full moon):\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngg3 <- catch_cond %>% \n  group_by(Session, Moon, .drop = F) %>%  \n  na.omit() %>% \n  summarise(n_catch = n()) %>% \n  right_join(unique(catch_cond[, c(\"Session\", \"Moon\")])) %>% \n  mutate(n_catch = ifelse(is.na(n_catch), 0, n_catch )) %>% \n  ggplot(aes(y = n_catch, x = Moon)) +\n  geom_point( size = 2) +\n  labs(x = \"Moon phase\", y = \"Number of catch\")+\n  theme_minimal()\n\ngg4 <- catch_cond %>% \n  ggplot(aes(y = length, x = Moon)) +\n  geom_point( size = 2) +\n  geom_smooth(method=\"lm\", se=T) + \n  labs(x = \"Moon phase\", y = \"Length of the fish\")+\n  theme_minimal()\n\nggarrange(gg3, gg4)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\nThe phase of the moon does not seem to influence the number of fish I catch during a session. However, I tend to catch bigger fish the closer we are to the full moon. To confirm this observation, I need to keep going fishing to get more data ! \n\n\n### Does the weather affect my fishing results? \n\nWe can look at the number of fish caught during different weather conditions:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# precipitation probability \n\ngg5 <- catch_cond %>% \n  group_by(Session, Preci_prob, .drop = F) %>%  \n  na.omit() %>% \n  summarise(n_catch = n()) %>% \n  right_join(unique(catch_cond[, c(\"Session\", \"Preci_prob\")])) %>% \n  mutate(n_catch = ifelse(is.na(n_catch), 0, n_catch )) %>% \n  ggplot(aes(y = n_catch, x = Preci_prob)) +\n  geom_point()+\n  labs(x = \"Precipitation prob.\", y = \"Number of catch\")+\n  theme_minimal()\n\n# Atm pressure \n\ngg6 <- catch_cond %>% \n  group_by(Session, Atm_pres, .drop = F) %>%  \n  na.omit() %>% \n  summarise(n_catch = n()) %>% \n  right_join(unique(catch_cond[, c(\"Session\", \"Atm_pres\")])) %>% \n  mutate(n_catch = ifelse(is.na(n_catch), 0, n_catch )) %>% \n  ggplot(aes(y = n_catch, x = Atm_pres)) +\n  geom_point() +\n  labs(x = \"Atm. pressure\", y = \"Number of catch\")+\n  theme_minimal()\n\n#Air temp\n\ngg7 <- catch_cond %>% \n  group_by(Session, Air_temp, .drop = F) %>%  \n  na.omit() %>% \n  summarise(n_catch = n()) %>% \n  right_join(unique(catch_cond[, c(\"Session\", \"Air_temp\")])) %>% \n  mutate(n_catch = ifelse(is.na(n_catch), 0, n_catch )) %>% \n  ggplot(aes(y = n_catch, x = Air_temp)) +\n  geom_point() +\n  labs(x = \"Air temp.\", y = \"Number of catch\")+\n  theme_minimal()\n\n\n#Cloud cover\n\ngg8 <- catch_cond %>% \n  group_by(Session, Cloud_cover, .drop = F) %>%  \n  na.omit() %>% \n  summarise(n_catch = n()) %>% \n  right_join(unique(catch_cond[, c(\"Session\", \"Cloud_cover\")])) %>% \n  mutate(n_catch = ifelse(is.na(n_catch), 0, n_catch )) %>% \n  ggplot(aes(y = n_catch, x = Cloud_cover)) +\n  geom_point() +\n  labs(x = \"Cloud cover\", y = \"Number of catchh\")+\n  theme_minimal()\n\nggarrange(gg5, gg6, gg7, gg8)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n\n\nAnd to their length :\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngg15 <- catch_cond %>% \n  ggplot(aes(y = length, x = Preci_prob)) +\n  geom_point( size = 2) +\n  labs( y = \"Length of the fish\")+\n  theme_minimal()\n\ngg16 <- catch_cond %>% \n  ggplot(aes(y = length, x = Atm_pres)) +\n  geom_point( size = 2) +\n  labs( y = \"Length of the fish\")+\n  theme_minimal()\n\ngg17 <- catch_cond %>% \n  ggplot(aes(y = length, x = Air_temp)) +\n  geom_point( size = 2) +\n  labs( y = \"Length of the fish\")+\n  theme_minimal()\n\n\ngg18  <- catch_cond %>% \n  ggplot(aes(y = length, x = Cloud_cover)) +\n  geom_point( size = 2) +\n  labs( y = \"Length of the fish\")+\n  theme_minimal()\n\nggarrange(gg15, gg16, gg17, gg18)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\nBecause we have limited data and not all weather conditions are covered, it is difficult to draw any conclusions.\n\n### What are the best lures to catch fish ?\n\nEach time I catch a fish, I fill a form with my shiny application in order to record the characteristics of the lure used. There are different types of lures that have specific swimming patterns, different colors and size. We can represent the number of fish caught depending on the lure characteristics: \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlevels(catch_cond$colour) <- c(\"clear\", \"natural\", \"dark\")\nlevels(catch_cond$length_lure) <- c(\"large\", \"medium\", \"small\")\n\ngg9 <- catch_cond %>% \n  na.omit() %>% \n  ggplot( aes(x=lure, fill = lure)) +\n  geom_bar(stat=\"count\", width=0.7)+\n  labs(x = \"Type of lure\", y = \"\")+\n  theme_minimal()+ \n  theme(legend.position=\"None\")\n\ngg10 <- catch_cond %>% \n  na.omit() %>% \n  ggplot( aes(x=colour, fill = colour)) +\n  geom_bar(stat=\"count\", width=0.7)+\n  labs(x = \"Color of the lures\", y = \"\")+\n  theme_minimal()+\n    scale_fill_brewer(palette=\"BuPu\")+ \n  theme(legend.position=\"None\")\n\ngg11 <- catch_cond %>% \n  na.omit() %>%\n  ggplot( aes(x=length_lure, fill = length_lure)) +\n  geom_bar(stat=\"count\", width=0.7)+\n  labs(x = \"Size of the lure\", y = \"\")+\n    scale_fill_brewer(palette=\"Dark2\")+\n  theme_minimal()+ theme(legend.position=\"None\")\n\nannotate_figure(ggarrange(gg9, gg10, gg11, ncol = 3),\n                left = text_grob(\"Number of catch\", rot = 90)\n)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\nWe can do the same for the length of fish caught:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngg12 <-catch_cond %>% \n  na.omit() %>% \n  ggplot(aes(y = length, x = lure, fill=lure)) +\n  geom_boxplot()+\n  labs(x = \"Type of lure\", y = \"\")+\n  theme_minimal()+ theme(legend.position=\"None\")\n\ngg13 <-catch_cond %>% \n  na.omit() %>%\n  ggplot(aes(y = length, x = colour, fill= colour)) +\n  geom_boxplot()+\n  labs(x = \"Color of the lures\", y = \"\")+\n  theme_minimal()+\n    scale_fill_brewer(palette=\"BuPu\")+ theme(legend.position=\"None\")\n\ngg14 <-catch_cond %>% \n  na.omit() %>%\n  ggplot(aes(y = length, x = length_lure, fill=length_lure)) +\n  geom_boxplot()+\n  labs(x = \"Size of the lure\", y = \"\")+\n  theme_minimal()+\n    scale_fill_brewer(palette=\"Dark2\")+ theme(legend.position=\"None\")\n\nannotate_figure(ggarrange(gg12, gg13, gg14, ncol = 3),\n                left = text_grob(\"Length of fish\", rot = 90)\n)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\nWith these 6 graphs, we can see that the most successful types of lures for me are the shad and slug types. An honorable mention is the jerkbait type: it only accounts for 2 fish, but 2 big fish (median around 47cm). The colors that worked best for me were clear and natural. For the size of the lure, bigger lures tend to catch bigger fish in average. These conclusions must be taken with a grain of salt because we do not know the time spent with each lure before catching a fish. In addition, I tend to use the same types and colors of lures (habits), I should vary more. \n\n## Conclusion\n\nAnalyzing my fishing data was very interesting and it brought me some insights on my fishing style! I understood that I was fishing almost the same way with the same habits. Although it seems to be working for me, I have a biased view on how to catch European sea bass. I must use bigger lures to catch bigger fish and I must vary the types of lures used. Indeed, I fish most of the times with slug or shad lures, hence the higher number of fish caught with these types of lures. \n\nI will keep using the application to gather more data and have a better understanding on my fishing session. I will keep you updated on the results ! :wink:\n\n\n\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../site_libs/htmlwidgets-1.6.4/htmlwidgets.js\"></script>\n<script src=\"../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js\"></script>\n<link href=\"../../site_libs/leaflet-1.3.1/leaflet.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/leaflet-1.3.1/leaflet.js\"></script>\n<link href=\"../../site_libs/leafletfix-1.0.0/leafletfix.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/proj4-2.6.2/proj4.min.js\"></script>\n<script src=\"../../site_libs/Proj4Leaflet-1.0.1/proj4leaflet.js\"></script>\n<link href=\"../../site_libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/leaflet-binding-2.2.1/leaflet.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}